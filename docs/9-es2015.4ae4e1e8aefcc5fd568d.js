(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"+LUq":function(e,t,n){"use strict";n.d(t,"d",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return a}),n.d(t,"g",function(){return s}),n.d(t,"f",function(){return c}),n.d(t,"b",function(){return l}),n.d(t,"e",function(){return d});var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(t){o(t)}}function s(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})}function d(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}},5756:function(e,t,n){var r=function(){"use strict";return r=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},r.prototype._singletonInstance)return r.prototype._singletonInstance;if(r.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),r.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var n=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n)}},r.prototype._openPopup=function(e,t,n,r){try{var i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=window.open(e,t,"width="+n+", height="+r+", top="+(s/2-r/2+o)+", left="+(a/2-n/2+i));return c.focus&&c.focus(),c}catch(l){return this.warn("Error opening popup, "+l.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},r.prototype._handlePopupError=function(e,t,n,r,i){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,i),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(r,null,n)},r.prototype._loginPopup=function(e,t,n){var r=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),i=n||this.callback;if(null!=r){if(this._openedWindows.push(r),-1!=this.config.redirectUri.indexOf("#"))var o=this.config.redirectUri.split("#")[0];else o=this.config.redirectUri;var a=this,s=window.setInterval(function(){if(!r||r.closed||void 0===r.closed){var e="Popup Window closed",n="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return a.isAngular&&a._broadcast("adal:popUpClosed",n+a.CONSTANTS.RESOURCE_DELIMETER+e),a._handlePopupError(i,t,e,n,n),void window.clearInterval(s)}try{var c=r.location;if(-1!=encodeURI(c.href).indexOf(encodeURI(o)))return a.isAngular?a._broadcast("adal:popUpHashChanged",c.hash):a.handleWindowCallback(c.hash),window.clearInterval(s),a._loginInProgress=!1,a._acquireTokenInProgress=!1,a.info("Closing popup window"),a._openedWindows=[],void r.close()}catch(l){}},1)}else{var c="Popup Window is null. This can happen if you are using IE";this._handlePopupError(i,t,"Error opening popup",c,c)}},r.prototype._broadcast=function(e,t){!function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}();var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},r.prototype.loginInProgress=function(){return this._loginInProgress},r.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},r.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),r=this.config.expireOffsetSeconds||300;return n&&n>this._now()+r?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},r.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},r.prototype.registerCallback=function(e,t,n){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var r=this;this._callBacksMappedToRenewStates[e].push(n),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(n,i,o,a){r._activeRenewals[t]=null;for(var s=0;s<r._callBacksMappedToRenewStates[e].length;++s)try{r._callBacksMappedToRenewStates[e][s](n,i,o,a)}catch(o){r.warn(o)}r._callBacksMappedToRenewStates[e]=null,r._callBackMappedToRenewStates[e]=null})},r.prototype._renewToken=function(e,t,n){this.info("renewToken is called for resource:"+e);var r=this._addAdalFrame("adalRenewFrame"+e),i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n=n||"token",e),"prompt");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),o+="&nonce="+encodeURIComponent(this._idTokenNonce)),o=this._addHintParameters(o+="&prompt=none"),this.registerCallback(i,e,t),this.verbosePii("Navigate to:"+o),r.src="about:blank",this._loadFrameTimeout(o,"adalRenewFrame"+e,e)},r.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var n=this._addAdalFrame("adalIdTokenFrame"),r=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose("Renew Idtoken Expected state: "+r);var i=null==t?null:this.config.clientId,o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(t=t||"id_token",i),"prompt");o=this._addHintParameters(o+="&prompt=none"),o+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,e),this.verbosePii("Navigate to:"+o),n.src="about:blank",this._loadFrameTimeout(o,"adalIdTokenFrame",this.config.clientId)},r.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},r.prototype._urlRemoveQueryStringParameter=function(e,t){var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e.replace(n,"")},r.prototype._loadFrameTimeout=function(e,t,n){this.verbose("Set loading state to pending for: "+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var r=this;setTimeout(function(){if(r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){r.verbose("Loading frame has timed out after: "+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+n);var e=r._activeRenewals[n];e&&r._callBackMappedToRenewStates[e]&&r._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},r.CONSTANTS.LOADFRAME_TIMEOUT)},r.prototype._loadFrame=function(e,t){var n=this;n.info("LoadFrame: "+t);var r=t;setTimeout(function(){var t=n._addAdalFrame(r);""!==t.src&&"about:blank"!==t.src||(t.src=e,n._loadFrame(e,r))},500)},r.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var n=this.getCachedToken(e);return n?(this.info("Token is already in cache for resource:"+e),void t(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},r.prototype.acquireTokenPopup=function(e,t,n,r){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(i,e,r),this._loginPopup(o,e,r)},r.prototype.acquireTokenRedirect=function(e,t,n){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");var r=this.callback;if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,i,!0),this.promptUser(o)},r.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},r.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},r.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},r.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t="common",n="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+n}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},r.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},r.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))}},r.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&this._user.profile.upn.indexOf("@")>-1)){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},r.prototype._createUser=function(e){var t=null,n=this._extractIdToken(e);return n&&n.hasOwnProperty("aud")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:n},n.hasOwnProperty("upn")?t.userName=n.upn:n.hasOwnProperty("email")&&(t.userName=n.email)):this.warn("IdToken has invalid aud field")),t},r.prototype._getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},r.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},r.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},r.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),n={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(n.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){if(n.valid=!0,!t.hasOwnProperty("state"))return this.warn("No state returned"),n;if(this.verbose("State: "+t.state),n.stateResponse=t.state,this._matchState(n))return n;if(!n.stateMatch&&window.parent){n.requestType=this._requestType;for(var r=this._renewStates,i=0;i<r.length;i++)if(r[i]===n.stateResponse){n.stateMatch=!0;break}}}return n},r.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]&&t[n]===e.profile.nonce)return!0}return!1},r.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]&&t[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r)for(r=r.split(this.CONSTANTS.CACHE_DELIMETER),n=0;n<r.length;n++)if(r[n]&&r[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0;return!1},r.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},r.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t,n=this._getResourceFromState(e.stateResponse);e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)?(this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description))):e.stateMatch?(this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(n)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),this._hasResource(n=this.config.loginResource?this.config.loginResource:this.config.clientId)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))):(e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse)),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},r.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(e.indexOf(n)>-1)return this.config.endpoints[n];return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},r.prototype._getHostFromUri=function(e){return String(e).replace(/^(https?:)\/\//,"").split("/")[0]},r.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,n=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var r,i,o=t.getRequestInfo(e),a=null;i=n||window.parent!==window?t._callBackMappedToRenewStates[o.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(o),o.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),r=o.parameters[t.CONSTANTS.ACCESS_TOKEN]||o.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ACCESS_TOKEN):o.requestType===this.REQUEST_TYPE.LOGIN&&(r=o.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ID_TOKEN);var s=o.parameters[t.CONSTANTS.ERROR_DESCRIPTION],c=o.parameters[t.CONSTANTS.ERROR];try{i&&i(s,r,c,a)}catch(l){t.error("Error occurred in user defined callback function: "+l)}window.parent!==window||n||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},r.prototype._getNavigateUrl=function(e,t){var n="common";this.config.tenant&&(n=this.config.tenant);var r=this.instance+n+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+r),r},r.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var n=this._base64DecodeStringUrlSafe(t.JWSPayload);return n?JSON.parse(n):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(r){this.error("The returned id_token could not be decoded",r)}return null},r.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},r.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(e=String(e).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,i,o,a,s,c,l,d="",p=0;p<n;p+=4){if(r=t.indexOf(e.charAt(p)),i=t.indexOf(e.charAt(p+1)),o=t.indexOf(e.charAt(p+2)),a=t.indexOf(e.charAt(p+3)),p+2===n-1){c=(s=r<<18|i<<12|o<<6)>>16&255,l=s>>8&255,d+=String.fromCharCode(c,l);break}if(p+1===n-1){c=(s=r<<18|i<<12)>>16&255,d+=String.fromCharCode(c);break}c=(s=r<<18|i<<12|o<<6|a)>>16&255,l=s>>8&255,d+=String.fromCharCode(c,l,255&s)}return d},r.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},r.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},r.prototype._serialize=function(e,t,n){var r=[];if(null!==t){r.push("?response_type="+e),r.push("client_id="+encodeURIComponent(t.clientId)),n&&r.push("resource="+encodeURIComponent(n)),r.push("redirect_uri="+encodeURIComponent(t.redirectUri)),r.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&r.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&r.push(t.extraQueryParameter);var i=t.correlationId?t.correlationId:this._guid();r.push("client-request-id="+encodeURIComponent(i))}return r.join("&")},r.prototype._deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},o={};for(t=r.exec(e);t;)o[i(t[1])]=i(t[2]),t=r.exec(e);return o},r.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},r.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",i=0,o="",a=0;a<36;a++)"-"!==n[a]&&"4"!==n[a]&&(i=16*Math.random()|0),"x"===n[a]?o+=r[i]:"y"===n[a]?(i&=3,o+=r[i|=8]):o+=n[a];return o},r.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},r.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},r.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height=n.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},r.prototype._saveItem=function(e,t,n){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(n){var r=this._getItem(e)||"";localStorage.setItem(e,r+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},r.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},r.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},r.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},r.prototype.log=function(e,t,n,r){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var i=(new Date).toUTCString(),o="";o=this.config.correlationId?i+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:i+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,n&&(o+="\nstack:\n"+n.stack),Logging.log(o)}},r.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},r.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},r.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},r.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},r.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},r.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},r.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},r.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},r.prototype._libVersion=function(){return"1.0.18"},e.exports&&(e.exports=r,e.exports.inject=function(e){return new r(e)}),r}()},LgUO:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(module){__webpack_require__.d(__webpack_exports__,"a",function(){return AuthConfig}),__webpack_require__.d(__webpack_exports__,"b",function(){return OAuthModule}),__webpack_require__.d(__webpack_exports__,"c",function(){return OAuthService});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("fXoL"),_angular_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("ofXK"),_angular_common_http__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("tk/3"),tslib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("mrSG"),rxjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("XNiG"),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("LRne"),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("Cfvw"),rxjs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("Nv8m"),rxjs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("z6cu"),rxjs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("itXk"),rxjs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("VRyK"),rxjs_operators__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("pLZG"),rxjs_operators__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("vkgz"),rxjs_operators__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("Kj3r"),rxjs_operators__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("3E0/"),rxjs_operators__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("eIep"),rxjs_operators__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("lJxs"),rxjs_operators__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("SxV6"),rxjs_operators__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("JIr8"),rxjs_operators__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("tS1D"),rxjs_operators__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("IzEk"),rxjs_operators__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("5+tZ");class LoginOptions{constructor(){this.preventClearHashAfterLogin=!1}}class OAuthLogger{}class OAuthStorage{}let MemoryStorage=(()=>{class e{constructor(){this.data=new Map}getItem(e){return this.data.get(e)}removeItem(e){this.data.delete(e)}setItem(e,t){this.data.set(e,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();class ReceivedTokens{}function b64DecodeUnicode(e){const t=e.replace(/\-/g,"+").replace(/\_/g,"/");return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function base64UrlEncode(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}class ValidationHandler{}class AbstractValidationHandler{validateAtHash(e){return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.b)(this,void 0,void 0,function*(){let t=this.inferHashAlgorithm(e.idTokenHeader),n=yield this.calcHash(e.accessToken,t),r=base64UrlEncode(n.substr(0,n.length/2)),i=e.idTokenClaims.at_hash.replace(/=/g,"");return r!==i&&(console.error("exptected at_hash: "+r),console.error("actual at_hash: "+i)),r===i})}inferHashAlgorithm(e){let t=e.alg;if(!t.match(/^.S[0-9]{3}$/))throw new Error("Algorithm not supported: "+t);return"sha-"+t.substr(2)}}let UrlHelperService=(()=>{class e{getHashFragmentParams(e){let t=e||window.location.hash;if(t=decodeURIComponent(t),0!==t.indexOf("#"))return{};const n=t.indexOf("?");return t=t.substr(n>-1?n+1:1),this.parseQueryString(t)}parseQueryString(e){const t={};let n,r,i,o,a,s,c;if(null===e)return t;n=e.split("&");for(let l=0;l<n.length;l++)r=n[l],i=r.indexOf("="),-1===i?(o=r,a=null):(o=r.substr(0,i),a=r.substr(i+1)),s=decodeURIComponent(o),c=decodeURIComponent(a),"/"===s.substr(0,1)&&(s=s.substr(1)),t[s]=c;return t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();class OAuthEvent{constructor(e){this.type=e}}class OAuthSuccessEvent extends OAuthEvent{constructor(e,t=null){super(e),this.info=t}}class OAuthInfoEvent extends OAuthEvent{constructor(e,t=null){super(e),this.info=t}}class OAuthErrorEvent extends OAuthEvent{constructor(e,t,n=null){super(e),this.reason=t,this.params=n}}class AuthConfig{constructor(e){this.clientId="",this.redirectUri="",this.postLogoutRedirectUri="",this.loginUrl="",this.scope="openid profile",this.resource="",this.rngUrl="",this.oidc=!0,this.requestAccessToken=!0,this.options=null,this.issuer="",this.logoutUrl="",this.clearHashAfterLogin=!0,this.tokenEndpoint=null,this.revocationEndpoint=null,this.customTokenParameters=[],this.userinfoEndpoint=null,this.responseType="",this.showDebugInformation=!1,this.silentRefreshRedirectUri="",this.silentRefreshMessagePrefix="",this.silentRefreshShowIFrame=!1,this.siletRefreshTimeout=2e4,this.silentRefreshTimeout=2e4,this.dummyClientSecret=null,this.requireHttps="remoteOnly",this.strictDiscoveryDocumentValidation=!0,this.jwks=null,this.customQueryParams=null,this.silentRefreshIFrameName="angular-oauth-oidc-silent-refresh-iframe",this.timeoutFactor=.75,this.sessionChecksEnabled=!1,this.sessionCheckIntervall=3e3,this.sessionCheckIFrameUrl=null,this.sessionCheckIFrameName="angular-oauth-oidc-check-session-iframe",this.disableAtHashCheck=!1,this.skipSubjectCheck=!1,this.useIdTokenHintForSilentRefresh=!1,this.skipIssuerCheck=!1,this.nonceStateSeparator=";",this.useHttpBasicAuth=!1,this.waitForTokenInMsec=0,this.disablePKCE=!1,this.openUri=e=>{location.href=e},e&&Object.assign(this,e)}}class WebHttpUrlEncodingCodec{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD="function"==typeof define&&__webpack_require__("PDX0"),ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e,t){return function(n){return new Sha256(t,!0).update(n)[e]()}};const \u02750=createOutputMethod;var createMethod=function(e){var t=createOutputMethod("hex",e);NODE_JS&&(t=nodeWrap(t,e)),t.create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var n=0;n<OUTPUT_TYPES.length;++n){var r=OUTPUT_TYPES[n];t[r]=createOutputMethod(r,e)}return t};const \u02751=createMethod;var nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod};const \u02752=nodeWrap;var createHmacOutputMethod=function(e,t){return function(n,r){return new HmacSha256(n,t,!0).update(r)[e]()}};const \u02753=createHmacOutputMethod;var createHmacMethod=function(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e)},t.update=function(e,n){return t.create(e).update(n)};for(var n=0;n<OUTPUT_TYPES.length;++n){var r=OUTPUT_TYPES[n];t[r]=createHmacOutputMethod(r,e)}return t};const \u02754=createHmacMethod;function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,n){var r,i=typeof e;if("string"===i){var o,a=[],s=e.length,c=0;for(r=0;r<s;++r)(o=e.charCodeAt(r))<128?a[c++]=o:o<2048?(a[c++]=192|o>>6,a[c++]=128|63&o):o<55296||o>=57344?(a[c++]=224|o>>12,a[c++]=128|o>>6&63,a[c++]=128|63&o):(o=65536+((1023&o)<<10|1023&e.charCodeAt(++r)),a[c++]=240|o>>18,a[c++]=128|o>>12&63,a[c++]=128|o>>6&63,a[c++]=128|63&o);e=a}else{if("object"!==i)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}e.length>64&&(e=new Sha256(t,!0).update(e).array());var l=[],d=[];for(r=0;r<64;++r){var p=e[r]||0;l[r]=92^p,d[r]=54^p}Sha256.call(this,t,n),this.update(d),this.oKeyPad=l,this.inner=!0,this.sharedMemory=n}Sha256.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!==n){if("object"!==n)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var r,i,o=0,a=e.length,s=this.blocks;o<a;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)for(i=this.start;o<a&&i<64;++o)s[i>>2]|=e[o]<<SHIFT[3&i++];else for(i=this.start;o<a&&i<64;++o)(r=e.charCodeAt(o))<128?s[i>>2]|=r<<SHIFT[3&i++]:r<2048?(s[i>>2]|=(192|r>>6)<<SHIFT[3&i++],s[i>>2]|=(128|63&r)<<SHIFT[3&i++]):r<55296||r>=57344?(s[i>>2]|=(224|r>>12)<<SHIFT[3&i++],s[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],s[i>>2]|=(128|63&r)<<SHIFT[3&i++]):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++o)),s[i>>2]|=(240|r>>18)<<SHIFT[3&i++],s[i>>2]|=(128|r>>12&63)<<SHIFT[3&i++],s[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],s[i>>2]|=(128|63&r)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=s[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var e,t,n,r,i,o,a=this.h0,s=this.h1,c=this.h2,l=this.h3,d=this.h4,p=this.h5,u=this.h6,h=this.h7,m=this.blocks;for(e=16;e<64;++e)m[e]=m[e-16]+(((t=m[e-15])>>>7|t<<25)^(t>>>18|t<<14)^t>>>3)+m[e-7]+(((t=m[e-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)<<0;for(o=s&c,e=0;e<64;e+=4)this.first?(this.is224?(n=300032,h=(t=m[0]-1413257819)-150054599<<0,l=t+24177077<<0):(n=704751109,h=(t=m[0]-210244248)-1521486534<<0,l=t+143694565<<0),this.first=!1):(h=l+(t=h+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(d&p^~d&u)+K[e]+m[e])<<0,l=t+(((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+((n=a&s)^a&c^o))<<0),u=c+(t=u+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&d^~h&p)+K[e+1]+m[e+1])<<0,c=t+(((l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10))+((r=l&a)^l&s^n))<<0,p=s+(t=p+((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&h^~u&d)+K[e+2]+m[e+2])<<0,s=t+(((c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10))+((i=c&l)^c&a^r))<<0,d=a+(t=d+((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&u^~p&h)+K[e+3]+m[e+3])<<0,a=t+(((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+((o=s&c)^s&l^i))<<0;this.h0=this.h0+a<<0,this.h1=this.h1+s<<0,this.h2=this.h2+c<<0,this.h3=this.h3+l<<0,this.h4=this.h4+d<<0,this.h5=this.h5+p<<0,this.h6=this.h6+u<<0,this.h7=this.h7+h<<0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,i=this.h4,o=this.h5,a=this.h6,s=this.h7,c=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a];return this.is224||(c+=HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]),c},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,i=this.h4,o=this.h5,a=this.h6,s=this.h7,c=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,r>>24&255,r>>16&255,r>>8&255,255&r,i>>24&255,i>>16&255,i>>8&255,255&i,o>>24&255,o>>16&255,o>>8&255,255&o,a>>24&255,a>>16&255,a>>8&255,255&a];return this.is224||c.push(s>>24&255,s>>16&255,s>>8&255,255&s),c},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0);class HashHandler{}let DefaultHashHandler=(()=>{class e{calcHash(e,t){return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.b)(this,void 0,void 0,function*(){const t=exports.array(e);return this.toHashString2(t)})}toHashString2(e){let t="";for(let n of e)t+=String.fromCharCode(n);return t}toHashString(e){const t=new Uint8Array(e);let n="";for(let r of t)n+=String.fromCharCode(r);return n}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})(),OAuthService=(()=>{class e extends AuthConfig{constructor(e,t,n,r,i,o,a,s,c){var l;super(),this.ngZone=e,this.http=t,this.config=i,this.urlHelper=o,this.logger=a,this.crypto=s,this.discoveryDocumentLoaded=!1,this.state="",this.eventsSubject=new rxjs__WEBPACK_IMPORTED_MODULE_4__.a,this.discoveryDocumentLoadedSubject=new rxjs__WEBPACK_IMPORTED_MODULE_4__.a,this.grantTypesSupported=[],this.inImplicitFlow=!1,this.saveNoncesInLocalStorage=!1,this.debug("angular-oauth2-oidc v10"),this.document=c,i||(i={}),this.discoveryDocumentLoaded$=this.discoveryDocumentLoadedSubject.asObservable(),this.events=this.eventsSubject.asObservable(),r&&(this.tokenValidationHandler=r),i&&this.configure(i);try{n?this.setStorage(n):"undefined"!=typeof sessionStorage&&this.setStorage(sessionStorage)}catch(d){console.error("No OAuthStorage provided and cannot access default (sessionStorage).Consider providing a custom OAuthStorage implementation in your module.",d)}if("undefined"!=typeof window&&void 0!==window.localStorage){const e=null===(l=null===window||void 0===window?void 0:window.navigator)||void 0===l?void 0:l.userAgent;((null==e?void 0:e.includes("MSIE "))||(null==e?void 0:e.includes("Trident")))&&(this.saveNoncesInLocalStorage=!0)}this.setupRefreshTimer()}configure(e){Object.assign(this,new AuthConfig,e),this.config=Object.assign({},new AuthConfig,e),this.sessionChecksEnabled&&this.setupSessionCheck(),this.configChanged()}configChanged(){this.setupRefreshTimer()}restartSessionChecksIfStillLoggedIn(){this.hasValidIdToken()&&this.initSessionCheck()}restartRefreshTimerIfStillLoggedIn(){this.setupExpirationTimers()}setupSessionCheck(){this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(e=>"token_received"===e.type)).subscribe(e=>{this.initSessionCheck()})}setupAutomaticSilentRefresh(e={},t,n=!0){let r=!0;this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.a)(e=>{"token_received"===e.type?r=!0:"logout"===e.type&&(r=!1)}),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(e=>"token_expires"===e.type),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.a)(1e3)).subscribe(i=>{null!=t&&"any"!==t&&i.info!==t||!r||this.refreshInternal(e,n).catch(e=>{this.debug("Automatic silent refresh did not work")})}),this.restartRefreshTimerIfStillLoggedIn()}refreshInternal(e,t){return this.useSilentRefresh||"code"!==this.responseType?this.silentRefresh(e,t):this.refreshToken()}loadDiscoveryDocumentAndTryLogin(e=null){return this.loadDiscoveryDocument().then(t=>this.tryLogin(e))}loadDiscoveryDocumentAndLogin(e=null){return this.loadDiscoveryDocumentAndTryLogin(e=e||{}).then(t=>!(!this.hasValidIdToken()||!this.hasValidAccessToken())||(this.initLoginFlow("string"==typeof e.state?e.state:""),!1))}debug(...e){this.showDebugInformation&&this.logger.debug.apply(this.logger,e)}validateUrlFromDiscoveryDocument(e){const t=[],n=this.validateUrlForHttps(e),r=this.validateUrlAgainstIssuer(e);return n||t.push("https for all urls required. Also for urls received by discovery."),r||t.push("Every url in discovery document has to start with the issuer url.Also see property strictDiscoveryDocumentValidation."),t}validateUrlForHttps(e){if(!e)return!0;const t=e.toLowerCase();return!1===this.requireHttps||!(!t.match(/^http:\/\/localhost($|[:\/])/)&&!t.match(/^http:\/\/localhost($|[:\/])/)||"remoteOnly"!==this.requireHttps)||t.startsWith("https://")}assertUrlNotNullAndCorrectProtocol(e,t){if(!e)throw new Error(`'${t}' should not be null`);if(!this.validateUrlForHttps(e))throw new Error(`'${t}' must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).`)}validateUrlAgainstIssuer(e){return!this.strictDiscoveryDocumentValidation||!e||e.toLowerCase().startsWith(this.issuer.toLowerCase())}setupRefreshTimer(){"undefined"!=typeof window?((this.hasValidIdToken()||this.hasValidAccessToken())&&(this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.setupExpirationTimers()),this.tokenReceivedSubscription&&this.tokenReceivedSubscription.unsubscribe(),this.tokenReceivedSubscription=this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(e=>"token_received"===e.type)).subscribe(e=>{this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.setupExpirationTimers()})):this.debug("timer not supported on this plattform")}setupExpirationTimers(){this.hasValidAccessToken()&&this.setupAccessTokenTimer(),this.hasValidIdToken()&&this.setupIdTokenTimer()}setupAccessTokenTimer(){const e=this.getAccessTokenExpiration(),t=this.getAccessTokenStoredAt(),n=this.calcTimeout(t,e);this.ngZone.runOutsideAngular(()=>{this.accessTokenTimeoutSubscription=Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(new OAuthInfoEvent("token_expires","access_token")).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.a)(n)).subscribe(e=>{this.ngZone.run(()=>{this.eventsSubject.next(e)})})})}setupIdTokenTimer(){const e=this.getIdTokenExpiration(),t=this.getIdTokenStoredAt(),n=this.calcTimeout(t,e);this.ngZone.runOutsideAngular(()=>{this.idTokenTimeoutSubscription=Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(new OAuthInfoEvent("token_expires","id_token")).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.a)(n)).subscribe(e=>{this.ngZone.run(()=>{this.eventsSubject.next(e)})})})}stopAutomaticRefresh(){this.clearAccessTokenTimer(),this.clearIdTokenTimer()}clearAccessTokenTimer(){this.accessTokenTimeoutSubscription&&this.accessTokenTimeoutSubscription.unsubscribe()}clearIdTokenTimer(){this.idTokenTimeoutSubscription&&this.idTokenTimeoutSubscription.unsubscribe()}calcTimeout(e,t){const n=Date.now();return Math.max(0,(t-e)*this.timeoutFactor-(n-e))}setStorage(e){this._storage=e,this.configChanged()}loadDiscoveryDocument(e=null){return new Promise((t,n)=>{e||((e=this.issuer||"").endsWith("/")||(e+="/"),e+=".well-known/openid-configuration"),this.validateUrlForHttps(e)?this.http.get(e).subscribe(e=>{if(!this.validateDiscoveryDocument(e))return this.eventsSubject.next(new OAuthErrorEvent("discovery_document_validation_error",null)),void n("discovery_document_validation_error");this.loginUrl=e.authorization_endpoint,this.logoutUrl=e.end_session_endpoint||this.logoutUrl,this.grantTypesSupported=e.grant_types_supported,this.issuer=e.issuer,this.tokenEndpoint=e.token_endpoint,this.userinfoEndpoint=e.userinfo_endpoint||this.userinfoEndpoint,this.jwksUri=e.jwks_uri,this.sessionCheckIFrameUrl=e.check_session_iframe||this.sessionCheckIFrameUrl,this.discoveryDocumentLoaded=!0,this.discoveryDocumentLoadedSubject.next(e),this.revocationEndpoint=e.revocation_endpoint,this.sessionChecksEnabled&&this.restartSessionChecksIfStillLoggedIn(),this.loadJwks().then(n=>{const r=new OAuthSuccessEvent("discovery_document_loaded",{discoveryDocument:e,jwks:n});this.eventsSubject.next(r),t(r)}).catch(e=>{this.eventsSubject.next(new OAuthErrorEvent("discovery_document_load_error",e)),n(e)})},e=>{this.logger.error("error loading discovery document",e),this.eventsSubject.next(new OAuthErrorEvent("discovery_document_load_error",e)),n(e)}):n("issuer  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).")})}loadJwks(){return new Promise((e,t)=>{this.jwksUri?this.http.get(this.jwksUri).subscribe(t=>{this.jwks=t,this.eventsSubject.next(new OAuthSuccessEvent("discovery_document_loaded")),e(t)},e=>{this.logger.error("error loading jwks",e),this.eventsSubject.next(new OAuthErrorEvent("jwks_load_error",e)),t(e)}):e(null)})}validateDiscoveryDocument(e){let t;return this.skipIssuerCheck||e.issuer===this.issuer?(t=this.validateUrlFromDiscoveryDocument(e.authorization_endpoint),t.length>0?(this.logger.error("error validating authorization_endpoint in discovery document",t),!1):(t=this.validateUrlFromDiscoveryDocument(e.end_session_endpoint),t.length>0?(this.logger.error("error validating end_session_endpoint in discovery document",t),!1):(t=this.validateUrlFromDiscoveryDocument(e.token_endpoint),t.length>0&&this.logger.error("error validating token_endpoint in discovery document",t),t=this.validateUrlFromDiscoveryDocument(e.revocation_endpoint),t.length>0&&this.logger.error("error validating revocation_endpoint in discovery document",t),t=this.validateUrlFromDiscoveryDocument(e.userinfo_endpoint),t.length>0?(this.logger.error("error validating userinfo_endpoint in discovery document",t),!1):(t=this.validateUrlFromDiscoveryDocument(e.jwks_uri),t.length>0?(this.logger.error("error validating jwks_uri in discovery document",t),!1):(this.sessionChecksEnabled&&!e.check_session_iframe&&this.logger.warn("sessionChecksEnabled is activated but discovery document does not contain a check_session_iframe field"),!0))))):(this.logger.error("invalid issuer in discovery document","expected: "+this.issuer,"current: "+e.issuer),!1)}fetchTokenUsingPasswordFlowAndLoadUserProfile(e,t,n=new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h){return this.fetchTokenUsingPasswordFlow(e,t,n).then(()=>this.loadUserProfile())}loadUserProfile(){if(!this.hasValidAccessToken())throw new Error("Can not load User Profile without access_token");if(!this.validateUrlForHttps(this.userinfoEndpoint))throw new Error("userinfoEndpoint must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");return new Promise((e,t)=>{const n=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h).set("Authorization","Bearer "+this.getAccessToken());this.http.get(this.userinfoEndpoint,{headers:n}).subscribe(n=>{this.debug("userinfo received",n);const r=this.getIdentityClaims()||{};this.skipSubjectCheck||!this.oidc||r.sub&&n.sub===r.sub?(n=Object.assign({},r,n),this._storage.setItem("id_token_claims_obj",JSON.stringify(n)),this.eventsSubject.next(new OAuthSuccessEvent("user_profile_loaded")),e(n)):t("if property oidc is true, the received user-id (sub) has to be the user-id of the user that has logged in with oidc.\nif you are not using oidc but just oauth2 password flow set oidc to false")},e=>{this.logger.error("error loading user info",e),this.eventsSubject.next(new OAuthErrorEvent("user_profile_load_error",e)),t(e)})})}fetchTokenUsingPasswordFlow(e,t,n=new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h){return this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint"),new Promise((r,i)=>{let o=new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.i({encoder:new WebHttpUrlEncodingCodec}).set("grant_type","password").set("scope",this.scope).set("username",e).set("password",t);if(this.useHttpBasicAuth){const e=btoa(`${this.clientId}:${this.dummyClientSecret}`);n=n.set("Authorization","Basic "+e)}if(this.useHttpBasicAuth||(o=o.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(o=o.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const e of Object.getOwnPropertyNames(this.customQueryParams))o=o.set(e,this.customQueryParams[e]);n=n.set("Content-Type","application/x-www-form-urlencoded"),this.http.post(this.tokenEndpoint,o,{headers:n}).subscribe(e=>{this.debug("tokenResponse",e),this.storeAccessTokenResponse(e.access_token,e.refresh_token,e.expires_in||this.fallbackAccessTokenExpirationTimeInSec,e.scope,this.extractRecognizedCustomParameters(e)),this.eventsSubject.next(new OAuthSuccessEvent("token_received")),r(e)},e=>{this.logger.error("Error performing password flow",e),this.eventsSubject.next(new OAuthErrorEvent("token_error",e)),i(e)})})}refreshToken(){return this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint"),new Promise((e,t)=>{let n=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.i).set("grant_type","refresh_token").set("scope",this.scope).set("refresh_token",this._storage.getItem("refresh_token")),r=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const e=btoa(`${this.clientId}:${this.dummyClientSecret}`);r=r.set("Authorization","Basic "+e)}if(this.useHttpBasicAuth||(n=n.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(n=n.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const i of Object.getOwnPropertyNames(this.customQueryParams))n=n.set(i,this.customQueryParams[i]);this.http.post(this.tokenEndpoint,n,{headers:r}).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.a)(e=>e.id_token?Object(rxjs__WEBPACK_IMPORTED_MODULE_6__.a)(this.processIdToken(e.id_token,e.access_token,!0)).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.a)(e=>this.storeIdToken(e)),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_16__.a)(t=>e)):Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(e))).subscribe(t=>{this.debug("refresh tokenResponse",t),this.storeAccessTokenResponse(t.access_token,t.refresh_token,t.expires_in||this.fallbackAccessTokenExpirationTimeInSec,t.scope,this.extractRecognizedCustomParameters(t)),this.eventsSubject.next(new OAuthSuccessEvent("token_received")),this.eventsSubject.next(new OAuthSuccessEvent("token_refreshed")),e(t)},e=>{this.logger.error("Error refreshing token",e),this.eventsSubject.next(new OAuthErrorEvent("token_refresh_error",e)),t(e)})})}removeSilentRefreshEventListener(){this.silentRefreshPostMessageEventListener&&(window.removeEventListener("message",this.silentRefreshPostMessageEventListener),this.silentRefreshPostMessageEventListener=null)}setupSilentRefreshEventListener(){this.removeSilentRefreshEventListener(),this.silentRefreshPostMessageEventListener=e=>{const t=this.processMessageEventMessage(e);this.tryLogin({customHashFragment:t,preventClearHashAfterLogin:!0,customRedirectUri:this.silentRefreshRedirectUri||this.redirectUri}).catch(e=>this.debug("tryLogin during silent refresh failed",e))},window.addEventListener("message",this.silentRefreshPostMessageEventListener)}silentRefresh(e={},t=!0){const n=this.getIdentityClaims()||{};if(this.useIdTokenHintForSilentRefresh&&this.hasValidIdToken()&&(e.id_token_hint=this.getIdToken()),!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(void 0===this.document)throw new Error("silent refresh is not supported on this platform");const r=this.document.getElementById(this.silentRefreshIFrameName);r&&this.document.body.removeChild(r),this.silentRefreshSubject=n.sub;const i=this.document.createElement("iframe");i.id=this.silentRefreshIFrameName,this.setupSilentRefreshEventListener(),this.createLoginUrl(null,null,this.silentRefreshRedirectUri||this.redirectUri,t,e).then(e=>{i.setAttribute("src",e),this.silentRefreshShowIFrame||(i.style.display="none"),this.document.body.appendChild(i)});const o=this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(e=>e instanceof OAuthErrorEvent),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.a)()),a=this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(e=>"token_received"===e.type),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.a)()),s=Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(new OAuthErrorEvent("silent_refresh_timeout",null)).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.a)(this.silentRefreshTimeout));return Object(rxjs__WEBPACK_IMPORTED_MODULE_7__.a)([o,a,s]).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_16__.a)(e=>{if(e instanceof OAuthErrorEvent)throw"silent_refresh_timeout"===e.type||(e=new OAuthErrorEvent("silent_refresh_error",e)),this.eventsSubject.next(e),e;return"token_received"===e.type&&(e=new OAuthSuccessEvent("silently_refreshed"),this.eventsSubject.next(e)),e})).toPromise()}initImplicitFlowInPopup(e){return this.initLoginFlowInPopup(e)}initLoginFlowInPopup(e){return e=e||{},this.createLoginUrl(null,null,this.silentRefreshRedirectUri,!1,{display:"popup"}).then(t=>new Promise((n,r)=>{let i,o=window.open(t,"_blank",this.calculatePopupFeatures(e));o?i=window.setInterval(()=>{o&&!o.closed||(a(),r(new OAuthErrorEvent("popup_closed",{})))},500):r(new OAuthErrorEvent("popup_blocked",{}));const a=()=>{window.clearInterval(i),window.removeEventListener("message",s),null!==o&&o.close(),o=null},s=e=>{const t=this.processMessageEventMessage(e);t&&null!==t?this.tryLogin({customHashFragment:t,preventClearHashAfterLogin:!0,customRedirectUri:this.silentRefreshRedirectUri}).then(()=>{a(),n()},e=>{a(),r(e)}):console.log("false event firing")};window.addEventListener("message",s)}))}calculatePopupFeatures(e){const t=e.height||470,n=e.width||500,r=window.screenLeft+(window.outerWidth-n)/2;return`location=no,toolbar=no,width=${n},height=${t},top=${window.screenTop+(window.outerHeight-t)/2},left=${r}`}processMessageEventMessage(e){let t="#";if(this.silentRefreshMessagePrefix&&(t+=this.silentRefreshMessagePrefix),!e||!e.data||"string"!=typeof e.data)return;const n=e.data;return n.startsWith(t)?"#"+n.substr(t.length):void 0}canPerformSessionCheck(){return!!this.sessionChecksEnabled&&(this.sessionCheckIFrameUrl?this.getSessionState()?void 0!==this.document:(console.warn("sessionChecksEnabled is activated but there is no session_state"),!1):(console.warn("sessionChecksEnabled is activated but there is no sessionCheckIFrameUrl"),!1))}setupSessionCheckEventListener(){this.removeSessionCheckEventListener(),this.sessionCheckEventListener=e=>{const t=e.origin.toLowerCase(),n=this.issuer.toLowerCase();if(this.debug("sessionCheckEventListener"),n.startsWith(t)){switch(e.data){case"unchanged":this.handleSessionUnchanged();break;case"changed":this.ngZone.run(()=>{this.handleSessionChange()});break;case"error":this.ngZone.run(()=>{this.handleSessionError()})}this.debug("got info from session check inframe",e)}else this.debug("sessionCheckEventListener","wrong origin",t,"expected",n,"event",e)},this.ngZone.runOutsideAngular(()=>{window.addEventListener("message",this.sessionCheckEventListener)})}handleSessionUnchanged(){this.debug("session check","session unchanged")}handleSessionChange(){this.eventsSubject.next(new OAuthInfoEvent("session_changed")),this.stopSessionCheckTimer(),this.useSilentRefresh||"code"!==this.responseType?this.silentRefreshRedirectUri?(this.silentRefresh().catch(e=>this.debug("silent refresh failed after session changed")),this.waitForSilentRefreshAfterSessionChange()):(this.eventsSubject.next(new OAuthInfoEvent("session_terminated")),this.logOut(!0)):this.refreshToken().then(e=>{this.debug("token refresh after session change worked")}).catch(e=>{this.debug("token refresh did not work after session changed"),this.eventsSubject.next(new OAuthInfoEvent("session_terminated")),this.logOut(!0)})}waitForSilentRefreshAfterSessionChange(){this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(e=>"silently_refreshed"===e.type||"silent_refresh_timeout"===e.type||"silent_refresh_error"===e.type),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.a)()).subscribe(e=>{"silently_refreshed"!==e.type&&(this.debug("silent refresh did not work after session changed"),this.eventsSubject.next(new OAuthInfoEvent("session_terminated")),this.logOut(!0))})}handleSessionError(){this.stopSessionCheckTimer(),this.eventsSubject.next(new OAuthInfoEvent("session_error"))}removeSessionCheckEventListener(){this.sessionCheckEventListener&&(window.removeEventListener("message",this.sessionCheckEventListener),this.sessionCheckEventListener=null)}initSessionCheck(){if(!this.canPerformSessionCheck())return;const e=this.document.getElementById(this.sessionCheckIFrameName);e&&this.document.body.removeChild(e);const t=this.document.createElement("iframe");t.id=this.sessionCheckIFrameName,this.setupSessionCheckEventListener(),t.setAttribute("src",this.sessionCheckIFrameUrl),t.style.display="none",this.document.body.appendChild(t),this.startSessionCheckTimer()}startSessionCheckTimer(){this.stopSessionCheckTimer(),this.ngZone.runOutsideAngular(()=>{this.sessionCheckTimer=setInterval(this.checkSession.bind(this),this.sessionCheckIntervall)})}stopSessionCheckTimer(){this.sessionCheckTimer&&(clearInterval(this.sessionCheckTimer),this.sessionCheckTimer=null)}checkSession(){const e=this.document.getElementById(this.sessionCheckIFrameName);e||this.logger.warn("checkSession did not find iframe",this.sessionCheckIFrameName);const t=this.getSessionState();t||this.stopSessionCheckTimer(),e.contentWindow.postMessage(this.clientId+" "+t,this.issuer)}createLoginUrl(e="",t="",n="",r=!1,i={}){return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.b)(this,void 0,void 0,function*(){let o;o=n||this.redirectUri;const a=yield this.createAndSaveNonce();if(e=e?a+this.config.nonceStateSeparator+encodeURIComponent(e):a,!this.requestAccessToken&&!this.oidc)throw new Error("Either requestAccessToken or oidc or both must be true");this.responseType=this.config.responseType?this.config.responseType:this.oidc&&this.requestAccessToken?"id_token token":this.oidc&&!this.requestAccessToken?"id_token":"token";const s=this.loginUrl.indexOf("?")>-1?"&":"?";let c=this.scope;this.oidc&&!c.match(/(^|\s)openid($|\s)/)&&(c="openid "+c);let l=this.loginUrl+s+"response_type="+encodeURIComponent(this.responseType)+"&client_id="+encodeURIComponent(this.clientId)+"&state="+encodeURIComponent(e)+"&redirect_uri="+encodeURIComponent(o)+"&scope="+encodeURIComponent(c);if(this.responseType.includes("code")&&!this.disablePKCE){const[e,t]=yield this.createChallangeVerifierPairForPKCE();this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.setItem("PKCE_verifier",t):this._storage.setItem("PKCE_verifier",t),l+="&code_challenge="+e,l+="&code_challenge_method=S256"}t&&(l+="&login_hint="+encodeURIComponent(t)),this.resource&&(l+="&resource="+encodeURIComponent(this.resource)),this.oidc&&(l+="&nonce="+encodeURIComponent(a)),r&&(l+="&prompt=none");for(const e of Object.keys(i))l+="&"+encodeURIComponent(e)+"="+encodeURIComponent(i[e]);if(this.customQueryParams)for(const e of Object.getOwnPropertyNames(this.customQueryParams))l+="&"+e+"="+encodeURIComponent(this.customQueryParams[e]);return l})}initImplicitFlowInternal(e="",t=""){if(this.inImplicitFlow)return;if(this.inImplicitFlow=!0,!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");let n={},r=null;"string"==typeof t?r=t:"object"==typeof t&&(n=t),this.createLoginUrl(e,r,null,!1,n).then(this.config.openUri).catch(e=>{console.error("Error in initImplicitFlow",e),this.inImplicitFlow=!1})}initImplicitFlow(e="",t=""){""!==this.loginUrl?this.initImplicitFlowInternal(e,t):this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(e=>"discovery_document_loaded"===e.type)).subscribe(n=>this.initImplicitFlowInternal(e,t))}resetImplicitFlow(){this.inImplicitFlow=!1}callOnTokenReceivedIfExists(e){const t=this;if(e.onTokenReceived){const n={idClaims:t.getIdentityClaims(),idToken:t.getIdToken(),accessToken:t.getAccessToken(),state:t.state};e.onTokenReceived(n)}}storeAccessTokenResponse(e,t,n,r,i){if(this._storage.setItem("access_token",e),r&&!Array.isArray(r)?this._storage.setItem("granted_scopes",JSON.stringify(r.split("+"))):r&&Array.isArray(r)&&this._storage.setItem("granted_scopes",JSON.stringify(r)),this._storage.setItem("access_token_stored_at",""+Date.now()),n){const e=1e3*n,t=(new Date).getTime()+e;this._storage.setItem("expires_at",""+t)}t&&this._storage.setItem("refresh_token",t),i&&i.forEach((e,t)=>{this._storage.setItem(t,e)})}tryLogin(e=null){return"code"===this.config.responseType?this.tryLoginCodeFlow(e).then(e=>!0):this.tryLoginImplicitFlow(e)}parseQueryString(e){return e&&0!==e.length?("?"===e.charAt(0)&&(e=e.substr(1)),this.urlHelper.parseQueryString(e)):{}}tryLoginCodeFlow(e=null){const t=(e=e||{}).customHashFragment?e.customHashFragment.substring(1):window.location.search,n=this.getCodePartsFromUrl(t),r=n.code,i=n.state,o=n.session_state;if(!e.preventClearHashAfterLogin){const e=location.href.replace(/[&\?]code=[^&\$]*/,"").replace(/[&\?]scope=[^&\$]*/,"").replace(/[&\?]state=[^&\$]*/,"").replace(/[&\?]session_state=[^&\$]*/,"");history.replaceState(null,window.name,e)}let[a,s]=this.parseState(i);if(this.state=s,n.error){this.debug("error trying to login"),this.handleLoginError({},n);const e=new OAuthErrorEvent("code_error",{},n);return this.eventsSubject.next(e),Promise.reject(e)}if(!a)return Promise.resolve();if(!this.validateNonce(a)){const e=new OAuthErrorEvent("invalid_nonce_in_state",null);return this.eventsSubject.next(e),Promise.reject(e)}return this.storeSessionState(o),r?this.getTokenFromCode(r,e).then(e=>null):Promise.resolve()}getCodePartsFromUrl(e){return e&&0!==e.length?("?"===e.charAt(0)&&(e=e.substr(1)),this.urlHelper.parseQueryString(e)):this.urlHelper.getHashFragmentParams()}getTokenFromCode(e,t){let n=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.i).set("grant_type","authorization_code").set("code",e).set("redirect_uri",t.customRedirectUri||this.redirectUri);if(!this.disablePKCE){let e;e=this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.getItem("PKCE_verifier"):this._storage.getItem("PKCE_verifier"),e?n=n.set("code_verifier",e):console.warn("No PKCE verifier found in oauth storage!")}return this.fetchAndProcessToken(n)}fetchAndProcessToken(e){this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint");let t=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const e=btoa(`${this.clientId}:${this.dummyClientSecret}`);t=t.set("Authorization","Basic "+e)}return this.useHttpBasicAuth||(e=e.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(e=e.set("client_secret",this.dummyClientSecret)),new Promise((n,r)=>{if(this.customQueryParams)for(let t of Object.getOwnPropertyNames(this.customQueryParams))e=e.set(t,this.customQueryParams[t]);this.http.post(this.tokenEndpoint,e,{headers:t}).subscribe(e=>{this.debug("refresh tokenResponse",e),this.storeAccessTokenResponse(e.access_token,e.refresh_token,e.expires_in||this.fallbackAccessTokenExpirationTimeInSec,e.scope,this.extractRecognizedCustomParameters(e)),this.oidc&&e.id_token?this.processIdToken(e.id_token,e.access_token).then(t=>{this.storeIdToken(t),this.eventsSubject.next(new OAuthSuccessEvent("token_received")),this.eventsSubject.next(new OAuthSuccessEvent("token_refreshed")),n(e)}).catch(e=>{this.eventsSubject.next(new OAuthErrorEvent("token_validation_error",e)),console.error("Error validating tokens"),console.error(e),r(e)}):(this.eventsSubject.next(new OAuthSuccessEvent("token_received")),this.eventsSubject.next(new OAuthSuccessEvent("token_refreshed")),n(e))},e=>{console.error("Error getting token",e),this.eventsSubject.next(new OAuthErrorEvent("token_refresh_error",e)),r(e)})})}tryLoginImplicitFlow(e=null){let t;t=(e=e||{}).customHashFragment?this.urlHelper.getHashFragmentParams(e.customHashFragment):this.urlHelper.getHashFragmentParams(),this.debug("parsed url",t);const n=t.state;let[r,i]=this.parseState(n);if(this.state=i,t.error){this.debug("error trying to login"),this.handleLoginError(e,t);const n=new OAuthErrorEvent("token_error",{},t);return this.eventsSubject.next(n),Promise.reject(n)}const o=t.access_token,a=t.id_token,s=t.session_state,c=t.scope;if(!this.requestAccessToken&&!this.oidc)return Promise.reject("Either requestAccessToken or oidc (or both) must be true.");if(this.requestAccessToken&&!o)return Promise.resolve(!1);if(this.requestAccessToken&&!e.disableOAuth2StateCheck&&!n)return Promise.resolve(!1);if(this.oidc&&!a)return Promise.resolve(!1);if(this.sessionChecksEnabled&&!s&&this.logger.warn("session checks (Session Status Change Notification) were activated in the configuration but the id_token does not contain a session_state claim"),this.requestAccessToken&&!e.disableOAuth2StateCheck&&!this.validateNonce(r)){const e=new OAuthErrorEvent("invalid_nonce_in_state",null);return this.eventsSubject.next(e),Promise.reject(e)}return this.requestAccessToken&&this.storeAccessTokenResponse(o,null,t.expires_in||this.fallbackAccessTokenExpirationTimeInSec,c),this.oidc?this.processIdToken(a,o).then(t=>e.validationHandler?e.validationHandler({accessToken:o,idClaims:t.idTokenClaims,idToken:t.idToken,state:n}).then(e=>t):t).then(t=>(this.storeIdToken(t),this.storeSessionState(s),this.clearHashAfterLogin&&!e.preventClearHashAfterLogin&&(location.hash=""),this.eventsSubject.next(new OAuthSuccessEvent("token_received")),this.callOnTokenReceivedIfExists(e),this.inImplicitFlow=!1,!0)).catch(e=>(this.eventsSubject.next(new OAuthErrorEvent("token_validation_error",e)),this.logger.error("Error validating tokens"),this.logger.error(e),Promise.reject(e))):(this.eventsSubject.next(new OAuthSuccessEvent("token_received")),this.clearHashAfterLogin&&!e.preventClearHashAfterLogin&&(location.hash=""),this.callOnTokenReceivedIfExists(e),Promise.resolve(!0))}parseState(e){let t=e,n="";if(e){const r=e.indexOf(this.config.nonceStateSeparator);r>-1&&(t=e.substr(0,r),n=e.substr(r+this.config.nonceStateSeparator.length))}return[t,n]}validateNonce(e){let t;return t=this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.getItem("nonce"):this._storage.getItem("nonce"),t===e||(console.error("Validating access_token failed, wrong state/nonce.",t,e),!1)}storeIdToken(e){this._storage.setItem("id_token",e.idToken),this._storage.setItem("id_token_claims_obj",e.idTokenClaimsJson),this._storage.setItem("id_token_expires_at",""+e.idTokenExpiresAt),this._storage.setItem("id_token_stored_at",""+Date.now())}storeSessionState(e){this._storage.setItem("session_state",e)}getSessionState(){return this._storage.getItem("session_state")}handleLoginError(e,t){e.onLoginError&&e.onLoginError(t),this.clearHashAfterLogin&&!e.preventClearHashAfterLogin&&(location.hash="")}processIdToken(e,t,n=!1){const r=e.split("."),i=b64DecodeUnicode(this.padBase64(r[0])),o=JSON.parse(i),a=b64DecodeUnicode(this.padBase64(r[1])),s=JSON.parse(a);let c;if(c=this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.getItem("nonce"):this._storage.getItem("nonce"),Array.isArray(s.aud)){if(s.aud.every(e=>e!==this.clientId)){const e="Wrong audience: "+s.aud.join(",");return this.logger.warn(e),Promise.reject(e)}}else if(s.aud!==this.clientId){const e="Wrong audience: "+s.aud;return this.logger.warn(e),Promise.reject(e)}if(!s.sub){const e="No sub claim in id_token";return this.logger.warn(e),Promise.reject(e)}if(this.sessionChecksEnabled&&this.silentRefreshSubject&&this.silentRefreshSubject!==s.sub){const e=`After refreshing, we got an id_token for another user (sub). Expected sub: ${this.silentRefreshSubject}, received sub: ${s.sub}`;return this.logger.warn(e),Promise.reject(e)}if(!s.iat){const e="No iat claim in id_token";return this.logger.warn(e),Promise.reject(e)}if(!this.skipIssuerCheck&&s.iss!==this.issuer){const e="Wrong issuer: "+s.iss;return this.logger.warn(e),Promise.reject(e)}if(!n&&s.nonce!==c){const e="Wrong nonce: "+s.nonce;return this.logger.warn(e),Promise.reject(e)}if(!this.hasOwnProperty("responseType")||"code"!==this.responseType&&"id_token"!==this.responseType||(this.disableAtHashCheck=!0),!this.disableAtHashCheck&&this.requestAccessToken&&!s.at_hash){const e="An at_hash is needed!";return this.logger.warn(e),Promise.reject(e)}const l=Date.now(),d=1e3*s.iat,p=1e3*s.exp,u=1e3*(this.clockSkewInSec||600);if(d-u>=l||p+u<=l){const e="Token has expired";return console.error(e),console.error({now:l,issuedAtMSec:d,expiresAtMSec:p}),Promise.reject(e)}const h={accessToken:t,idToken:e,jwks:this.jwks,idTokenClaims:s,idTokenHeader:o,loadKeys:()=>this.loadJwks()};return this.disableAtHashCheck?this.checkSignature(h).then(t=>({idToken:e,idTokenClaims:s,idTokenClaimsJson:a,idTokenHeader:o,idTokenHeaderJson:i,idTokenExpiresAt:p})):this.checkAtHash(h).then(t=>{if(!this.disableAtHashCheck&&this.requestAccessToken&&!t){const e="Wrong at_hash";return this.logger.warn(e),Promise.reject(e)}return this.checkSignature(h).then(t=>{const n={idToken:e,idTokenClaims:s,idTokenClaimsJson:a,idTokenHeader:o,idTokenHeaderJson:i,idTokenExpiresAt:p};return this.disableAtHashCheck?n:this.checkAtHash(h).then(e=>{if(this.requestAccessToken&&!e){const e="Wrong at_hash";return this.logger.warn(e),Promise.reject(e)}return n})})})}getIdentityClaims(){const e=this._storage.getItem("id_token_claims_obj");return e?JSON.parse(e):null}getGrantedScopes(){const e=this._storage.getItem("granted_scopes");return e?JSON.parse(e):null}getIdToken(){return this._storage?this._storage.getItem("id_token"):null}padBase64(e){for(;e.length%4!=0;)e+="=";return e}getAccessToken(){return this._storage?this._storage.getItem("access_token"):null}getRefreshToken(){return this._storage?this._storage.getItem("refresh_token"):null}getAccessTokenExpiration(){return this._storage.getItem("expires_at")?parseInt(this._storage.getItem("expires_at"),10):null}getAccessTokenStoredAt(){return parseInt(this._storage.getItem("access_token_stored_at"),10)}getIdTokenStoredAt(){return parseInt(this._storage.getItem("id_token_stored_at"),10)}getIdTokenExpiration(){return this._storage.getItem("id_token_expires_at")?parseInt(this._storage.getItem("id_token_expires_at"),10):null}hasValidAccessToken(){if(this.getAccessToken()){const e=this._storage.getItem("expires_at"),t=new Date;return!(e&&parseInt(e,10)<t.getTime())}return!1}hasValidIdToken(){if(this.getIdToken()){const e=this._storage.getItem("id_token_expires_at"),t=new Date;return!(e&&parseInt(e,10)<t.getTime())}return!1}getCustomTokenResponseProperty(e){return this._storage&&this.config.customTokenParameters&&this.config.customTokenParameters.indexOf(e)>=0&&null!==this._storage.getItem(e)?JSON.parse(this._storage.getItem(e)):null}authorizationHeader(){return"Bearer "+this.getAccessToken()}logOut(e={},t=""){let n=!1;"boolean"==typeof e&&(n=e,e={});const r=this.getIdToken();if(this._storage.removeItem("access_token"),this._storage.removeItem("id_token"),this._storage.removeItem("refresh_token"),this.saveNoncesInLocalStorage?(localStorage.removeItem("nonce"),localStorage.removeItem("PKCE_verifier")):(this._storage.removeItem("nonce"),this._storage.removeItem("PKCE_verifier")),this._storage.removeItem("expires_at"),this._storage.removeItem("id_token_claims_obj"),this._storage.removeItem("id_token_expires_at"),this._storage.removeItem("id_token_stored_at"),this._storage.removeItem("access_token_stored_at"),this._storage.removeItem("granted_scopes"),this._storage.removeItem("session_state"),this.config.customTokenParameters&&this.config.customTokenParameters.forEach(e=>this._storage.removeItem(e)),this.silentRefreshSubject=null,this.eventsSubject.next(new OAuthInfoEvent("logout")),!this.logoutUrl)return;if(n)return;if(!r&&!this.postLogoutRedirectUri)return;let i;if(!this.validateUrlForHttps(this.logoutUrl))throw new Error("logoutUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(this.logoutUrl.indexOf("{{")>-1)i=this.logoutUrl.replace(/\{\{id_token\}\}/,r).replace(/\{\{client_id\}\}/,this.clientId);else{let n=new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.i;r&&(n=n.set("id_token_hint",r));const o=this.postLogoutRedirectUri||this.redirectUri;o&&(n=n.set("post_logout_redirect_uri",o),t&&(n=n.set("state",t)));for(let t in e)n=n.set(t,e[t]);i=this.logoutUrl+(this.logoutUrl.indexOf("?")>-1?"&":"?")+n.toString()}this.config.openUri(i)}createAndSaveNonce(){const e=this;return this.createNonce().then(function(t){return e.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.setItem("nonce",t):e._storage.setItem("nonce",t),t})}ngOnDestroy(){this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.removeSilentRefreshEventListener();const e=this.document.getElementById(this.silentRefreshIFrameName);e&&e.remove(),this.stopSessionCheckTimer(),this.removeSessionCheckEventListener();const t=this.document.getElementById(this.sessionCheckIFrameName);t&&t.remove()}createNonce(){return new Promise(e=>{if(this.rngUrl)throw new Error("createNonce with rng-web-api has not been implemented so far");const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";let n=45,r="";const i="undefined"==typeof self?null:self.crypto||self.msCrypto;if(i){let e=new Uint8Array(n);i.getRandomValues(e),e.map||(e.map=Array.prototype.map),e=e.map(e=>t.charCodeAt(e%t.length)),r=String.fromCharCode.apply(null,e)}else for(;0<n--;)r+=t[Math.random()*t.length|0];e(base64UrlEncode(r))})}checkAtHash(e){return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.b)(this,void 0,void 0,function*(){return this.tokenValidationHandler?this.tokenValidationHandler.validateAtHash(e):(this.logger.warn("No tokenValidationHandler configured. Cannot check at_hash."),!0)})}checkSignature(e){return this.tokenValidationHandler?this.tokenValidationHandler.validateSignature(e):(this.logger.warn("No tokenValidationHandler configured. Cannot check signature."),Promise.resolve(null))}initLoginFlow(e="",t={}){return"code"===this.responseType?this.initCodeFlow(e,t):this.initImplicitFlow(e,t)}initCodeFlow(e="",t={}){""!==this.loginUrl?this.initCodeFlowInternal(e,t):this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(e=>"discovery_document_loaded"===e.type)).subscribe(n=>this.initCodeFlowInternal(e,t))}initCodeFlowInternal(e="",t={}){if(!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");this.createLoginUrl(e,"",null,!1,t).then(this.config.openUri).catch(e=>{console.error("Error in initAuthorizationCodeFlow"),console.error(e)})}createChallangeVerifierPairForPKCE(){return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.b)(this,void 0,void 0,function*(){if(!this.crypto)throw new Error("PKCE support for code flow needs a CryptoHander. Did you import the OAuthModule using forRoot() ?");const e=yield this.createNonce();return[base64UrlEncode(yield this.crypto.calcHash(e,"sha-256")),e]})}extractRecognizedCustomParameters(e){let t=new Map;return this.config.customTokenParameters?(this.config.customTokenParameters.forEach(n=>{e[n]&&t.set(n,JSON.stringify(e[n]))}),t):t}revokeTokenAndLogout(e={},t=!1){let n=this.revocationEndpoint,r=this.getAccessToken(),i=this.getRefreshToken();if(!r)return;let o=new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.i,a=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const e=btoa(`${this.clientId}:${this.dummyClientSecret}`);a=a.set("Authorization","Basic "+e)}if(this.useHttpBasicAuth||(o=o.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(o=o.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const s of Object.getOwnPropertyNames(this.customQueryParams))o=o.set(s,this.customQueryParams[s]);return new Promise((s,c)=>{let l,d;if(r){let e=o.set("token",r).set("token_type_hint","access_token");l=this.http.post(n,e,{headers:a})}else l=Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(null);if(i){let e=o.set("token",i).set("token_type_hint","refresh_token");d=this.http.post(n,e,{headers:a})}else d=Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(null);t&&(l=l.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.a)(e=>0===e.status?Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(null):Object(rxjs__WEBPACK_IMPORTED_MODULE_8__.a)(e))),d=d.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.a)(e=>0===e.status?Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(null):Object(rxjs__WEBPACK_IMPORTED_MODULE_8__.a)(e)))),Object(rxjs__WEBPACK_IMPORTED_MODULE_9__.b)([l,d]).subscribe(t=>{this.logOut(e),s(t),this.logger.info("Token successfully revoked")},e=>{this.logger.error("Error revoking token",e),this.eventsSubject.next(new OAuthErrorEvent("token_revoke_error",e)),c(e)})})}}return e.\u0275fac=function(t){return new(t||e)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgZone),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](_angular_common_http__WEBPACK_IMPORTED_MODULE_2__.c),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthStorage,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](ValidationHandler,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](AuthConfig,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](UrlHelperService),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthLogger),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](HashHandler,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](_angular_common__WEBPACK_IMPORTED_MODULE_1__.e))},e.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();class OAuthModuleConfig{}class OAuthResourceServerConfig{}class OAuthResourceServerErrorHandler{}class OAuthNoopResourceServerErrorHandler{handleError(e){return Object(rxjs__WEBPACK_IMPORTED_MODULE_8__.a)(e)}}let DefaultOAuthInterceptor=(()=>{class e{constructor(e,t,n,r){this.authStorage=e,this.oAuthService=t,this.errorHandler=n,this.moduleConfig=r}checkUrl(e){return this.moduleConfig.resourceServer.customUrlValidation?this.moduleConfig.resourceServer.customUrlValidation(e):!this.moduleConfig.resourceServer.allowedUrls||!!this.moduleConfig.resourceServer.allowedUrls.find(t=>e.startsWith(t))}intercept(e,t){const n=e.url.toLowerCase();return this.moduleConfig&&this.moduleConfig.resourceServer&&this.checkUrl(n)?this.moduleConfig.resourceServer.sendAccessToken?Object(rxjs__WEBPACK_IMPORTED_MODULE_10__.a)(Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(this.oAuthService.getAccessToken()).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(e=>!!e)),this.oAuthService.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(e=>"token_received"===e.type),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.a)(this.oAuthService.waitForTokenInMsec||0),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.a)(e=>Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(null)),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_16__.a)(e=>this.oAuthService.getAccessToken()))).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_20__.a)(1),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.a)(n=>{if(n){const t=e.headers.set("Authorization","Bearer "+n);e=e.clone({headers:t})}return t.handle(e).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.a)(e=>this.errorHandler.handleError(e)))})):t.handle(e).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.a)(e=>this.errorHandler.handleError(e))):t.handle(e)}}return e.\u0275fac=function(t){return new(t||e)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthStorage),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthService),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthResourceServerErrorHandler),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthModuleConfig,8))},e.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();class NullValidationHandler{validateSignature(e){return Promise.resolve(null)}validateAtHash(e){return Promise.resolve(!0)}}function createDefaultLogger(){return console}function createDefaultStorage(){return"undefined"!=typeof sessionStorage?sessionStorage:new MemoryStorage}let OAuthModule=(()=>{class e{static forRoot(t=null,n=NullValidationHandler){return{ngModule:e,providers:[OAuthService,UrlHelperService,{provide:OAuthLogger,useFactory:createDefaultLogger},{provide:OAuthStorage,useFactory:createDefaultStorage},{provide:ValidationHandler,useClass:n},{provide:HashHandler,useClass:DefaultHashHandler},{provide:OAuthResourceServerErrorHandler,useClass:OAuthNoopResourceServerErrorHandler},{provide:OAuthModuleConfig,useValue:t},{provide:_angular_common_http__WEBPACK_IMPORTED_MODULE_2__.a,useClass:DefaultOAuthInterceptor,multi:!0}]}}}return e.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[_angular_common__WEBPACK_IMPORTED_MODULE_1__.c]]}),e})();const err="PLEASE READ THIS CAREFULLY:\n\nBeginning with angular-oauth2-oidc version 9, the JwksValidationHandler\nhas been moved to an library of its own. If you need it for implementing\nOAuth2/OIDC **implicit flow**, please install it using npm:\n\n  npm i angular-oauth2-oidc-jwks --save\n\nAfter that, you can import it into your application:\n\n  import { JwksValidationHandler } from 'angular-oauth2-oidc-jwks';\n\nPlease note, that this dependency is not needed for the **code flow**,\nwhich is nowadays the **recommented** one for single page applications.\nThis also results in smaller bundle sizes.\n";class JwksValidationHandler extends NullValidationHandler{constructor(){super(),console.error(err)}}const AUTH_CONFIG=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("AUTH_CONFIG")}).call(this,__webpack_require__("3UD+")(module))},Nv8m:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("DH7j"),i=n("yCtX"),o=n("l7GE"),a=n("ZUHj");function s(...e){if(1===e.length){if(!Object(r.a)(e[0]))return e[0];e=e[0]}return Object(i.a)(e,void 0).lift(new c)}class c{call(e,t){return t.subscribe(new l(e))}}class l extends o.a{constructor(e){super(e),this.hasFirst=!1,this.observables=[],this.subscriptions=[]}_next(e){this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(let n=0;n<t&&!this.hasFirst;n++){const t=e[n],r=Object(a.a)(this,t,void 0,n);this.subscriptions&&this.subscriptions.push(r),this.add(r)}this.observables=null}}notifyNext(e,t,n){if(!this.hasFirst){this.hasFirst=!0;for(let e=0;e<this.subscriptions.length;e++)if(e!==n){let t=this.subscriptions[e];t.unsubscribe(),this.remove(t)}this.subscriptions=null}this.destination.next(t)}}},PDX0:function(e,t){(function(t){e.exports=t}).call(this,{})},sXTw:function(e,t,n){"use strict";n.r(t),n.d(t,"getRecaptchaLanguage",function(){return Hr}),n.d(t,"AccountModule",function(){return qr});var r=n("ofXK"),i=n("tk/3"),o=n("pmn7"),a=n("3Pt+"),s=n("YirH"),c=n("yc4G"),l=n("fXoL");const d={InvisibleReCaptcha:0,ReCaptcha2:1};d[d.InvisibleReCaptcha]="InvisibleReCaptcha",d[d.ReCaptcha2]="ReCaptcha2";let p=(()=>{class e{constructor(e){this.zone=e,this.windowGrecaptcha="grecaptcha",this.windowOnLoadCallbackProperty="ngx_captcha_onload_callback",this.globalDomain="recaptcha.net",this.defaultDomain="google.com"}registerCaptchaScript(e,t,n,r){if(this.grecaptchaScriptLoaded())return void this.zone.run(()=>{n(window[this.windowGrecaptcha])});window[this.windowOnLoadCallbackProperty]=()=>this.zone.run(n.bind(this,window[this.windowGrecaptcha]));const i=document.createElement("script");i.innerHTML="",i.src=this.getCaptchaScriptUrl(e,t,r),i.async=!0,i.defer=!0,document.getElementsByTagName("head")[0].appendChild(i)}cleanup(){window[this.windowOnLoadCallbackProperty]=void 0,window[this.windowGrecaptcha]=void 0}grecaptchaScriptLoaded(){return!(!window[this.windowOnLoadCallbackProperty]||!window[this.windowGrecaptcha])}getLanguageParam(e){return e?"&hl="+e:""}getCaptchaScriptUrl(e,t,n){return`https://www.${e?this.globalDomain:this.defaultDomain}/recaptcha/api.js?onload=${this.windowOnLoadCallbackProperty}&render=${t}${this.getLanguageParam(n)}`}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275inject"](l.NgZone))},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})(),u=(()=>{class e{constructor(e,t){this.scriptService=e,this.zone=t}execute(e,t,n,r){this.executeAsPromise(e,t,r).then(n)}executeAsPromise(e,t,n){return new Promise((r,i)=>{this.scriptService.registerCaptchaScript(!(!n||!n.useGlobalDomain),e,n=>{this.zone.runOutsideAngular(()=>{try{n.execute(e,{action:t}).then(e=>this.zone.run(()=>r(e)))}catch(o){i(o)}})})})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275inject"](p),l["\u0275\u0275inject"](l.NgZone))},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})(),h=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[p,u],imports:[[r.c]]}),e})();var m,g,f,v,_,y=n("K3ix"),S=n("tyNb"),E=n("i3/Z"),b=n("nS6G"),I=n("Q86s"),T=n("Z0Cl"),w=n("Tr3h"),C=n("KALY"),A=n("Q9gK"),k=n("zmn3"),O=n("nYR2"),x=n("LgUO"),R=n("5756"),P=n("+LUq"),N=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var n=new Uint8Array(16);return t.getRandomValues(n),n[6]|=64,n[6]&=79,n[8]|=128,n[8]&=191,e.decimalToHex(n[0])+e.decimalToHex(n[1])+e.decimalToHex(n[2])+e.decimalToHex(n[3])+"-"+e.decimalToHex(n[4])+e.decimalToHex(n[5])+"-"+e.decimalToHex(n[6])+e.decimalToHex(n[7])+"-"+e.decimalToHex(n[8])+e.decimalToHex(n[9])+"-"+e.decimalToHex(n[10])+e.decimalToHex(n[11])+e.decimalToHex(n[12])+e.decimalToHex(n[13])+e.decimalToHex(n[14])+e.decimalToHex(n[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",i="0123456789abcdef",o=0,a="",s=0;s<36;s++)"-"!==r[s]&&"4"!==r[s]&&(o=16*Math.random()|0),"x"===r[s]?a+=i[o]:"y"===r[s]?(o&=3,a+=i[o|=8]):a+=r[s];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},o={};for(t=r.exec(e);t;)o[i(t[1])]=i(t[2]),t=r.exec(e);return o},e}(),L=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(m||(m={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(g||(g={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(f||(f={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(v||(v={})),function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(_||(_={}));var U,M=[_.SID,_.LOGIN_HINT],D={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},j=function(e){function t(n,r){var i=e.call(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i.errorCode=n,i.errorMessage=r,i.name="AuthError",i}return P.d(t,e),t.createUnexpectedError=function(e){return new t("unexpected_error","Unexpected error in authentication.: "+e)},t.createNoWindowObjectError=function(e){return new t("no_window_object","No window object available. Details: "+e)},t}(Error),H=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(n){return null}},e}(),q="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",F=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,t.prototype),i}return P.d(t,e),t.createEndpointResolutionError=function(e){var n="Error: could not resolve endpoints. Please check network and try again.";return e&&!H.isEmpty(e)&&(n+=" Details: "+e),new t("endpoints_resolution_error",n)},t.createMultipleAuthoritiesInCacheError=function(e){return new t("multiple_authorities","Cache error for scope "+e+": Multiple authorities found in the cache. Pass authority in the API overload..")},t.createPopupWindowError=function(e){var n=q;return e&&!H.isEmpty(e)&&(n+=" Details: "+e),new t("popup_window_error",n)},t.createTokenRenewalTimeoutError=function(){return new t("token_renewal_error","Token renewal operation failed due to timeout.")},t.createInvalidIdTokenError=function(e){return new t("invalid_id_token","Invalid ID token format. Given token: "+e)},t.createInvalidStateError=function(e,n){return new t("invalid_state_error","Invalid state. "+e+", state expected : "+n+".")},t.createNonceMismatchError=function(e,n){return new t("nonce_mismatch_error","Nonce is not matching, Nonce received:  "+e+", nonce expected : "+n+".")},t.createLoginInProgressError=function(){return new t("login_progress_error","Login_In_Progress: Error during login call - login is already in progress.")},t.createAcquireTokenInProgressError=function(){return new t("acquiretoken_progress_error","AcquireToken_In_Progress: Error during login call - login is already in progress.")},t.createUserCancelledError=function(){return new t("user_cancelled","User cancelled the flow.")},t.createErrorInCallbackFunction=function(e){return new t("callback_error","Error occurred in token received callback function. "+e+".")},t.createUserLoginRequiredError=function(){return new t("user_login_error","User login is required. For silent calls, request must contain either sid or login_hint")},t.createUserDoesNotExistError=function(){return new t("user_non_existent","User object does not exist. Please call a login API.")},t.createClientInfoDecodingError=function(e){return new t("client_info_decoding_error","The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause. Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t("client_info_not_populated_error","The service did not populate client_info in the response, Please verify with the service team Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t("null_or_empty_id_token","The idToken is null or empty. Please review the trace to determine the root cause. Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t("id_token_parsing_error","ID token cannot be parsed. Please review stack trace to determine root cause. Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t("token_encoding_error","The token to be decoded is not encoded correctly. Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t("invalid_interaction_type","The interaction type passed to the handler was incorrect or unknown")},t.createCacheParseError=function(e){return new t("cannot_parse_cache","invalid key: "+e+", The cached token key is not a valid JSON and cannot be parsed")},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t("block_token_requests","Token calls are blocked in hidden iframes")},t}(j),B={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},K={code:"authority_uri_insecure",desc:"Authority URIs must use https."},z={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},W=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,t.prototype),i}return P.d(t,e),t.createNoSetConfigurationError=function(){return new t("no_config_set","Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object.")},t.createStorageNotSupportedError=function(e){return new t("storage_not_supported","The value for the cacheLocation is not supported. Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t("no_redirect_callbacks","No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.")},t.createInvalidCallbackObjectError=function(e){return new t("invalid_callback_object","The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics. Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t("empty_input_scopes_error","Scopes cannot be passed as empty array. Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t("nonarray_input_scopes_error","Scopes cannot be passed as non-array. Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t("scopes_required","Scopes are required to obtain an access token. Given value: "+e)},t.createInvalidPromptError=function(e){return new t("invalid_prompt_value","Supported prompt values are 'login', 'select_account', 'consent' and 'none' Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t("claims_request_parsing_error","Could not parse the given claims request object. Given value: "+e)},t.createEmptyRequestError=function(){return new t("empty_request_error","Request object is required.")},t.createInvalidCorrelationIdError=function(){return new t("invalid_guid_sent_as_correlationId","Please set the correlationId as a valid guid")},t.createKnownAuthoritiesNotSetError=function(){return new t("b2c_known_authorities_not_set","Must set known authorities when validateAuthority is set to True and using B2C")},t.createInvalidAuthorityTypeError=function(){return new t(B.code,B.desc)},t.createUntrustedAuthorityError=function(e){return new t("untrusted_authority","The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false. Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var n={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t("telemetry_config_error","Telemetry config is not configured with required values mising values: "+Object.keys(n).reduce(function(t,r){return e[r]?t:t.concat([r+" ("+n[r]+")"])},[]).join(","))},t.createSsoSilentError=function(){return new t("sso_silent_error","request must contain either sid or login_hint")},t.createInvalidAuthorityMetadataError=function(){return new t("authority_metadata_error","Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields.")},t}(F),G=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var n=this.trimAndConvertArrayToLowerCase(e.slice()),r=this.trimAndConvertArrayToLowerCase(t.slice()),i=0;i<r.length;i++)if(n.indexOf(r[i].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var n=this.trimAndConvertArrayToLowerCase(e.slice());return this.trimAndConvertArrayToLowerCase(t.slice()).every(function(e){return n.indexOf(e.toString().toLowerCase())>=0})},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map(function(e){return t.trimAndConvertToLowerCase(e)})},e.trimScopes=function(e){return e.map(function(e){return e.trim()})},e.removeElement=function(e,t){var n=this.trimAndConvertToLowerCase(t);return e.filter(function(e){return e!==n})},e.parseScope=function(e){var t="";if(e)for(var n=0;n<e.length;++n)t+=n!==e.length-1?e[n]+" ":e[n];return t},e.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw W.createScopesNonArrayError(e);if(e.length<1&&t)throw W.createEmptyScopesArrayError(e.toString())}else if(t)throw W.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(L.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var n=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,r=this.trimAndConvertArrayToLowerCase(e.slice());return n?r.concat(n):r}return null},e.onlyContainsOidcScopes=function(e){var t=e.length,n=0;return e.indexOf(L.openidScope)>-1&&(n+=1),e.indexOf(L.profileScope)>-1&&(n+=1),t>0&&t===n},e.containsAnyOidcScopes=function(e){var t=e.indexOf(L.openidScope)>-1,n=e.indexOf(L.profileScope)>-1;return t||n},e.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},e.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(L.openidScope)&&t.push(L.openidScope),-1===t.indexOf(L.profileScope)&&t.push(L.profileScope),t},e.removeDefaultScopes=function(e){return e.filter(function(e){return e!==L.openidScope&&e!==L.profileScope})},e.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?L.oidcScopes:e},e}(),V=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),n=e.authorityInstance.AuthorizationEndpoint;return n.indexOf("?")<0?n+="?":n+="&",""+n+t.join("&")},e.createNavigationUrlString=function(e){var t=G.appendDefaultScopes(e.scopes),n=[];return n.push("response_type="+e.responseType),n.push("scope="+encodeURIComponent(G.parseScope(t))),n.push("client_id="+encodeURIComponent(e.clientId)),n.push("redirect_uri="+encodeURIComponent(e.redirectUri)),n.push("state="+encodeURIComponent(e.state)),n.push("nonce="+encodeURIComponent(e.nonce)),n.push("client_info=1"),n.push("x-client-SKU="+e.xClientSku),n.push("x-client-Ver="+e.xClientVer),e.promptValue&&n.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&n.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&n.push(e.queryParameters),e.extraQueryParameters&&n.push(e.extraQueryParameters),n.push("client-request-id="+encodeURIComponent(e.correlationId)),n},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){var n=e.toLowerCase(),r=this.GetUrlComponents(n),i=r.PathSegments;return!t||0===i.length||i[0]!==L.common&&i[0]!==_.ORGANIZATIONS||(i[0]=t),this.constructAuthorityUriFromObject(r,i)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),n=this.GetUrlComponents(t).PathSegments;return 0!==n.length&&n[0]===L.common},e.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),n=this.GetUrlComponents(t).PathSegments;return 0!==n.length&&n[0]===_.ORGANIZATIONS},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=e.match(t);if(!n||n.length<6)throw"Valid url required";var r={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5]},i=r.AbsolutePath.split("/");return i=i.filter(function(e){return e&&e.length>0}),r.PathSegments=i,n[6]&&(r.Search=n[6]),n[8]&&(r.Hash=n[8]),r},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(H.isEmpty(e))return e;var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e.replace(n,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),n=e.indexOf("#/");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var n=e.deserializeHash(t);return n.hasOwnProperty(m.ERROR_DESCRIPTION)||n.hasOwnProperty(m.ERROR)||n.hasOwnProperty(m.ACCESS_TOKEN)||n.hasOwnProperty(m.ID_TOKEN)},e.deserializeHash=function(t){var n=e.getHashFromUrl(t);return N.deserialize(n)},e.getHostFromUri=function(e){return String(e).replace(/^(https?:)\/\//,"").split("/")[0]},e}(),Q=function(e,t,n,r,i){this.authority=V.CanonicalizeUri(e),this.clientId=t,this.scopes=n,this.homeAccountIdentifier=N.base64Encode(r)+"."+N.base64Encode(i)},X=function(e,t,n,r){this.accessToken=e,this.idToken=t,this.expiresIn=n,this.homeAccountIdentifier=r},J=function(){function e(e,t,n,r,i,o,a){this.authorityInstance=e,this.clientId=t,this.nonce=N.createNewGuid(),this.scopes=i?i.slice():L.oidcScopes,this.scopes=G.trimScopes(this.scopes),this.state=o,this.correlationId=a,this.xClientSku="MSAL.JS",this.xClientVer="1.4.4",this.responseType=n,this.redirectUri=r}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,n,r,i){var o={};n&&(n.prompt&&(this.promptValue=n.prompt),n.claimsRequest&&(this.claimsValue=n.claimsRequest),e.isSSOParam(n)&&(o=this.constructUnifiedCacheQueryParameter(n,null))),r&&(o=this.constructUnifiedCacheQueryParameter(null,r)),o=this.addHintParameters(t,o);var a=n?n.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(o),this.extraQueryParameters=e.generateQueryParametersString(a,i)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var n,r;if(e)if(e.account){var i=e.account;i.sid?(n=_.SID,r=i.sid):i.userName&&(n=_.LOGIN_HINT,r=i.userName)}else e.sid?(n=_.SID,r=e.sid):e.loginHint&&(n=_.LOGIN_HINT,r=e.loginHint);else t&&t.hasOwnProperty(L.upn)&&(n=_.ID_TOKEN,r=t.upn);return this.addSSOParameter(n,r)},e.prototype.addHintParameters=function(e,t){return e&&!t[_.SID]&&(!t[_.LOGIN_HINT]&&e.sid&&this.promptValue===D.NONE?t=this.addSSOParameter(_.SID,e.sid,t):!t[_.LOGIN_HINT]&&e.userName&&!H.isEmpty(e.userName)&&(t=this.addSSOParameter(_.LOGIN_HINT,e.userName,t))),t},e.prototype.addSSOParameter=function(e,t,n){if(n||(n={}),!t)return n;switch(e){case _.SID:n[_.SID]=t;break;case _.ID_TOKEN:case _.LOGIN_HINT:n[_.LOGIN_HINT]=t}return n},e.generateQueryParametersString=function(e,t){var n=null;return e&&Object.keys(e).forEach(function(r){r===L.domain_hint&&(t||e[_.SID])||(null==n?n=r+"="+encodeURIComponent(e[r]):n+="&"+r+"="+encodeURIComponent(e[r]))}),n},e.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},e.determineResponseType=function(e,t){return G.onlyContainsOidcScopes(t)?"id_token":e?this.responseTypeForMatchingAccounts(t):"id_token token"},e.responseTypeForMatchingAccounts=function(e){return G.containsAnyOidcScopes(e)?"id_token token":"token"},e}(),Y=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,n){var r=this;return new Promise(function(n,i){var o=new XMLHttpRequest;if(o.open(t,e,!0),o.onload=function(){var e;(o.status<200||o.status>=300)&&i(r.handleError(o.responseText));try{e=JSON.parse(o.responseText)}catch(t){i(r.handleError(o.responseText))}n({statusCode:o.status,body:e})},o.onerror=function(){i(o.status)},"GET"!==t)throw"not implemented";o.send()})},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(n){return e}},e}(),$=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,n){t&&!this.getTrustedHostList().length&&n.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})},e.getAliases=function(e,t,n){return P.b(this,void 0,void 0,function(){var r,i,o;return P.e(this,function(a){return r=new Y,o=t.createAndStartHttpEvent(n,"GET",i="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize","getAliases"),[2,r.sendRequestAsync(i,"GET",!0).then(function(e){return o.httpResponseStatus=e.statusCode,t.stopEvent(o),e.body.metadata}).catch(function(e){throw o.serverErrorCode=e,t.stopEvent(o),e})]})})},e.setTrustedAuthoritiesFromNetwork=function(t,n,r){return P.b(this,void 0,void 0,function(){var i;return P.e(this,function(o){switch(o.label){case 0:return[4,this.getAliases(t,n,r)];case 1:return o.sent().forEach(function(t){t.aliases.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})}),i=V.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(i)&&e.TrustedHostList.push(i.toLowerCase()),[2]}})})},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(U||(U={}));var Z,ee=function(){function e(e,t,n){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=n}return e.isAdfs=function(e){var t=V.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===L.ADFS},Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return e.isAdfs(this.canonicalAuthority)?U.Adfs:U.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=V.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=V.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===U.Adfs?this.CanonicalAuthority+".well-known/openid-configuration":this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(t){throw B}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw K;if(!e.PathSegments||e.PathSegments.length<1)throw z},e.prototype.DiscoverEndpoints=function(e,t,n){var r=new Y,i=t.createAndStartHttpEvent(n,"GET",e,"openIdConfigurationEndpoint");return r.sendRequestAsync(e,"GET",!0).then(function(e){return i.httpResponseStatus=e.statusCode,t.stopEvent(i),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}}).catch(function(e){throw i.serverErrorCode=e,t.stopEvent(i),e})},e.prototype.resolveEndpointsAsync=function(e,t){return P.b(this,void 0,void 0,function(){var n,r,i;return P.e(this,function(o){switch(o.label){case 0:return this.IsValidationEnabled?(n=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==$.getTrustedHostList().length?[3,2]:[4,$.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:o.sent(),o.label=2;case 2:if(!$.IsInTrustedHostList(n))throw W.createUntrustedAuthorityError(n);o.label=3;case 3:return r=this.GetOpenIdConfigurationEndpoint(),i=this,[4,this.DiscoverEndpoints(r,e,t)];case 4:return i.tenantDiscoveryResponse=o.sent(),[2,this.tenantDiscoveryResponse]}})})},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}(),te=function(){function e(t,n){if(!t||H.isEmpty(t))return this.uid="",void(this.utid="");try{var r=N.base64Decode(t),i=JSON.parse(r);i&&(i.hasOwnProperty("uid")&&(this.uid=n?e.stripPolicyFromUid(i.uid,n):i.uid),i.hasOwnProperty("utid")&&(this.utid=i.utid))}catch(o){throw F.createClientInfoDecodingError(o)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e.createClientInfoFromIdToken=function(t,n){return new e(N.base64Encode(JSON.stringify({uid:t.subject,utid:""})),n)},e.stripPolicyFromUid=function(e,t){var n=e.split("-"),r=t.split("/").reverse(),i="";return H.isEmpty(r[0])?r.length>1&&(i=r[1]):i=r[0],n[n.length-1]===i?n.slice(0,n.length-1).join("-"):e},e.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return N.base64Encode(e)},e}(),ne=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}(),re=function(){function e(){}return e.decodeJwt=function(e){if(H.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.validateExpirationIsWithinOffset=function(e,t){var n=t||300;return e&&e>ne.now()+n},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var n=N.base64Decode(t.JWSPayload);return n?JSON.parse(n):null}catch(r){}return null},e}(),ie=function(e){if(H.isEmpty(e))throw F.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=re.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(t){throw F.createIdTokenParsingError(t)}},oe=function(e,t){this.key=e,this.value=t},ae=function(){function e(e){if(!window)throw j.createNoWindowObjectError("Browser storage class could not find window object");if(void 0===window[e]||null==window[e])throw W.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,n){window[this.cacheLocation].setItem(e,t),n&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,n){var r=e+"="+t+";path=/;";n&&(r+="expires="+this.getCookieExpirationTime(n)+";"),document.cookie=r},e.prototype.getItemCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),se=function(){function e(){}return e.validateRequest=function(e,t,n,r){if(!t&&!e)throw W.createEmptyRequestError();var i,o;e&&(i=t?G.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,G.validateInputScope(i,!t),i=G.translateClientIdIfSingleScope(i,n),this.validatePromptParameter(e.prompt),o=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var a=this.validateAndGenerateState(e&&e.state,r),s=this.validateAndGenerateCorrelationId(e&&e.correlationId);return P.a({},e,{extraQueryParameters:o,scopes:i,state:a,correlationId:s})},e.validatePromptParameter=function(e){if(e&&[D.LOGIN,D.SELECT_ACCOUNT,D.CONSENT,D.NONE].indexOf(e)<0)throw W.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var n=P.a({},e);return n?(t&&delete n[L.claims],M.forEach(function(e){n[e]&&delete n[e]}),n):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(t){throw W.createClaimsRequestParsingError(t)}},e.validateAndGenerateState=function(t,n){return H.isEmpty(t)?e.generateLibraryState(n):""+e.generateLibraryState(n)+L.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:N.createNewGuid(),ts:ne.now(),method:e},n=JSON.stringify(t);return N.base64Encode(n)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(L.resourceDelimiter)[0];if(N.isGuid(t))return{id:t,ts:ne.now(),method:L.interactionTypeRedirect};try{var n=N.base64Decode(t);return JSON.parse(n)}catch(r){throw F.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!N.isGuid(e))throw W.createInvalidCorrelationIdError();return N.isGuid(e)?e:N.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+L.resourceDelimiter+e.authority},e}(),ce=function(e){function t(t,n,r){var i=e.call(this,n)||this;return i.clientId=t,i.rollbackEnabled=!0,i.migrateCacheEntries(r),i}return P.d(t,e),t.prototype.migrateCacheEntries=function(t){var n=this,r=L.cachePrefix+"."+f.CLIENT_INFO,i=L.cachePrefix+"."+v.ERROR,o=L.cachePrefix+"."+v.ERROR_DESC,a=[e.prototype.getItem.call(this,L.cachePrefix+"."+f.IDTOKEN),e.prototype.getItem.call(this,r),e.prototype.getItem.call(this,i),e.prototype.getItem.call(this,o)];[f.IDTOKEN,f.CLIENT_INFO,v.ERROR,v.ERROR_DESC].forEach(function(e,r){return n.duplicateCacheEntry(e,a[r],t)})},t.prototype.duplicateCacheEntry=function(e,t,n){t&&this.setItem(e,t,n)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(n){return 0===e.indexOf(""+L.cachePrefix)||0===e.indexOf(L.adalIdToken)?e:t?L.cachePrefix+"."+this.clientId+"."+e:L.cachePrefix+"."+e}},t.prototype.matchKeyForType=function(e,t,n,r){var i=H.validateAndParseJsonCacheKey(e);if(!i)return null;var o=e.match(t)&&e.match(n),a=!1;switch(r){case m.ACCESS_TOKEN:a=!!e.match(L.scopes);break;case m.ID_TOKEN:a=!e.match(L.scopes)}return o&&a?i:null},t.prototype.setItem=function(t,n,r){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),n,r),this.rollbackEnabled&&!r&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),n,r)},t.prototype.getItem=function(t,n){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),n)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,n=window[this.cacheLocation];for(t in n)n.hasOwnProperty(t)&&-1!==t.indexOf(L.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var n=this,r=t&&se.parseLibraryState(t).id,i=this.tokenRenewalInProgress(t),o=window[this.cacheLocation];r&&!i&&Object.keys(o).forEach(function(t){-1!==t.indexOf(r)&&(n.removeItem(t),e.prototype.clearItemCookie.call(n,t))}),this.removeItem(g.INTERACTION_STATUS),this.removeItem(g.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,n,r){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),n,r),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),n,r)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllTokensByType=function(e,t,n){var r=this;return Object.keys(window[this.cacheLocation]).reduce(function(i,o){var a=r.matchKeyForType(o,e,t,n);if(a){var s=r.getItem(o);if(s)try{var c=new oe(a,JSON.parse(s));return i.concat([c])}catch(l){return i}}return i},[])},t.prototype.getAllAccessTokens=function(e,t){return this.getAllTokensByType(e,t,m.ACCESS_TOKEN)},t.prototype.getAllIdTokens=function(e,t){return this.getAllTokensByType(e,t,m.ID_TOKEN)},t.prototype.getAllTokens=function(e,t){var n=this.getAllAccessTokens(e,t),r=this.getAllIdTokens(e,t);return n.concat(r)},t.prototype.tokenRenewalInProgress=function(e){var n=this.getItem(t.generateTemporaryCacheKey(g.RENEW_STATUS,e));return!(!n||n!==L.inProgress)},t.prototype.clearMsalCookie=function(n){var r=this;n?(this.clearItemCookie(t.generateTemporaryCacheKey(g.NONCE_IDTOKEN,n)),this.clearItemCookie(t.generateTemporaryCacheKey(g.STATE_LOGIN,n)),this.clearItemCookie(t.generateTemporaryCacheKey(g.LOGIN_REQUEST,n)),this.clearItemCookie(t.generateTemporaryCacheKey(g.STATE_ACQ_TOKEN,n))):document.cookie.split(";").forEach(function(t){var n=t.trim().split("=")[0];n.indexOf(L.cachePrefix)>-1&&e.prototype.clearItemCookie.call(r,n)})},t.generateAcquireTokenAccountKey=function(e,t){var n=se.parseLibraryState(t).id;return""+g.ACQUIRE_TOKEN_ACCOUNT+L.resourceDelimiter+e+L.resourceDelimiter+n},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(g.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var n=se.parseLibraryState(t).id;return""+e+L.resourceDelimiter+n},t}(ae),le=function(){function e(e,t,n,r,i,o,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=n,this.name=r,this.idToken=i,this.idTokenClaims=i,this.sid=o,this.environment=a}return e.createAccount=function(t,n){var r,i=t.objectId||t.subject,o=n?n.uid:"",a=n?n.utid:"";return H.isEmpty(o)||(r=H.isEmpty(a)?N.base64Encode(o):N.base64Encode(o)+"."+N.base64Encode(a)),new e(i,r,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!!(e&&t&&e.homeAccountIdentifier&&t.homeAccountIdentifier&&e.homeAccountIdentifier===t.homeAccountIdentifier)},e}(),de=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+L.resourceDelimiter+t},e.monitorIframeForHash=function(t,n,r,i){return new Promise(function(o,a){var s=ne.relativeNowMs()+n;i.verbose("monitorWindowForIframe polling started");var c=setInterval(function(){if(ne.relativeNowMs()>s)return i.error("monitorIframeForHash unable to find hash in url, timing out"),i.errorPii("monitorIframeForHash polling timed out for url: "+r),clearInterval(c),void a(F.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(n){}e&&V.urlContainsHash(e)&&(i.verbose("monitorIframeForHash found url in hash"),clearInterval(c),o(t.location.hash))},e.POLLING_INTERVAL_MS)})},e.monitorPopupForHash=function(t,n,r,i){return new Promise(function(o,a){var s=n/e.POLLING_INTERVAL_MS,c=0;i.verbose("monitorWindowForHash polling started");var l=setInterval(function(){if(t.closed)return i.error("monitorWindowForHash window closed"),clearInterval(l),void a(F.createUserCancelledError());var e;try{e=t.location.href}catch(n){}e&&"about:blank"!==e&&(c++,e&&V.urlContainsHash(e)?(i.verbose("monitorPopupForHash found url in hash"),clearInterval(l),o(t.location.hash)):c>s&&(i.error("monitorPopupForHash unable to find hash in url, timing out"),i.errorPii("monitorPopupForHash polling timed out for url: "+r),clearInterval(l),a(F.createTokenRenewalTimeoutError())))},e.POLLING_INTERVAL_MS)})},e.loadFrame=function(e,t,n,r){var i=this;return r.infoPii("LoadFrame: "+t),new Promise(function(o,a){setTimeout(function(){var n=i.loadFrameSync(e,t,r);n?o(n):a("Unable to load iframe with name: "+t)},n)})},e.loadFrameSync=function(t,n,r){var i=e.addHiddenIFrame(n,r);return i?(""!==i.src&&"about:blank"!==i.src||(i.src=t,r.infoPii("Frame Name : "+n+" Navigated to: "+t)),i):null},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.infoPii("Add msal frame to document:"+e);var n=document.getElementById(e);if(!n){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var r=document.createElement("iframe");r.setAttribute("id",e),r.setAttribute("aria-hidden","true"),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),n=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(n=window.frames[e])}return n},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map(function(e,n){return t.item(n)}).filter(function(t){try{return t.contentWindow.location.hash===e}catch(n){return!1}})[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter(function(e){try{return e.location.hash===t}catch(n){return!1}})[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach(function(e){return e.close()})},e.blockReloadInHiddenIframes=function(){if(V.urlContainsHash(window.location.hash)&&e.isInIframe())throw F.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(g.REDIRECT_REQUEST);if(t&&!V.urlContainsHash(window.location.hash)){var n=t.split(L.resourceDelimiter);n.shift();var r=n.length>0?n.join(L.resourceDelimiter):null;e.resetTempCacheItems(r)}},e.clearUrlFragment=function(){"function"==typeof history.replaceState?history.replaceState(null,null,""+window.location.pathname+window.location.search):window.location.hash=""},e.POLLING_INTERVAL_MS=50,e}(),pe=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var n=Number(t.expiration);return n&&!e.expiresOn&&(e.expiresOn=new Date(1e3*n)),P.a({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e.buildAuthResponse=function(t,n,r,i,o,a){switch(r.responseType){case"id_token":return n=P.a({},n,{tokenType:m.ID_TOKEN,account:i,scopes:o,accountState:a}),(n=e.setResponseIdToken(n,t)).idToken?n:null;case"id_token token":return(n=e.setResponseIdToken(n,t))&&n.accessToken&&n.idToken?n:null;case"token":return e.setResponseIdToken(n,t);default:return null}},e}(),ue=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,n){return P.b(this,void 0,void 0,function(){var r;return P.e(this,function(i){switch(i.label){case 0:return[4,e.resolveEndpointsAsync(t,n)];case 1:return r=i.sent(),this.metadataMap.set(e.CanonicalAuthority,r),[2,r]}})})},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var n=JSON.parse(t);if(!n.authorization_endpoint||!n.end_session_endpoint||!n.issuer)throw W.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:n.authorization_endpoint,EndSessionEndpoint:n.end_session_endpoint,Issuer:n.issuer})}}catch(r){throw W.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,n){return H.isEmpty(e)?null:(n&&this.saveMetadataFromConfig(e,n),new ee(e,t,this.metadataMap.get(e)))},e.metadataMap=new Map,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(Z||(Z={}));var he=function(){function e(e,t){void 0===t&&(t={}),this.level=Z.Info;var n=t.correlationId,r=void 0===n?"":n,i=t.level,o=void 0===i?Z.Info:i,a=t.piiLoggingEnabled,s=void 0!==a&&a;this.localCallback=e,this.correlationId=r,this.level=o,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,n){if(!(e>this.level||!this.piiLoggingEnabled&&n)){var r,i=(new Date).toUTCString();r=H.isEmpty(this.correlationId)?i+":1.4.4-"+Z[e]+(n?"-pii":"")+" "+t:i+":"+this.correlationId+"-1.4.4-"+Z[e]+(n?"-pii":"")+" "+t,this.executeCallback(e,r,n)}},e.prototype.executeCallback=function(e,t,n){this.localCallback&&this.localCallback(e,t,n)},e.prototype.error=function(e){this.logMessage(Z.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(Z.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(Z.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(Z.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(Z.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(Z.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(Z.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(Z.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),me={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return V.getCurrentUrl()},postLogoutRedirectUri:function(){return V.getCurrentUrl()},navigateToLoginRequestUrl:!0},ge={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},fe={logger:new he(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},ve={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map},_e=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return P.d(t,e),t.createServerUnavailableError=function(){return new t("server_unavailable","Server is temporarily unavailable.")},t.createUnknownServerError=function(e){return new t("unknown_server_error",e)},t}(j),ye={code:"interaction_required"},Se={code:"consent_required"},Ee={code:"login_required"},be=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return P.d(t,e),t.isInteractionRequiredError=function(e){return e&&[ye.code,Se.code,Ee.code].indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(Ee.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(ye.code,e)},t.createConsentRequiredAuthError=function(e){return new t(Se.code,e)},t}(_e);function Ie(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var Te,we,Ce,Ae=function(e){var t=V.GetUrlComponents(e);if(ee.isAdfs(e))return e;var n=t.PathSegments;if(n&&n.length>=2){var r="tfp"===n[1]?2:1;r<n.length&&(n[r]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+n.join("/")},ke=function(e){return N.base64Encode(e)},Oe=function(e){return"msal."+(e||"")},xe=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},Re=function(){function e(e,t,n){var r;this.eventId=N.createNewGuid(),this.label=n,this.event=((r={})[Oe("event_name")]=e,r[Oe("elapsed_time")]=-1,r["Microsoft.MSAL.correlation_id"]=t,r)}return e.prototype.setElapsedTime=function(e){this.event[Oe("elapsed_time")]=e},e.prototype.stop=function(){var e,t,n;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,n=this.perfEndMark,xe()&&(window.performance.mark(n),window.performance.measure(e,t,n),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(n))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[Oe("start_time")]=this.startTimestamp,e=this.perfStartMark,xe()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event["Microsoft.MSAL.correlation_id"]},set:function(e){this.event["Microsoft.MSAL.correlation_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[Oe("event_name")]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return P.a({},this.event,{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),e}(),Pe=function(e){function t(t,n,r,i){var o=e.call(this,Oe("default_event"),n,"DefaultEvent")||this;return o.event[Oe("client_id")]=r,o.event[Oe("sdk_plaform")]=t.sdk,o.event[Oe("sdk_version")]=t.sdkVersion,o.event[Oe("application_name")]=t.applicationName,o.event[Oe("application_version")]=t.applicationVersion,o.event[Oe("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,o.event.Microsoft_MSAL_ui_event_count=o.getEventCount(Oe("ui_event"),i),o.event.Microsoft_MSAL_http_event_count=o.getEventCount(Oe("http_event"),i),o.event.Microsoft_MSAL_cache_event_count=o.getEventCount(Oe("cache_event"),i),o}return P.d(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(Re),Ne=Oe("authority"),Le=Oe("authority_type"),Ue=Oe("ui_behavior"),Me=Oe("tenant_id"),De=Oe("user_id"),je=Oe("was_successful"),He=Oe("api_error_code"),qe=Oe("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(we||(we={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(Ce||(Ce={}));var Fe=((Te={})[Ce.AcquireTokenSilent]=we.AcquireTokenSilent,Te[Ce.AcquireTokenPopup]=we.AcquireTokenPopup,Te[Ce.AcquireTokenRedirect]=we.AcquireTokenRedirect,Te[Ce.LoginPopup]=we.LoginPopup,Te[Ce.LoginRedirect]=we.LoginRedirect,Te[Ce.Logout]=we.Logout,Te),Be=function(e){function t(t,n,r){var i=e.call(this,Oe("api_event"),t,r)||this;return r&&(i.apiCode=Fe[r],i.apiEventIdentifier=r),i.piiEnabled=n,i}return P.d(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event["msal.api_telem_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event["msal.api_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[Ne]=Ae(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[He]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[Me]=this.piiEnabled&&e?ke(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[De]=this.piiEnabled&&e?ke(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[je]},set:function(e){this.event[je]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[qe]=this.piiEnabled&&e?ke(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[Le]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[Ue]=e.toLowerCase()},enumerable:!0,configurable:!0}),t}(Re),Ke=Oe("http_path"),ze=Oe("user_agent"),We=Oe("query_parameters"),Ge=Oe("api_version"),Ve=Oe("response_code"),Qe=Oe("oauth_error_code"),Xe=Oe("http_method"),Je=Oe("request_id_header"),Ye=Oe("spe_info"),$e=Oe("server_error_code"),Ze=Oe("server_sub_error_code"),et=Oe("url"),tt=function(e){function t(t,n){return e.call(this,Oe("http_event"),t,n)||this}return P.d(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=Ae(e);this.event[et]=t&&t.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[Ke]=Ae(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[ze]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[We]=J.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[Ge]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[Ve]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[Qe]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[Xe]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[Je]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[Ye]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[$e]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[Ze]=e},enumerable:!0,configurable:!0}),t}(Re),nt=function(){function e(e,t,n){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=P.a({sdk:L.libraryName,sdkVersion:"1.4.4",networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=n}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},function(){},t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]&&(e.stop(),this.incrementEventCount(e),this.completedEvents[e.telemetryCorrelationId]=(this.completedEvents[e.telemetryCorrelationId]||[]).concat([e]),delete this.inProgressEvents[e.key])},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var n=this.getOrphanedEvents(e);n.forEach(function(e){return t.incrementEventCount(e)});var r=this.completedEvents[e].concat(n);delete this.completedEvents[e];var i=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],r&&r.length){var o=new Pe(this.telemetryPlatform,e,this.clientId,i),a=r.concat([o]);this.telemetryEmitter(a.map(function(e){return e.get()}))}}},e.prototype.createAndStartApiEvent=function(e,t){var n=new Be(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(n),n},e.prototype.stopAndFlushApiEvent=function(e,t,n,r){t.wasSuccessful=n,r&&(t.apiErrorCode=r),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,n,r){var i=new tt(e,r);return i.url=n,i.httpMethod=t,this.startEvent(i),i},e.prototype.incrementEventCount=function(e){var t,n=e.eventName,r=this.eventCountByCorrelationId[e.telemetryCorrelationId];r?r[n]=r[n]?r[n]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[n]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(n,r){if(-1!==r.indexOf(e)){var i=t.inProgressEvents[r];return delete t.inProgressEvents[r],n.concat([i])}return n},[])},e}(),rt=function(){function e(){}return e.filterTokenCacheItemsByScope=function(e,t){return e.filter(function(e){var n=e.key.scopes.split(" "),r=G.removeDefaultScopes(t);return G.containsScope(n,0===r.length?t:r)})},e.filterTokenCacheItemsByAuthority=function(e,t){return e.filter(function(e){return V.CanonicalizeUri(e.key.authority)===t})},e.filterTokenCacheItemsByDomain=function(e,t){return e.filter(function(e){return V.GetUrlComponents(e.key.authority).HostNameAndPort===t})},e}(),it=function(){function e(e){var t,n,r,i,o,a,s;this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(r=void 0===(n=(t=e).cache)?{}:n,o=void 0===(i=t.system)?{}:i,s=void 0===(a=t.framework)?{}:a,{auth:P.a({},me,t.auth),cache:P.a({},ge,r),system:P.a({},fe,o),framework:P.a({},ve,s)}),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),$.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),ue.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new ce(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var c=window.location.hash,l=V.urlContainsHash(c);de.checkIfBackButtonIsPressed(this.cacheStorage),l&&this.getResponseState(c).method===L.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(c)}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=ue.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw W.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(L.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(L.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),V.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,n){if(this.logger.verbose("AuthResponseHandler has been called"),e===L.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==L.interactionTypePopup)throw F.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),n(t)}},e.prototype.authErrorHandler=function(e,t,n,r){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.removeItem(g.INTERACTION_STATUS),e===L.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,n.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,n)}else{if(e!==L.interactionTypePopup)throw F.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),r(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=se.validateRequest(e,!0,this.clientId,L.interactionTypeRedirect);this.acquireTokenInteractive(L.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=se.validateRequest(e,!1,this.clientId,L.interactionTypeRedirect);this.acquireTokenInteractive(L.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var n=se.validateRequest(e,!0,this.clientId,L.interactionTypePopup),r=this.telemetryManager.createAndStartApiEvent(n.correlationId,Ce.LoginPopup);return new Promise(function(e,r){t.acquireTokenInteractive(L.interactionTypePopup,!0,n,e,r)}).then(function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!1,e.errorCode),e})},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var n=se.validateRequest(e,!1,this.clientId,L.interactionTypePopup),r=this.telemetryManager.createAndStartApiEvent(n.correlationId,Ce.AcquireTokenPopup);return new Promise(function(e,r){t.acquireTokenInteractive(L.interactionTypePopup,!1,n,e,r)}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!1,e.errorCode),e})},e.prototype.acquireTokenInteractive=function(e,t,n,r,i){var o=this;this.logger.verbose("AcquireTokenInteractive has been called"),de.blockReloadInHiddenIframes();var a,s=this.cacheStorage.getItem(g.INTERACTION_STATUS);if(e===L.interactionTypeRedirect&&this.cacheStorage.setItem(g.REDIRECT_REQUEST,""+L.inProgress+L.resourceDelimiter+n.state),s===L.inProgress){var c=t?F.createLoginInProgressError():F.createAcquireTokenInProgressError(),l=Ie(this.getAccountState(n.state));return this.cacheStorage.resetTempCacheItems(n.state),void this.authErrorHandler(e,c,l,i)}if(n&&n.account&&!t?(a=n.account,this.logger.verbose("Account set from request")):(a=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a||J.isSSOParam(n))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(a,e,t,n,r,i);else{if(!t)return this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required"),l=Ie(this.getAccountState(n.state)),this.cacheStorage.resetTempCacheItems(n.state),void this.authErrorHandler(e,F.createUserLoginRequiredError(),l,i);if(this.extractADALIdToken()&&!n.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var d=this.buildIDTokenRequest(n);this.silentLogin=!0,this.acquireTokenSilent(d).then(function(t){o.silentLogin=!1,o.logger.info("Unified cache call is successful"),o.authResponseHandler(e,t,r)},function(a){o.silentLogin=!1,o.logger.error("Error occurred during unified cache ATS: "+a),o.acquireTokenHelper(null,e,t,n,r,i)})}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,n,r,i)}},e.prototype.acquireTokenHelper=function(e,t,n,r,i,o){return P.b(this,void 0,void 0,function(){var a,s,c,l,d,p,u,h,m,f;return P.e(this,function(_){switch(_.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+n),this.cacheStorage.setItem(g.INTERACTION_STATUS,L.inProgress),a=r.scopes?r.scopes.join(" ").toLowerCase():L.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+a),c=r&&r.authority?ue.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance,_.label=1;case 1:return _.trys.push([1,11,,12]),c.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,ue.saveMetadataFromNetwork(c,this.telemetryManager,r.correlationId)]);case 2:return _.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),_.label=4;case 4:if(d=n?"id_token":this.getTokenType(e,r.scopes),p=r.redirectStartPage||window.location.href,s=new J(c,this.clientId,d,this.getRedirectUri(r&&r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(s,e,n,p),this.logger.verbose("Updating cache entries"),s.populateQueryParams(e,r),this.logger.verbose("Query parameters populated from account"),u=V.createNavigateUrl(s)+L.response_mode_fragment,t===L.interactionTypeRedirect)n?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(ce.generateTemporaryCacheKey(g.STATE_ACQ_TOKEN,r.state),s.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+s.state));else{if(t!==L.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),F.createInvalidInteractionTypeError();window.renewStates.push(s.state),window.requestType=n?L.login:L.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+s.state),this.registerCallback(s.state,a,i,o)}if(t!==L.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{l=this.openPopup(u,"msal",L.popUpWidth,L.popUpHeight),de.trackPopup(l)}catch(y){if(this.logger.info("popup_window_error:"+q),this.cacheStorage.setItem(v.ERROR,"popup_window_error"),this.cacheStorage.setItem(v.ERROR_DESC,q),o)return o(F.createPopupWindowError()),[2]}if(!l)return[3,8];_.label=5;case 5:return _.trys.push([5,7,,8]),[4,de.monitorPopupForHash(l,this.config.system.loadFrameTimeout,u,this.logger)];case 6:return h=_.sent(),this.handleAuthenticationResponse(h),this.cacheStorage.removeItem(g.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",h),de.closePopups(),[3,8];case 7:return m=_.sent(),o&&o(m),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",m.errorCode+L.resourceDelimiter+m.errorMessage):(this.cacheStorage.removeItem(g.INTERACTION_STATUS),l.close()),[3,8];case 8:return[3,10];case 9:r.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==r.onRedirectNavigate(u)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(u)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(u)),_.label=10;case 10:return[3,12];case 11:return f=_.sent(),this.logger.error(f),this.cacheStorage.resetTempCacheItems(r.state),this.authErrorHandler(t,F.createEndpointResolutionError(f.toString),Ie(r.state),o),l&&l.close(),[3,12];case 12:return[2]}})})},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw W.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw W.createSsoSilentError();return this.acquireTokenSilent(P.a({},e,{scopes:L.oidcScopes}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var n=se.validateRequest(e,!1,this.clientId,L.interactionTypeSilent),r=this.telemetryManager.createAndStartApiEvent(n.correlationId,Ce.AcquireTokenSilent),i=se.createRequestSignature(n);return new Promise(function(e,r){return P.b(t,void 0,void 0,function(){var t,o,a,s,c,l,d,p,u,h;return P.e(this,function(m){switch(m.label){case 0:if(de.blockReloadInHiddenIframes(),t=n.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),n.account?(o=n.account,this.logger.verbose("Account set from request")):(o=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a=this.cacheStorage.getItem(L.adalIdToken),!o&&!n.sid&&!n.loginHint&&H.isEmpty(a))return this.logger.info("User login is required"),[2,r(F.createUserLoginRequiredError())];if(s=this.getTokenType(o,n.scopes),this.logger.verbose("Response type: "+s),c=new J(ue.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata),this.clientId,s,this.getRedirectUri(n.redirectUri),n.scopes,n.state,n.correlationId),this.logger.verbose("Finished building server authentication request"),J.isSSOParam(n)||o?(c.populateQueryParams(o,n,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):o||H.isEmpty(a)?this.logger.verbose("No additional query parameters added"):(l=re.extractIdToken(a),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),c.populateQueryParams(o,null,l,!0)),!(d=n.claimsRequest||c.claimsValue)&&!n.forceRefresh)try{u=this.getCachedToken(c,o)}catch(g){p=g}return u?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(u.scopes)),e(u),[2,null]):[3,1];case 1:return p?(this.logger.infoPii(p.errorCode+":"+p.errorMessage),r(p),[2,null]):[3,2];case 2:this.logger.verbose(d?"Skipped cache lookup since claims were given":n.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup"),c.authorityInstance||(c.authorityInstance=n.authority?ue.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+c.authority),m.label=3;case 3:return m.trys.push([3,7,,8]),c.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,ue.saveMetadataFromNetwork(c.authorityInstance,this.telemetryManager,n.correlationId)]);case 4:return m.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),m.label=6;case 6:return window.activeRenewals[i]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[i],i,e,r)):n.scopes&&G.onlyContainsOidcScopes(n.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(i,e,r,o,c)):(this.logger.verbose("Renewing access token"),this.renewToken(i,e,r,o,c)),[3,8];case 7:return h=m.sent(),this.logger.error(h),r(F.createEndpointResolutionError(h.toString())),[2,null];case 8:return[2]}})})}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!1,e.errorCode),e})},e.prototype.openPopup=function(e,t,n,r){this.logger.verbose("OpenPopup has been called");try{var i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=window.open(e,t,"width="+n+", height="+r+", top="+(s/2-r/2+o)+", left="+(a/2-n/2+i)+", scrollbars=yes");if(!c)throw F.createPopupWindowError();return c.focus&&c.focus(),c}catch(l){throw this.cacheStorage.removeItem(g.INTERACTION_STATUS),F.createPopupWindowError(l.toString())}},e.prototype.loadIframeTimeout=function(e,t,n){return P.b(this,void 0,void 0,function(){var r,i,o,a,s;return P.e(this,function(c){switch(c.label){case 0:return r=window.activeRenewals[n],this.logger.verbosePii("Set loading state to pending for: "+n+":"+r),this.cacheStorage.setItem(ce.generateTemporaryCacheKey(g.RENEW_STATUS,r),L.inProgress),this.config.system.navigateFrameWait?[4,de.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return o=c.sent(),[3,3];case 2:o=de.loadFrameSync(e,t,this.logger),c.label=3;case 3:i=o,c.label=4;case 4:return c.trys.push([4,6,,7]),[4,de.monitorIframeForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(a=c.sent())&&this.handleAuthenticationResponse(a),[3,7];case 6:throw s=c.sent(),this.cacheStorage.getItem(ce.generateTemporaryCacheKey(g.RENEW_STATUS,r))===L.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+n+":"+r),r&&window.callbackMappedToRenewStates[r]&&window.callbackMappedToRenewStates[r](null,s),this.cacheStorage.removeItem(ce.generateTemporaryCacheKey(g.RENEW_STATUS,r))),de.removeHiddenIframe(i),s;case 7:return de.removeHiddenIframe(i),[2]}})})},e.prototype.navigateWindow=function(e,t){if(!e||H.isEmpty(e))throw this.logger.info("Navigate url is empty"),j.createUnexpectedError("Navigate url is empty");var n=t||window;this.logger.infoPii(t?"Navigated Popup window to:"+e:"Navigate to:"+e),n.location.assign(e)},e.prototype.registerCallback=function(e,t,n,r){var i=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:n,reject:r}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(n,r){window.activeRenewals[t]=null;for(var o=0;o<window.promiseMappedToRenewStates[e].length;++o)try{if(r)window.promiseMappedToRenewStates[e][o].reject(r);else{if(!n)throw i.cacheStorage.resetTempCacheItems(e),j.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][o].resolve(n)}}catch(a){i.logger.warning(a)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return P.b(this,void 0,void 0,function(){var t,n,r,i,o,a;return P.e(this,function(s){switch(s.label){case 0:t=e||N.createNewGuid(),n=this.telemetryManager.createAndStartApiEvent(t,Ce.Logout),this.clearCache(),this.account=null,s.label=1;case 1:return s.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,ue.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:return r="client-request-id="+t,i=void 0,this.getPostLogoutRedirectUri()?(i="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(i="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),o=void 0,this.authorityInstance.EndSessionEndpoint?(o=this.authorityInstance.EndSessionEndpoint+"?"+r+i,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(o=this.authority+"oauth2/v2.0/logout?"+r+i,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,n,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(o),[3,6];case 5:return a=s.sent(),this.telemetryManager.stopAndFlushApiEvent(t,n,!1,a.errorCode),[3,6];case 6:return[2]}})})},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(L.clientId,L.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(L.clientId,L.homeAccountIdentifier),n=0;n<t.length;n++){var r=t[n];r.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(r.key)),this.logger.verbosePii("Access token removed: "+r.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),V.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,n){var r,i;this.logger.info("ProcessCallBack has been called. Processing callback from redirect response"),t||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),t=this.getResponseState(e));try{r=this.saveTokenFromHash(e,t)}catch(a){i=a}try{this.cacheStorage.clearMsalCookie(t.state);var o=this.getAccountState(t.state);if(r){if(t.requestType===L.renewToken||r.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+m.ACCESS_TOKEN),r.tokenType=m.ACCESS_TOKEN):t.requestType===L.login&&(this.logger.verbose("Response tokenType set to "+m.ID_TOKEN),r.tokenType=m.ID_TOKEN),!n)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=r)}else if(!n)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=Ie(o),this.redirectError=i,void this.cacheStorage.resetTempCacheItems(t.state);this.logger.verbose("Calling callback provided to processCallback"),n(r,i)}catch(a){throw this.logger.error("Error occurred in token received callback function: "+a),F.createErrorInCallbackFunction(a.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,n=this.getResponseState(t);this.logger.verbose("Obtained state from response");var r=window.callbackMappedToRenewStates[n.state];this.processCallBack(t,n,r)},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),de.clearUrlFragment(),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var n=this.cacheStorage.getItem(ce.generateTemporaryCacheKey(g.LOGIN_REQUEST,t.state),this.inCookie);if(!n||"null"===n)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var r=V.removeHashFromUrl(window.location.href),i=V.removeHashFromUrl(n);if(r!==i)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+r+", finalRedirectUrl: "+i),void window.location.assign(""+i+e);this.logger.verbose("Current url matches login request url");var o=V.GetUrlComponents(n);o.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=o.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,n=V.deserializeHash(e);if(!n)throw j.createUnexpectedError("Hash was not parsed correctly.");if(!n.hasOwnProperty(m.STATE))throw j.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var r=se.parseLibraryState(n.state);if((t={requestType:L.unknown,state:n.state,timestamp:r.ts,method:r.method,stateMatch:!1}).state===this.cacheStorage.getItem(ce.generateTemporaryCacheKey(g.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=L.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(ce.generateTemporaryCacheKey(g.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=L.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var i=window.renewStates,o=0;o<i.length;o++)if(i[o]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var n=e.scopes,r=this.getCachedIdToken(e,t),i=this.getCachedAccessToken(e,t,n),o=this.getAccountState(e.state);return pe.buildAuthResponse(r,i,e,t,n,o)},e.prototype.getTokenCacheItemByAuthority=function(e,t,n,r){var i,o=this;return 1===(i=V.isCommonAuthority(e)||V.isOrganizationsAuthority(e)?rt.filterTokenCacheItemsByDomain(t,V.GetUrlComponents(e).HostNameAndPort):rt.filterTokenCacheItemsByAuthority(t,e)).length?i[0]:i.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),i.forEach(function(e){o.cacheStorage.removeItem(JSON.stringify(e.key))}),null):(this.logger.verbose("No matching tokens of type "+r+" found"),null)},e.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var n=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),r=this.getTokenCacheItemByAuthority(e.authority||this.authority,n,null,m.ID_TOKEN);if(r){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(r)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var i=r.value;return this.logger.verbose(i?"ID Token found in cache is valid and unexpired":"ID Token found in cache is invalid"),i?new ie(i.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(r.key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getCachedAccessToken=function(e,t,n){this.logger.verbose("Getting all cached tokens of type Access Token");var r=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),i=rt.filterTokenCacheItemsByScope(r,n),o=this.getTokenCacheItemByAuthority(e.authority||this.authority,i,n,m.ACCESS_TOKEN);if(o){if(e.authorityInstance=ue.CreateInstance(o.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(o)){if(this.logger.verbose("Access token expiration is within offset, using access token found in cache"),!t&&!(t=this.getAccount()))throw j.createUnexpectedError("Account should not be null here.");var a=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:m.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:o.value.accessToken,scopes:o.key.scopes.split(" "),expiresOn:new Date(1e3*Number(o.value.expiresIn)),account:t,accountState:a,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(o.key)),null}this.logger.verbose("No matching token found when filtering by scope and authority");var s=this.getUniqueAuthority(r,"authority");if(s.length>1)throw F.createMultipleAuthoritiesInCacheError(n.toString());return this.logger.verbose("Single authority used, setting authorityInstance"),e.authorityInstance=ue.CreateInstance(s[0],this.config.auth.validateAuthority),null},e.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return re.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},e.prototype.getUniqueAuthority=function(e,t){this.logger.verbose("GetUniqueAuthority has been called");var n=[],r=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===r.indexOf(e.key[t])&&(r.push(e.key[t]),n.push(e.key[t]))}),n},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(L.adalIdToken);return H.isEmpty(e)?null:re.extractIdToken(e)},e.prototype.renewToken=function(e,t,n,r,i){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var o=de.generateFrameName("msalRenewFrame",e);de.addHiddenIFrame(o,this.logger),this.updateCacheEntries(i,r,!1),this.logger.verbosePii("RenewToken expected state: "+i.state);var a=V.urlRemoveQueryStringParameter(V.createNavigateUrl(i),L.prompt)+L.prompt_none+L.response_mode_fragment;window.renewStates.push(i.state),window.requestType=L.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(i.state,e,t,n),this.logger.infoPii("Navigate to: "+a),this.loadIframeTimeout(a,o,e).catch(function(e){return n(e)})},e.prototype.renewIdToken=function(e,t,n,r,i){this.logger.info("RenewIdToken has been called");var o=de.generateFrameName("msalIdTokenFrame",e);de.addHiddenIFrame(o,this.logger),this.updateCacheEntries(i,r,!1),this.logger.verbose("RenewIdToken expected state: "+i.state);var a=V.urlRemoveQueryStringParameter(V.createNavigateUrl(i),L.prompt)+L.prompt_none+L.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=L.login,this.silentAuthenticationState=i.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=L.renewToken,window.renewStates.push(i.state)),this.registerCallback(i.state,e,t,n),this.logger.infoPii('Navigate to:" '+a),this.loadIframeTimeout(a,o,e).catch(function(e){return n(e)})},e.prototype.saveToken=function(e,t,n,r,i){var o=new Q(t,this.clientId,n,r.uid,r.utid),a=new X(e.accessToken,e.idToken.rawIdToken,i.toString(),r.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(o),JSON.stringify(a)),i?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*i)):this.logger.error("Could not parse expiresIn parameter for access token"),e},e.prototype.saveIdToken=function(e,t,n,r,i){this.logger.verbose("SaveIdToken has been called");var o=P.a({},e);o.scopes=L.oidcScopes,o.accessToken=n[m.ID_TOKEN];var a=Number(i.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(o,t,void 0,r,a)},e.prototype.saveAccessToken=function(e,t,n,r){this.logger.verbose("SaveAccessToken has been called");var i=P.a({},e),o=n[m.SCOPE],a=o.split(" "),s=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var c=0;c<s.length;c++){var l=s[c];if(l.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var d=l.key.scopes.split(" ");G.isIntersectingScopes(d,a)&&this.cacheStorage.removeItem(JSON.stringify(l.key))}}i.accessToken=n[m.ACCESS_TOKEN],i.scopes=a;var p=ne.parseExpiresIn(n[m.EXPIRES_IN]),u=se.parseLibraryState(n[m.STATE]).ts+p;return this.logger.verbose("Saving access token to cache"),this.saveToken(i,t,o,r,u)},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var n,r={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},i=V.deserializeHash(e),o="",a="",s=null;if(i.hasOwnProperty(m.ERROR_DESCRIPTION)||i.hasOwnProperty(m.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+i[m.ERROR]+"; Error description: "+i[m.ERROR_DESCRIPTION]),this.cacheStorage.setItem(v.ERROR,i[m.ERROR]),this.cacheStorage.setItem(v.ERROR_DESC,i[m.ERROR_DESCRIPTION]),t.requestType===L.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(v.LOGIN_ERROR,i[m.ERROR_DESCRIPTION]+":"+i[m.ERROR]),o=ce.generateAuthorityKey(t.state)),t.requestType===L.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),o=ce.generateAuthorityKey(t.state);var c=this.getAccount(),l=void 0;c&&!H.isEmpty(c.homeAccountIdentifier)?(l=c.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(l=L.no_account,this.logger.verbose("AccountId is set as no_account")),a=ce.generateAcquireTokenAccountKey(l,t.state)}var d=i[m.ERROR_DESCRIPTION];n=be.isInteractionRequiredError(i[m.ERROR])||be.isInteractionRequiredError(d)?new be(i[m.ERROR],i[m.ERROR_DESCRIPTION]):new _e(i[m.ERROR],i[m.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),i.hasOwnProperty(m.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(ce.generateTemporaryCacheKey(g.SESSION_STATE,t.state),i[m.SESSION_STATE])),r.accountState=this.getAccountState(t.state);var p=void 0;if(i.hasOwnProperty(m.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),r.accessToken=i[m.ACCESS_TOKEN],i.hasOwnProperty(m.SCOPE)&&(r.scopes=i[m.SCOPE].split(" ")),i.hasOwnProperty(m.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),s=new ie(i[m.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),s=new ie(this.cacheStorage.getItem(f.IDTOKEN))),r=pe.setResponseIdToken(r,s);var u=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s);this.logger.verbose("Got authority from cache"),i.hasOwnProperty(m.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),p=new te(i[m.CLIENT_INFO],u)):this.authorityInstance.AuthorityType===U.Adfs?p=te.createClientInfoFromIdToken(s,u):this.logger.warning("ClientInfo not received in the response from AAD"),r.account=le.createAccount(s,p),this.logger.verbose("Account object created from response");var h=void 0;r.account&&!H.isEmpty(r.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),h=r.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),h=L.no_account),a=ce.generateAcquireTokenAccountKey(h,t.state);var _=ce.generateAcquireTokenAccountKey(L.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var y=this.cacheStorage.getItem(a),S=void 0;H.isEmpty(y)?H.isEmpty(this.cacheStorage.getItem(_))||(this.logger.verbose("No acquireToken account retrieved from cache"),r=this.saveAccessToken(r,u,i,p)):(S=JSON.parse(y),this.logger.verbose("AcquireToken request account retrieved from cache"),r.account&&S&&le.compareAccounts(r.account,S)?(r=this.saveAccessToken(r,u,i,p),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(i.hasOwnProperty(m.ID_TOKEN))if(this.logger.info("Fragment has idToken"),s=new ie(i[m.ID_TOKEN]),u=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s),r=pe.setResponseIdToken(r,s),i.hasOwnProperty(m.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),p=new te(i[m.CLIENT_INFO],u)):this.authorityInstance.AuthorityType===U.Adfs?p=te.createClientInfoFromIdToken(s,u):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=le.createAccount(s,p),r.account=this.account,this.logger.verbose("Account object created from response"),s&&s.nonce){this.logger.verbose("IdToken has nonce");var E=this.cacheStorage.getItem(ce.generateTemporaryCacheKey(g.NONCE_IDTOKEN,t.state),this.inCookie);s.nonce!==E?(this.account=null,this.cacheStorage.setItem(v.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+E+",Actual Nonce: "+s.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+E+", Actual Nonce: "+s.nonce),n=F.createNonceMismatchError(E,s.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(f.IDTOKEN,i[m.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(f.CLIENT_INFO,p.encodeClientInfo(),this.inCookie),this.saveIdToken(r,u,i,p,s))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),o=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),n=F.createInvalidIdTokenError(s),this.cacheStorage.setItem(v.ERROR,n.errorCode),this.cacheStorage.setItem(v.ERROR_DESC,n.errorMessage)}else{this.logger.verbose("State mismatch"),o=t.state,a=t.state;var b=this.cacheStorage.getItem(ce.generateTemporaryCacheKey(g.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+b+", Actual State: "+t.state),n=F.createInvalidStateError(t.state,b),this.cacheStorage.setItem(v.ERROR,n.errorCode),this.cacheStorage.setItem(v.ERROR_DESC,n.errorMessage)}if(this.cacheStorage.removeItem(ce.generateTemporaryCacheKey(g.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(o,"",-1),this.cacheStorage.clearMsalCookie(t.state)),n)throw n;if(!r)throw j.createUnexpectedError("Response is null");return r},e.prototype.populateAuthority=function(e,t,n,r){this.logger.verbose("PopulateAuthority has been called");var i=ce.generateAuthorityKey(e),o=n.getItem(i,t);return H.isEmpty(o)?o:V.replaceTenantPath(o,r.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(f.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(f.CLIENT_INFO,this.inCookie);if(!H.isEmpty(e)&&!H.isEmpty(t)){var n=new ie(e),r=new te(t,"");return this.account=le.createAccount(n,r),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(L.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(L.clientId,L.homeAccountIdentifier),n=0;n<t.length;n++){var r=new ie(t[n].value.idToken),i=new te(t[n].value.homeAccountIdentifier,""),o=le.createAccount(r,i);e.push(o)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],n=[],r=0;r<e.length;++r)e[r].homeAccountIdentifier&&-1===t.indexOf(e[r].homeAccountIdentifier)&&(t.push(e[r].homeAccountIdentifier),n.push(e[r]));return n},e.prototype.broadcast=function(e,t){var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},e.prototype.getCachedTokenInternal=function(e,t,n,r){var i=t||this.getAccount();if(!i)return null;var o=this.authorityInstance?this.authorityInstance:ue.CreateInstance(this.authority,this.config.auth.validateAuthority),a=this.getTokenType(i,e),s=new J(o,this.clientId,a,this.getRedirectUri(),e,n,r);return this.getCachedToken(s,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var n=0,r=Array.from(this.config.framework.protectedResourceMap.keys());n<r.length;n++){var i=r[n];if(e.indexOf(i)>-1)return this.config.framework.protectedResourceMap.get(i)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?V.getHostFromUri(e)===V.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(g.INTERACTION_STATUS)===L.inProgress},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(g.INTERACTION_STATUS,L.inProgress):this.cacheStorage.removeItem(g.INTERACTION_STATUS)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(g.INTERACTION_STATUS)===L.inProgress},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw W.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t){var n=le.compareAccounts(e,this.getAccount());return J.determineResponseType(n,t)},e.prototype.setAccountCache=function(e,t){var n=e?this.getAccountId(e):L.no_account,r=ce.generateAcquireTokenAccountKey(n,t);this.cacheStorage.setItem(r,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var n=ce.generateAuthorityKey(e);this.cacheStorage.setItem(n,V.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,n,r){r&&this.cacheStorage.setItem(ce.generateTemporaryCacheKey(g.LOGIN_REQUEST,e.state),r,this.inCookie),n?this.cacheStorage.setItem(ce.generateTemporaryCacheKey(g.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(ce.generateTemporaryCacheKey(g.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return H.isEmpty(e.homeAccountIdentifier)?L.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:L.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return nt.getTelemetrymanagerStub(t,this.logger);var n=e.applicationName,r=e.applicationVersion,i=e.telemetryEmitter;if(!n||!r||!i)throw W.createTelemetryConfigError(e);return new nt({platform:{applicationName:n,applicationVersion:r},clientId:t},i,this.logger)},e}(),ot=n("QkXj"),at=n("4Fy5"),st=n("JqCM");let ct=(()=>{class e extends C.Qb{constructor(e){super(),this.initialized=!1,this.name=e.name,this.clientId=e.clientId,this.additionalParams=e.additionalParams,this.icon=e.name.toLowerCase()}}return e.FACEBOOK="Facebook",e.GOOGLE="Google",e.MICROSOFT="Microsoft",e.OPENID="OpenIdConnect",e.WSFEDERATION="WsFederation",e.TWITTER="Twitter",e})(),lt=(()=>{class e{constructor(e,t,n,r,i,o,a,s,c){this._tokenAuthService=e,this._router=t,this._messageService=n,this._tokenService=r,this._logService=i,this.oauthService=o,this.spinnerService=a,this._localStorageService=s,this._twitterService=c,this.externalLoginProviders=[],this.localizationSourceName=b.a.localization.defaultLocalizationSourceName,this.clear()}authenticate(t,n,r){t=t||(()=>{this.spinnerService.hide()});const i=this;this._localStorageService.getItem(e.twoFactorRememberClientTokenName,function(e,o){i.authenticateModel.twoFactorRememberClientToken=null==o?void 0:o.token,i.authenticateModel.singleSignIn=w.a.getSingleSignIn(),i.authenticateModel.returnUrl=w.a.getReturnUrl(),i.authenticateModel.captchaResponse=r,i._tokenAuthService.authenticate(i.authenticateModel).subscribe({next:e=>{i.processAuthenticateResult(e,n),t()},error:e=>{t()}})})}externalAuthenticate(e){this.ensureExternalLoginProviderInitialized(e,()=>{if(e.name===ct.FACEBOOK)FB.login(e=>{this.facebookLoginStatusChangeCallback(e)},{scope:"email"});else if(e.name===ct.GOOGLE)gapi.auth2.getAuthInstance().signIn().then(()=>{this.googleLoginStatusChangeCallback(gapi.auth2.getAuthInstance().isSignedIn.get())});else if(e.name===ct.MICROSOFT){let e=["user.read"];this.spinnerService.show(),this.MSAL.loginPopup({scopes:e}).then(t=>{this.MSAL.acquireTokenSilent({scopes:e}).then(e=>{this.microsoftLoginCallback(e),this.spinnerService.hide()}).catch(e=>{abp.log.error(e),abp.message.error(this.localization.localize("CouldNotValidateExternalUser",this.localizationSourceName))})})}else e.name===ct.TWITTER&&this.startTwitterLogin()})}init(){this.initExternalLoginProviders()}processAuthenticateResult(e,t){this.authenticateResult=e,e.shouldResetPassword?(this._router.navigate(["account/reset-password"],{queryParams:{userId:e.userId,tenantId:abp.session.tenantId,resetCode:e.passwordResetCode}}),this.clear()):e.requiresTwoFactorVerification?this._router.navigate(["account/send-code"]):e.accessToken?(e.returnUrl&&!t&&(t=e.returnUrl),this.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,this.rememberMe,e.twoFactorRememberClientToken,t)):(this._logService.warn("Unexpected authenticateResult!"),this._router.navigate(["account/login"]))}login(t,n,r,i,o,a,s,c){let l=a?new Date((new Date).getTime()+1e3*r):void 0;if(this._tokenService.setToken(t,l),i&&a){let e=a?new Date((new Date).getTime()+1e3*o):void 0;this._tokenService.setRefreshToken(i,e)}if(this._localStorageService.setItem(b.a.authorization.encrptedAuthTokenName,{token:n,expireDate:l}),s&&this._localStorageService.setItem(e.twoFactorRememberClientTokenName,{token:s,expireDate:new Date((new Date).getTime()+31536e6)}),c)location.href=c;else{let e=w.a.initialUrl;e.indexOf("/account")>0&&(e=b.a.appBaseUrl),location.href=e}}clear(){this.authenticateModel=new C.n,this.authenticateModel.rememberClient=!1,this.authenticateResult=null,this.rememberMe=!1}initExternalLoginProviders(e){this._tokenAuthService.getExternalAuthenticationProviders().subscribe(t=>{this.externalLoginProviders=Object(k.a)(t,e=>new ct(e)),e&&e()})}ensureExternalLoginProviderInitialized(e,t){if(e.initialized)t();else if(e.name===ct.FACEBOOK)(new A.a).load("//connect.facebook.net/en_US/sdk.js").then(()=>{FB.init({appId:e.clientId,cookie:!1,xfbml:!0,version:"v2.5"}),FB.getLoginStatus(e=>{this.facebookLoginStatusChangeCallback(e),"connected"!==e.status&&t()})});else if(e.name===ct.GOOGLE)(new A.a).load("https://apis.google.com/js/api.js").then(()=>{gapi.load("client:auth2",()=>{gapi.client.init({clientId:e.clientId,scope:"openid profile email"}).then(()=>{t()})})});else if(e.name===ct.MICROSOFT)this.MSAL=new it({auth:{clientId:e.clientId,redirectUri:b.a.appBaseUrl}}),t();else if(e.name===ct.OPENID){const t=this.getOpenIdConnectConfig(e);this.oauthService.configure(t),this.oauthService.initImplicitFlow("openIdConnect=1")}else if(e.name===ct.WSFEDERATION){let t=this.getWsFederationConnectConfig(e);this.wsFederationAuthenticationContext=new R(t),this.wsFederationAuthenticationContext.login()}else e.name===ct.TWITTER&&t()}getWsFederationConnectConfig(e){let t={clientId:e.clientId,popUp:!0,callback:this.wsFederationLoginStatusChangeCallback.bind(this)};return e.additionalParams.Tenant&&(t.tenant=e.additionalParams.Tenant),t}getOpenIdConnectConfig(e){let t=new x.a;return t.loginUrl=e.additionalParams.LoginUrl,t.issuer=e.additionalParams.Authority,t.skipIssuerCheck="false"===e.additionalParams.ValidateIssuer,t.clientId=e.clientId,t.responseType="id_token",t.redirectUri=window.location.origin+"/account/login",t.scope="openid profile",t.requestAccessToken=!1,t}facebookLoginStatusChangeCallback(e){if("connected"===e.status){const t=new C.Pb;t.authProvider=ct.FACEBOOK,t.providerAccessCode=e.authResponse.accessToken,t.providerKey=e.authResponse.userID,t.singleSignIn=w.a.getSingleSignIn(),t.returnUrl=w.a.getReturnUrl(),this._tokenAuthService.externalAuthenticate(t).subscribe(e=>{e.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):this.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl)})}}openIdConnectLoginCallback(e){this.initExternalLoginProviders(()=>{let e=Object(T.a)(this.externalLoginProviders,{name:"OpenIdConnect"})[0],t=this.getOpenIdConnectConfig(e);this.oauthService.configure(t),this.spinnerService.show(),this.oauthService.tryLogin().then(()=>{let e=this.oauthService.getIdentityClaims();const t=new C.Pb;t.authProvider=ct.OPENID,t.providerAccessCode=this.oauthService.getIdToken(),t.providerKey=e.sub,t.singleSignIn=w.a.getSingleSignIn(),t.returnUrl=w.a.getReturnUrl(),this._tokenAuthService.externalAuthenticate(t).pipe(Object(O.a)(()=>{this.spinnerService.hide()})).subscribe(e=>{e.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):this.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl)})})})}startTwitterLogin(){this.spinnerService.show(),this._twitterService.getRequestToken().pipe(Object(O.a)(()=>this.spinnerService.hide())).subscribe(e=>{e.confirmed?window.location.href=e.redirectUrl:this._messageService.error("Couldn't get twitter request token !")})}twitterLoginCallback(e,t){this.spinnerService.show(),this._twitterService.getAccessToken(e,t).subscribe(e=>{const t=new C.Pb;t.authProvider=ct.TWITTER,t.providerAccessCode=e.accessToken+"&"+e.accessTokenSecret,t.providerKey=e.userId,t.singleSignIn=w.a.getSingleSignIn(),t.returnUrl=w.a.getReturnUrl(),this._tokenAuthService.externalAuthenticate(t).pipe(Object(O.a)(()=>{this.spinnerService.hide()})).subscribe(e=>{e.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):this.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl)})})}googleLoginStatusChangeCallback(e){if(e){const e=new C.Pb;e.authProvider=ct.GOOGLE,e.providerAccessCode=gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token,e.providerKey=gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile().getId(),e.singleSignIn=w.a.getSingleSignIn(),e.returnUrl=w.a.getReturnUrl(),this._tokenAuthService.externalAuthenticate(e).subscribe(e=>{e.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):this.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl)})}}wsFederationLoginStatusChangeCallback(e,t,n,r){let i=this.wsFederationAuthenticationContext.getCachedUser();const o=new C.Pb;o.authProvider=ct.WSFEDERATION,o.providerAccessCode=t,o.providerKey=i.profile.sub,o.singleSignIn=w.a.getSingleSignIn(),o.returnUrl=w.a.getReturnUrl(),this._tokenAuthService.externalAuthenticate(o).subscribe(e=>{if(e.waitingForActivation)return this._messageService.info("You have successfully registered. Waiting for activation!"),void this._router.navigate(["account/login"]);this.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl)})}microsoftLoginCallback(e){const t=new C.Pb;t.authProvider=ct.MICROSOFT,t.providerAccessCode=e.accessToken,t.providerKey=e.idToken.objectId,t.singleSignIn=w.a.getSingleSignIn(),t.returnUrl=w.a.getReturnUrl(),this.spinnerService.show(),this._tokenAuthService.externalAuthenticate(t).subscribe(e=>{e.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):(this.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl),this.spinnerService.hide())})}}return e.twoFactorRememberClientTokenName="TwoFactorRememberClientToken",e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275inject"](C.Ve),l["\u0275\u0275inject"](S.e),l["\u0275\u0275inject"](at.h),l["\u0275\u0275inject"](at.m),l["\u0275\u0275inject"](at.g),l["\u0275\u0275inject"](x.c),l["\u0275\u0275inject"](st.c),l["\u0275\u0275inject"](ot.a),l["\u0275\u0275inject"](C.We))},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();var dt=n("NBh3");function pt(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",3),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](e);const n=t.$implicit;return l["\u0275\u0275nextContext"](2).changeLanguage(n)}),l["\u0275\u0275element"](1,"i"),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;l["\u0275\u0275propertyInterpolate"]("title",e.displayName),l["\u0275\u0275advance"](1),l["\u0275\u0275classMap"](e.icon),l["\u0275\u0275attribute"]("aria-label",e.displayName)}}function ut(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",1),l["\u0275\u0275template"](1,pt,2,5,"div",2),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",e.languages)}}let ht=(()=>{class e extends I.a{constructor(e){super(e),this.languages=[]}ngOnInit(){this.languages=Object(T.a)(abp.localization.languages,e=>!1===e.isDisabled),this.currentLanguage=abp.localization.currentLanguage}changeLanguage(e){abp.utils.setCookieValue("Abp.Localization.CultureName",e.name,new Date((new Date).getTime()+15768e7),abp.appPath),location.reload()}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["language-switch"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[["class","ml-1 mx-auto",4,"ngIf"],[1,"ml-1","mx-auto"],["class","btn language-switch-btn btn-clean btn-icon p-0 m-0",3,"title","click",4,"ngFor","ngForOf"],[1,"btn","language-switch-btn","btn-clean","btn-icon","p-0","m-0",3,"title","click"]],template:function(e,t){1&e&&l["\u0275\u0275template"](0,ut,2,1,"div",0),2&e&&l["\u0275\u0275property"]("ngIf",t.languages.length>1)},directives:[r.t,r.s],styles:[".language-switch-btn[_ngcontent-%COMP%] { width: auto; height: auto; }"]}),e})();var mt=n("GWLn"),gt=n("S8ex"),ft=n("kPyj");const vt=["tenantChangeModal"],_t=["tenancyNameInput"];function yt(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"span",25),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"TenancyNameRequired")," "))}const St=function(e){return{edited:e}};function Et(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"form",5,6),l["\u0275\u0275listener"]("ngSubmit",function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().save()}),l["\u0275\u0275elementStart"](2,"div",7),l["\u0275\u0275elementStart"](3,"h5",8),l["\u0275\u0275elementStart"](4,"span"),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"button",9),l["\u0275\u0275listener"]("click",function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().close()}),l["\u0275\u0275element"](8,"i",10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](9,"div",11),l["\u0275\u0275elementStart"](10,"div",12),l["\u0275\u0275elementStart"](11,"label",13),l["\u0275\u0275text"](12),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](14,"div",14),l["\u0275\u0275elementStart"](15,"span",15),l["\u0275\u0275elementStart"](16,"label"),l["\u0275\u0275elementStart"](17,"input",16),l["\u0275\u0275listener"]("ngModelChange",function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().isSwitchToTenant=t})("change",function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().switchToTenant(t)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](18,"span"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](19,"div",17),l["\u0275\u0275elementStart"](20,"label",13),l["\u0275\u0275elementStart"](21,"label"),l["\u0275\u0275text"](22),l["\u0275\u0275pipe"](23,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](24,"label",14),l["\u0275\u0275elementStart"](25,"input",18,19),l["\u0275\u0275listener"]("ngModelChange",function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().tenancyName=t}),l["\u0275\u0275pipe"](27,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](28,yt,3,3,"span",20),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](29,"div",21),l["\u0275\u0275elementStart"](30,"button",22),l["\u0275\u0275listener"]("click",function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().close()}),l["\u0275\u0275text"](31),l["\u0275\u0275pipe"](32,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](33,"button",23),l["\u0275\u0275element"](34,"i",24),l["\u0275\u0275elementStart"](35,"span"),l["\u0275\u0275text"](36),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275reference"](1),t=l["\u0275\u0275reference"](26),n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](6,16,"ChangeTenant")),l["\u0275\u0275advance"](7),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](13,18,"SwitchToTenant")),l["\u0275\u0275advance"](5),l["\u0275\u0275propertyInterpolate"]("value",n.isSwitchToTenant?"true":"false"),l["\u0275\u0275property"]("ngModel",n.isSwitchToTenant),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](23,20,"TenancyName")),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate"]("placeholder",n.isSwitchToTenant?l["\u0275\u0275pipeBind1"](27,22,"EnterTenancyName"):""),l["\u0275\u0275property"]("ngClass",l["\u0275\u0275pureFunction1"](26,St,n.tenancyName))("ngModel",n.tenancyName)("disabled",!n.isSwitchToTenant),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",n.isSwitchToTenant&&!t.pristine&&!n.tenancyName),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",n.saving),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](32,24,"Cancel")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!e.form.valid)("buttonBusy",n.saving)("busyText",n.l("ProcessingWithThreeDot")),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](n.submitButtonText)}}const bt=function(){return{backdrop:"static"}};let It=(()=>{class e extends I.a{constructor(e,t){super(t),this._accountService=e,this.tenancyName="",this.tenancyNameBuffer="",this.submitButtonText="",this.isSwitchToTenant=!1,this.active=!1,this.saving=!1}focusTenancyNameInput(){setTimeout(()=>{document.getElementById("tenancyNameInput").focus()},100)}updateSubmitButtonText(){this.submitButtonText=this.l(this.isSwitchToTenant?"SwitchToTheTenant":"SwitchToTheHost")}show(e){this.tenancyName=e,this.isSwitchToTenant=!!e,this.updateSubmitButtonText(),this.active=!0,this.modal.show()}onShown(){this.focusTenancyNameInput()}switchToTenant(e){e.target.checked?(this.tenancyName=this.tenancyNameBuffer,this.focusTenancyNameInput()):(this.tenancyNameBuffer=this.tenancyName,this.tenancyName=""),this.updateSubmitButtonText()}save(){if(!this.tenancyName)return abp.multiTenancy.setTenantIdCookie(void 0),this.close(),void location.reload();let e=new C.Oc;e.tenancyName=this.tenancyName,this.saving=!0,this._accountService.isTenantAvailable(e).pipe(Object(O.a)(()=>{this.saving=!1})).subscribe(e=>{switch(e.state){case C.Ae.Available:return abp.multiTenancy.setTenantIdCookie(e.tenantId),this.close(),void location.reload();case C.Ae.InActive:this.message.warn(this.l("TenantIsNotActive",this.tenancyName)),this.focusTenancyNameInput();break;case C.Ae.NotFound:this.message.warn(this.l("ThereIsNoTenantDefinedWithName{0}",this.tenancyName)),this.focusTenancyNameInput()}})}close(){this.active=!1,this.modal.hide()}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](C.b),l["\u0275\u0275directiveInject"](l.Injector))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["tenantChangeModal"]],viewQuery:function(e,t){if(1&e&&(l["\u0275\u0275staticViewQuery"](vt,!0),l["\u0275\u0275staticViewQuery"](_t,!0)),2&e){let e;l["\u0275\u0275queryRefresh"](e=l["\u0275\u0275loadQuery"]())&&(t.modal=e.first),l["\u0275\u0275queryRefresh"](e=l["\u0275\u0275loadQuery"]())&&(t.tenancyNameInput=e.first)}},features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:3,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","tenantChangeModal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["tenantChangeModal","bs-modal"],[1,"modal-dialog"],[1,"modal-content"],["novalidate","","class","form form-label-right",3,"ngSubmit",4,"ngIf"],["novalidate","",1,"form","form-label-right",3,"ngSubmit"],["changeTenantForm","ngForm"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-hidden","true",1,"close",3,"click"],["aria-hidden","true",1,"ki","ki-close"],[1,"modal-body"],[1,"form-group","row","text-left","mb-0"],[1,"col-4","col-form-label"],[1,"col"],[1,"switch","switch-icon"],["checked","checked","name","SwitchToTenant","type","checkbox",3,"ngModel","value","ngModelChange","change"],[1,"form-group","row","mb-0"],["type","text","id","tenancyNameInput","name","tenancyNameInput","required","","maxlength","64",1,"form-control",3,"ngClass","ngModel","disabled","placeholder","ngModelChange"],["tenancyNameInput","ngModel"],["class","form-text text-danger text-left",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","font-weight-bold",3,"disabled","click"],["type","submit",1,"btn","btn-primary","font-weight-bold","save-button",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-arrow-circle-right"],[1,"form-text","text-danger","text-left"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0,1),l["\u0275\u0275listener"]("onShown",function(){return t.onShown()}),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"div",3),l["\u0275\u0275template"](4,Et,37,28,"form",4),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("config",l["\u0275\u0275pureFunction0"](2,bt)),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngIf",t.active))},directives:[mt.a,r.t,a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,a.CheckboxControlValueAccessor,a.NgControlStatus,a.NgModel,a.DefaultValueAccessor,a.RequiredValidator,a.MaxLengthValidator,r.q,gt.a],pipes:[ft.a],encapsulation:2}),e})();const Tt=["tenantChangeModal"];function wt(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span",4),l["\u0275\u0275elementStart"](1,"strong"),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275propertyInterpolate"]("title",e.name),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](e.tenancyName)}}function Ct(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](2,1,"NotSelected")))}function At(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275template"](3,wt,3,2,"span",1),l["\u0275\u0275template"](4,Ct,3,3,"span",0),l["\u0275\u0275text"](5," ("),l["\u0275\u0275elementStart"](6,"a",2),l["\u0275\u0275listener"]("click",function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().showChangeModal()}),l["\u0275\u0275text"](7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](8,") "),l["\u0275\u0275element"](9,"tenantChangeModal",null,3),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,4,"CurrentTenant"),": "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",e.tenancyName),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!e.tenancyName),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](e.l("Change"))}}let kt=(()=>{class e extends I.a{constructor(e,t){super(e),this._accountService=t}ngOnInit(){this.appSession.tenant&&(this.tenancyName=this.appSession.tenant.tenancyName,this.name=this.appSession.tenant.name)}get isMultiTenancyEnabled(){return abp.multiTenancy.isEnabled}showChangeModal(){this.tenantChangeModal.show(this.tenancyName)}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](C.b))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["tenant-change"]],viewQuery:function(e,t){if(1&e&&l["\u0275\u0275viewQuery"](Tt,!0),2&e){let e;l["\u0275\u0275queryRefresh"](e=l["\u0275\u0275loadQuery"]())&&(t.tenantChangeModal=e.first)}},features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[[4,"ngIf"],[3,"title",4,"ngIf"],["href","javascript:;",3,"click"],["tenantChangeModal",""],[3,"title"]],template:function(e,t){1&e&&l["\u0275\u0275template"](0,At,11,6,"span",0),2&e&&l["\u0275\u0275property"]("ngIf",t.isMultiTenancyEnabled)},directives:[r.t,It],pipes:[ft.a],encapsulation:2}),e})();function Ot(e,t){if(1&e&&l["\u0275\u0275element"](0,"img",17),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275property"]("src",e.appRootUrl()+"assets/common/images/app-logo-on-dark.svg",l["\u0275\u0275sanitizeUrl"])}}function xt(e,t){if(1&e&&l["\u0275\u0275element"](0,"img",17),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275property"]("src",e.remoteServiceBaseUrl+"/TenantCustomization/GetTenantLogo?skin=light&tenantId="+e.appSession.tenant.id+"&id="+e.appSession.tenant.logoId,l["\u0275\u0275sanitizeUrl"])}}function Rt(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",11),l["\u0275\u0275elementStart"](1,"div",12),l["\u0275\u0275elementStart"](2,"a",13),l["\u0275\u0275listener"]("click",function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().goToHome()}),l["\u0275\u0275template"](3,Ot,1,1,"img",14),l["\u0275\u0275template"](4,xt,1,1,"img",14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"h3",15),l["\u0275\u0275text"](6," Base solution for your "),l["\u0275\u0275element"](7,"br"),l["\u0275\u0275text"](8," next web application. "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](9,"div",16),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",!e.appSession.tenant||!e.appSession.tenant.logoId),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.appSession.tenant&&e.appSession.tenant.logoId)}}function Pt(e,t){if(1&e&&l["\u0275\u0275element"](0,"img",17),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275property"]("src",e.appRootUrl()+"assets/common/images/app-logo-on-light.svg",l["\u0275\u0275sanitizeUrl"])}}function Nt(e,t){if(1&e&&l["\u0275\u0275element"](0,"img",17),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275property"]("src",e.remoteServiceBaseUrl+"/TenantCustomization/GetTenantLogo?skin=light&tenantId="+e.appSession.tenant.id+"&id="+e.appSession.tenant.logoId,l["\u0275\u0275sanitizeUrl"])}}function Lt(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"a",13),l["\u0275\u0275listener"]("click",function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().goToHome()}),l["\u0275\u0275template"](1,Pt,1,1,"img",14),l["\u0275\u0275template"](2,Nt,1,1,"img",14),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!e.appSession.tenant||!e.appSession.tenant.logoId),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.appSession.tenant&&e.appSession.tenant.logoId)}}function Ut(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",18),l["\u0275\u0275element"](1,"tenant-change"),l["\u0275\u0275elementEnd"]())}const Mt=function(e){return{"login-content":e}};let Dt=(()=>{class e extends I.a{constructor(e,t,n,r,i,o){super(e),this._router=t,this._loginService=n,this._uiCustomizationService=r,this._dateTimeService=i,this.currentYear=this._dateTimeService.getYear(),this.remoteServiceBaseUrl=b.a.remoteServiceBaseUrl,this.tenantChangeDisabledRoutes=["select-edition","buy","upgrade","extend","register-tenant","stripe-purchase","stripe-subscribe","stripe-update-subscription","paypal-purchase","stripe-payment-result","payment-completed","stripe-cancel-payment","session-locked","enrollment"],this.viewContainerRef=o}showTenantChange(){return!!this._router.url&&!Object(T.a)(this.tenantChangeDisabledRoutes,e=>this._router.url.indexOf("/account/"+e)>=0).length&&abp.multiTenancy.isEnabled&&!this.supportsTenancyNameInUrl()}useFullWidthLayout(){return this._router.url.indexOf("/account/select-edition")>=0||this._router.url.indexOf("/account/enrollment")>=0}ngOnInit(){this._loginService.init(),document.body.className=this._uiCustomizationService.getAccountModuleBodyClass()}goToHome(){window.location.href="/"}getBgUrl(){return"url(./assets/metronic/themes/"+this.currentTheme.baseSettings.theme+"/images/bg/bg-4.jpg)"}supportsTenancyNameInUrl(){return b.a.appBaseUrlFormat&&b.a.appBaseUrlFormat.indexOf(b.a.tenancyNamePlaceHolderInUrl)>=0}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](lt),l["\u0275\u0275directiveInject"](E.a),l["\u0275\u0275directiveInject"](dt.a),l["\u0275\u0275directiveInject"](l.ViewContainerRef))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:12,vars:6,consts:[[1,"d-flex","flex-column","flex-root"],["id","kt_login",1,"login","login-1","login-signin-on","d-flex","flex-column","flex-lg-row","flex-column-fluid","bg-white"],["class","login-aside d-flex flex-column flex-row-auto","style","background-color: #F2C98A;",4,"ngIf"],[1,"flex-row-fluid","d-flex","flex-column","justify-content-center","position-relative","overflow-hidden","p-7","mx-auto",3,"ngClass"],[1,"d-flex","flex-column-fluid","flex-center"],[1,"login-form","login-signin"],[1,"pb-13","pt-lg-0","pt-5"],["href","","class","text-center mb-10",3,"click",4,"ngIf"],["class","login__signup-label tenant-change-box",4,"ngIf"],[1,"d-flex","justify-content-lg-start","justify-content-center","align-items-end","py-7","py-lg-0"],[1,"mx-auto"],[1,"login-aside","d-flex","flex-column","flex-row-auto",2,"background-color","#F2C98A"],[1,"d-flex","flex-column-auto","flex-column","pt-lg-40","pt-15"],["href","",1,"text-center","mb-10",3,"click"],["alt","logo","class","max-h-70px",3,"src",4,"ngIf"],[1,"font-weight-bolder","text-center","font-size-h4","font-size-h1-lg",2,"color","#986923"],[1,"aside-img","d-flex","flex-row-fluid","bgi-no-repeat","bgi-position-y-bottom","bgi-position-x-center",2,"background-image","url(/assets/metronic/assets/media/svg/illustrations/login-visual-1.svg)"],["alt","logo",1,"max-h-70px",3,"src"],[1,"login__signup-label","tenant-change-box"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275template"](2,Rt,10,2,"div",2),l["\u0275\u0275elementStart"](3,"div",3),l["\u0275\u0275elementStart"](4,"div",4),l["\u0275\u0275elementStart"](5,"div",5),l["\u0275\u0275elementStart"](6,"div",6),l["\u0275\u0275template"](7,Lt,3,2,"a",7),l["\u0275\u0275template"](8,Ut,2,0,"div",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](9,"router-outlet"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",9),l["\u0275\u0275element"](11,"language-switch",10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",!t.useFullWidthLayout()),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngClass",l["\u0275\u0275pureFunction1"](4,Mt,!t.useFullWidthLayout())),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngIf",t.useFullWidthLayout()),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.showTenantChange()))},directives:[r.t,r.q,S.j,ht,kt],styles:[".login.login-1 .login-aside .aside-img{min-height:450px}.login.login-1 .login-forgot,.login.login-1 .login-signin,.login.login-1 .login-signup,.login.login-1.login-signin-on .login-signup{display:none}.login.login-1.login-signin-on .login-signin{display:block}.login.login-1.login-signin-on .login-forgot{display:none}.login.login-1.login-signup-on .login-signup{display:block}.login.login-1.login-forgot-on .login-signin,.login.login-1.login-forgot-on .login-signup,.login.login-1.login-signup-on .login-forgot,.login.login-1.login-signup-on .login-signin{display:none}.login.login-1.login-forgot-on .login-forgot{display:block}@media (min-width:992px){.login.login-1 .login-aside{width:100%;max-width:600px}.login.login-1 .login-content{width:100%;max-width:500px}.login.login-1 .login-content .login-form{width:100%;max-width:450px}}@media (min-width:992px) and (max-width:1399.98px){.login.login-1 .login-aside{width:100%;max-width:450px}}@media (max-width:991.98px){.login.login-1 .login-content .login-form{width:100%;max-width:400px}}@media (max-width:575.98px){.login.login-1 .aside-img{min-height:300px!important;background-size:400px}.login.login-1 .login-content .login-form{width:100%;max-width:100%}}.has-danger .form-control-feedback{color:#fd397a;margin-top:.2rem;font-size:.85rem;text-align:left}ul.text-danger{list-style:none;color:#f4516c;margin-top:.2rem;font-size:.85rem;text-align:left;padding-left:0}.captcha-container{margin:auto;width:70%}"],encapsulation:2}),e})();var jt=n("Qj9z");let Ht=(()=>{class e{constructor(e,t,n){this._permissionChecker=e,this._router=t,this._sessionService=n}canActivate(e,t){return!(!e.queryParams.ss||"true"!==e.queryParams.ss)||!this._sessionService.user||(this._router.navigate([this.selectBestRoute()]),!1)}selectBestRoute(){return this._permissionChecker.isGranted("Pages.Administration.Host.Dashboard")?"/app/admin/hostDashboard":this._permissionChecker.isGranted("Pages.Tenant.Dashboard")?"/app/main/dashboard":"/app/notifications"}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275inject"](at.j),l["\u0275\u0275inject"](S.e),l["\u0275\u0275inject"](jt.a))},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})(),qt=(()=>{class e extends I.a{constructor(e,t,n,r){super(e),this._accountService=t,this._router=n,this._activatedRoute=r,this.model=new C.c}ngOnInit(){this.waitMessage=this.l("PleaseWaitToConfirmYourEmailMessage"),this.model.c=this._activatedRoute.snapshot.queryParams.c,this._accountService.resolveTenantId(new C.Jd({c:this.model.c})).subscribe(e=>{this.appSession.changeTenantIfNeeded(e)||this._accountService.activateEmail(this.model).subscribe(()=>{this.notify.success(this.l("YourEmailIsConfirmedMessage"),"",{onClose:()=>{this._router.navigate(["account/login"])}})})})}parseTenantId(e){let t=e?parseInt(e,10):void 0;return NaN===t&&(t=void 0),t}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](C.b),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](S.a))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:4,vars:1,consts:[[1,"login-form"],["role","alert",1,"alert","alert-success","text-center"],[1,"alert-text"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275text"](3),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](t.waitMessage))},encapsulation:2}),e})();var Ft=n("FCZ4"),Bt=n("kgQi");let Kt=(()=>{class e extends I.a{constructor(e,t,n){super(e),this._accountService=t,this._router=n,this.model=new C.Sd,this.saving=!1}save(){this.saving=!0,this._accountService.sendEmailActivationLink(this.model).pipe(Object(O.a)(()=>{this.saving=!1})).subscribe(()=>{this.message.success(this.l("ActivationMailSentMessage"),this.l("MailSent")).then(()=>{this._router.navigate(["account/login"])})})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](C.b),l["\u0275\u0275directiveInject"](S.e))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:24,vars:22,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post","novalidate","",1,"login-form","form",3,"ngSubmit"],["emailActivationForm","ngForm"],[1,"form-group"],["type","email","autocomplete","new-password","name","emailAddress","required","","maxlength","256","email","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["emailAddressInput","ngModel"],[3,"formCtrl"],[1,"pb-lg-0","pb-5"],["routerLink","/account/login","type","button",1,"btn","btn-light-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3",3,"disabled"],[1,"fa","fa-arrow-left"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-check"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3,4),l["\u0275\u0275listener"]("ngSubmit",function(){return t.save()}),l["\u0275\u0275elementStart"](7,"p"),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",5),l["\u0275\u0275elementStart"](11,"input",6,7),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.emailAddress=e}),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](14,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](15,"div",9),l["\u0275\u0275elementStart"](16,"button",10),l["\u0275\u0275element"](17,"i",11),l["\u0275\u0275text"](18),l["\u0275\u0275pipe"](19,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"button",12),l["\u0275\u0275element"](21,"i",13),l["\u0275\u0275text"](22),l["\u0275\u0275pipe"](23,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275reference"](6),n=l["\u0275\u0275reference"](12);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,12,"EmailActivation")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,14,"SendEmailActivationLink_Information")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](13,16,"EmailAddress")," *"),l["\u0275\u0275property"]("ngModel",t.model.emailAddress),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",n),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.saving),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](19,18,"Back"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!e.form.valid)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](23,20,"Submit"),"")}},directives:[a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,a.RequiredValidator,a.MaxLengthValidator,a.EmailValidator,a.NgControlStatus,a.NgModel,Bt.a,S.f,gt.a],pipes:[ft.a],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})();var zt=n("ooh5");function Wt(e,t){if(1&e&&l["\u0275\u0275element"](0,"validation-messages",23),2&e){l["\u0275\u0275nextContext"]();const e=l["\u0275\u0275reference"](9);l["\u0275\u0275property"]("formCtrl",e)}}function Gt(e,t){if(1&e&&l["\u0275\u0275element"](0,"validation-messages",23),2&e){l["\u0275\u0275nextContext"]();const e=l["\u0275\u0275reference"](14);l["\u0275\u0275property"]("formCtrl",e)}}function Vt(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",24),l["\u0275\u0275elementStart"](1,"div",25),l["\u0275\u0275element"](2,"span"),l["\u0275\u0275elementStart"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](6,"span"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](5,1,"LoginWith")))}function Qt(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"a",27),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](e);const n=t.$implicit;return l["\u0275\u0275nextContext"](2).externalLogin(n)}),l["\u0275\u0275element"](1,"i"),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;l["\u0275\u0275propertyInterpolate"]("title",e.name),l["\u0275\u0275advance"](1),l["\u0275\u0275classMapInterpolate1"]("fab fa-",e.icon,""),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function Xt(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",16),l["\u0275\u0275template"](1,Qt,3,5,"a",26),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",e.loginService.externalLoginProviders)}}function Jt(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275elementStart"](1,"a",28),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"span"),l["\u0275\u0275text"](5," | "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](3,1,"CreateAnAccount")))}function Yt(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275elementStart"](1,"a",29),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"span"),l["\u0275\u0275text"](5," | "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](3,1,"NewTenant")))}let $t=(()=>{class e extends I.a{constructor(e,t,n,r,i,o){super(e),this.loginService=t,this._router=n,this._sessionService=r,this._sessionAppService=i,this._reCaptchaV3Service=o,this.submitting=!1,this.isMultiTenancyEnabled=this.multiTenancy.isEnabled,this.recaptchaSiteKey=b.a.recaptchaSiteKey}get multiTenancySideIsTeanant(){return this._sessionService.tenantId>0}get isTenantSelfRegistrationAllowed(){return this.setting.getBoolean("App.TenantManagement.AllowSelfRegistration")}get isSelfRegistrationAllowed(){return!!this._sessionService.tenantId&&this.setting.getBoolean("App.UserManagement.AllowSelfRegistration")}ngOnInit(){this.loginService.init(),this._sessionService.userId>0&&w.a.getReturnUrl()&&w.a.getSingleSignIn()&&this._sessionAppService.updateUserSignInToken().subscribe(e=>{const t=w.a.getReturnUrl(),n=t+(t.indexOf("?")>=0?"&":"?")+"accessToken="+e.signInToken+"&userId="+e.encodedUserId+"&tenantId="+e.encodedTenantId;location.href=n}),this.handleExternalLoginCallbacks()}handleExternalLoginCallbacks(){let e=w.a.getQueryParametersUsingHash().state,t=w.a.getQueryParameters();if(e&&e.indexOf("openIdConnect")>=0&&this.loginService.openIdConnectLoginCallback({}),t.twitter&&"1"===t.twitter){let e=w.a.getQueryParameters();this.loginService.twitterLoginCallback(e.oauth_token,e.oauth_verifier)}}login(){let e=e=>{this.showMainSpinner(),this.submitting=!0,this.loginService.authenticate(()=>{this.submitting=!1,this.hideMainSpinner()},null,e)};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"login",t=>{e(t)}):e(null)}externalLogin(e){this.loginService.externalAuthenticate(e)}get useCaptcha(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnLogin")}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](lt),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](at.d),l["\u0275\u0275directiveInject"](C.Yd),l["\u0275\u0275directiveInject"](u))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:42,vars:35,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post","method","post",1,"login-form","form",3,"ngSubmit"],["loginForm","ngForm"],[1,"form-group"],["autoFocus","","type","text","autocomplete","new-password","name","userNameOrEmailAddress","required","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["userNameOrEmailAddressInput","ngModel"],[3,"formCtrl",4,"ngIf"],["type","password","autocomplete","new-password","name","password","required","","maxlength","32",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["passwordInput","ngModel"],[1,"form-group","d-flex","justify-content-between","mt-4"],[1,"checkbox","checkbox-outline"],["type","checkbox","name","rememberMe","value","true",3,"ngModel","ngModelChange"],[1,"ml-2"],["routerLink","/account/forgot-password","id","forget-password",1,"text-primary","font-size-h6","font-weight-bolder","text-hover-primary"],[1,"pb-lg-0","pb-5"],["type","submit",1,"btn","btn-block","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled"],["class","mt-10 mb-2",4,"ngIf"],["class","pb-lg-0 pb-5",4,"ngIf"],[1,"mt-5"],[4,"ngIf"],["routerLink","/account/email-activation","id","email-activation-btn"],[3,"formCtrl"],[1,"mt-10","mb-2"],[1,"divider"],["class","btn btn-sm btn-light-primary font-weight-bolder py-2",3,"title","click",4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-light-primary","font-weight-bolder","py-2",3,"title","click"],["routerLink","/account/register"],["routerLink","/account/select-edition"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3,4),l["\u0275\u0275listener"]("ngSubmit",function(){return t.login()}),l["\u0275\u0275elementStart"](7,"div",5),l["\u0275\u0275elementStart"](8,"input",6,7),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.loginService.authenticateModel.userNameOrEmailAddress=e}),l["\u0275\u0275pipe"](10,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](11,Wt,1,1,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](12,"div",5),l["\u0275\u0275elementStart"](13,"input",9,10),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.loginService.authenticateModel.password=e}),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](16,Gt,1,1,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"div",11),l["\u0275\u0275elementStart"](18,"label",12),l["\u0275\u0275elementStart"](19,"input",13),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.loginService.rememberMe=e}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](20,"span",14),l["\u0275\u0275text"](21),l["\u0275\u0275pipe"](22,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](23,"a",15),l["\u0275\u0275text"](24),l["\u0275\u0275pipe"](25,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](26,"div",16),l["\u0275\u0275elementStart"](27,"button",17),l["\u0275\u0275text"](28),l["\u0275\u0275pipe"](29,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](30,Vt,7,3,"div",18),l["\u0275\u0275template"](31,Xt,2,1,"div",19),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](32,"div",20),l["\u0275\u0275elementStart"](33,"div"),l["\u0275\u0275elementStart"](34,"span"),l["\u0275\u0275text"](35),l["\u0275\u0275pipe"](36,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](37,Jt,6,3,"span",21),l["\u0275\u0275template"](38,Yt,6,3,"span",21),l["\u0275\u0275elementStart"](39,"a",22),l["\u0275\u0275text"](40),l["\u0275\u0275pipe"](41,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275reference"](6),n=l["\u0275\u0275reference"](9),r=l["\u0275\u0275reference"](14);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,19,"LogIn")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](10,21,"UserNameOrEmail")," *"),l["\u0275\u0275property"]("ngModel",t.loginService.authenticateModel.userNameOrEmailAddress),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",!n.touched),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](15,23,"Password")," *"),l["\u0275\u0275property"]("ngModel",t.loginService.authenticateModel.password),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",!r.touched),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngModel",t.loginService.rememberMe),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](22,25,"RememberMe")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](25,27,"ForgotPassword")),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("disabled",!e.form.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](29,29,"LogIn")),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",(t.multiTenancySideIsTeanant||!t.isMultiTenancyEnabled)&&t.loginService.externalLoginProviders.length>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",(t.multiTenancySideIsTeanant||!t.isMultiTenancyEnabled)&&t.loginService.externalLoginProviders.length>0),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](36,31,"NotAMemberYet")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.isSelfRegistrationAllowed),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!t.multiTenancySideIsTeanant&&t.isTenantSelfRegistrationAllowed),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](41,33,"EmailActivation"))}},directives:[a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,zt.a,a.RequiredValidator,a.NgControlStatus,a.NgModel,r.t,a.MaxLengthValidator,a.CheckboxControlValueAccessor,S.h,Bt.a,r.s],pipes:[ft.a],styles:[".kt-login__options[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;padding-right:.35rem;margin:0 5px 0 0!important}.kt-login__options[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i.fa-openidconnect[_ngcontent-%COMP%]{background:url(/assets/common/images/social/openid.png) no-repeat;width:16px;height:16px}.kt-login__options[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i.fa-wsfederation[_ngcontent-%COMP%]{background:url(/assets/common/images/social/adfs.png) no-repeat;width:16px;height:16px}"],data:{animation:[Object(Ft.a)()]}}),e})();function Zt(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"option",11),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;l["\u0275\u0275property"]("value",e),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](e)}}function en(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"form",4,5),l["\u0275\u0275listener"]("ngSubmit",function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().submit()}),l["\u0275\u0275elementStart"](2,"p"),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"div",6),l["\u0275\u0275elementStart"](6,"select",7),l["\u0275\u0275listener"]("ngModelChange",function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().selectedTwoFactorProvider=t}),l["\u0275\u0275template"](7,Zt,2,2,"option",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](8,"div",9),l["\u0275\u0275elementStart"](9,"button",10),l["\u0275\u0275text"](10),l["\u0275\u0275pipe"](11,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](4,4,"SendSecurityCode_Information")),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngModel",e.selectedTwoFactorProvider),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",e.loginService.authenticateResult.twoFactorAuthProviders),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](11,6,"Submit"))}}let tn=(()=>{class e extends I.a{constructor(e,t,n,r){super(e),this.loginService=t,this._tokenAuthService=n,this._router=r,this.submitting=!1}canActivate(){return!!(this.loginService.authenticateModel&&this.loginService.authenticateResult&&this.loginService.authenticateResult.twoFactorAuthProviders&&this.loginService.authenticateResult.twoFactorAuthProviders.length)}ngOnInit(){this.canActivate()?this.selectedTwoFactorProvider=this.loginService.authenticateResult.twoFactorAuthProviders[0]:this._router.navigate(["account/login"])}submit(){const e=new C.Wd;e.userId=this.loginService.authenticateResult.userId,e.provider=this.selectedTwoFactorProvider,this.submitting=!0,this._tokenAuthService.sendTwoFactorAuthCode(e).pipe(Object(O.a)(()=>this.submitting=!1)).subscribe(()=>{this._router.navigate(["account/verify-code"])})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](lt),l["\u0275\u0275directiveInject"](C.Ve),l["\u0275\u0275directiveInject"](S.e))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:5,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["class","login-form form","method","post",3,"ngSubmit",4,"ngIf"],["method","post",1,"login-form","form",3,"ngSubmit"],["twoFactorForm","ngForm"],[1,"form-group"],["autoFocus","","size","1","name","selectedTwoFactorProvider",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"pb-lg-0","pb-5"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3"],[3,"value"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](5,en,12,8,"form",3),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,3,"SendSecurityCode")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.loginService.authenticateResult))},directives:[r.t,a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,a.SelectControlValueAccessor,zt.a,a.NgControlStatus,a.NgModel,r.s,a.NgSelectOption,a["\u0275angular_packages_forms_forms_x"]],pipes:[ft.a],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})();var nn=n("PqYM");function rn(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",12),l["\u0275\u0275elementStart"](1,"label",13),l["\u0275\u0275elementStart"](2,"input",14),l["\u0275\u0275listener"]("ngModelChange",function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().loginService.authenticateModel.rememberClient=t}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngModel",e.loginService.authenticateModel.rememberClient),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,2,"RememberThisBrowser")," ")}}function on(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span",15),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate2"]("",l["\u0275\u0275pipeBind1"](2,2,"RemainingTime"),": ",l["\u0275\u0275pipeBind2"](3,4,"SecondShort{0}",e.remainingSeconds),".")}}let an=(()=>{class e extends I.a{constructor(e,t,n,r){super(e),this.loginService=t,this._reCaptchaV3Service=n,this._router=r,this.recaptchaSiteKey=b.a.recaptchaSiteKey,this.submitting=!1,this.remainingSeconds=90}canActivate(){return!(!this.loginService.authenticateModel||!this.loginService.authenticateResult)}ngOnInit(){if(!this.canActivate())return void this._router.navigate(["account/login"]);const e=Object(nn.a)(1e3,1e3);this.timerSubscription=e.subscribe(()=>{this.remainingSeconds=this.remainingSeconds-1,0===this.remainingSeconds&&this.message.warn(this.l("TimeoutPleaseTryAgain")).then(()=>{this.loginService.authenticateModel.twoFactorVerificationCode=null,this._router.navigate(["account/login"])})})}ngOnDestroy(){this.timerSubscription&&(this.timerSubscription.unsubscribe(),this.timerSubscription=null)}get useCaptcha(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnLogin")}submit(){let e=e=>{this.loginService.authenticateModel.twoFactorVerificationCode=this.code,this.loginService.authenticate(()=>{},null,e)};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"login",t=>{e(t)}):e(null)}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](lt),l["\u0275\u0275directiveInject"](u),l["\u0275\u0275directiveInject"](S.e))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:18,vars:15,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],["method","post",1,"login-form","form",3,"ngSubmit"],["twoFactorForm","ngForm"],[1,"form-group"],["autoFocus","","type","password","autocomplete","new-password","name","code","required","","maxlength","16",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["passwordInput","ngModel"],[3,"formCtrl"],["class","form-group mt-4",4,"ngIf"],[1,"pb-lg-0","pb-5"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled"],["class","remaining-time-counter ml-5",4,"ngIf"],[1,"form-group","mt-4"],[1,"checkbox","checkbox-outline"],["type","checkbox","name","rememberClient","value","true",3,"ngModel","ngModelChange"],[1,"remaining-time-counter","ml-5"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3"),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",2,3),l["\u0275\u0275listener"]("ngSubmit",function(){return t.submit()}),l["\u0275\u0275elementStart"](7,"div",4),l["\u0275\u0275elementStart"](8,"input",5,6),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.code=e}),l["\u0275\u0275pipe"](10,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](11,"validation-messages",7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](12,rn,6,4,"div",8),l["\u0275\u0275elementStart"](13,"div",9),l["\u0275\u0275elementStart"](14,"button",10),l["\u0275\u0275text"](15),l["\u0275\u0275pipe"](16,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](17,on,4,7,"span",11),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275reference"](6),n=l["\u0275\u0275reference"](9);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,9,"VerifySecurityCode")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](10,11,"Code")," *"),l["\u0275\u0275property"]("ngModel",t.code),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",n),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf","true"===t.s("Abp.Zero.UserManagement.TwoFactorLogin.IsRememberBrowserEnabled")),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!e.form.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](16,13,"Submit")),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.remainingSeconds>=0)}},directives:[a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,zt.a,a.RequiredValidator,a.MaxLengthValidator,a.NgControlStatus,a.NgModel,Bt.a,r.t,a.CheckboxControlValueAccessor],pipes:[ft.a],styles:[".remaining-time-counter[_ngcontent-%COMP%]{color:red}"],data:{animation:[Object(Ft.a)()]}}),e})();var sn=n("WroF");let cn=(()=>{class e extends I.a{constructor(e,t,n,r){super(e),this._accountService=t,this._appUrlService=n,this._router=r,this.model=new C.Ud,this.saving=!1}save(){this.saving=!0,this._accountService.sendPasswordResetCode(this.model).pipe(Object(O.a)(()=>{this.saving=!1})).subscribe(()=>{this.message.success(this.l("PasswordResetMailSentMessage"),this.l("MailSent")).then(()=>{this._router.navigate(["account/login"])})})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](C.b),l["\u0275\u0275directiveInject"](sn.a),l["\u0275\u0275directiveInject"](S.e))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:24,vars:22,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post","novalidate","",1,"login-form","form",3,"ngSubmit"],["forgotPassForm","ngForm"],[1,"form-group"],["autoFocus","","type","text","autocomplete","new-password","name","emailAddress","required","","maxlength","256","email","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["emailAddressInput","ngModel"],[3,"formCtrl"],[1,"pb-lg-0","pb-5"],["routerLink","/account/login","type","button",1,"btn","btn-light-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3",3,"disabled"],[1,"fa","fa-arrow-left"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-check"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3,4),l["\u0275\u0275listener"]("ngSubmit",function(){return t.save()}),l["\u0275\u0275elementStart"](7,"p"),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",5),l["\u0275\u0275elementStart"](11,"input",6,7),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.emailAddress=e}),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](14,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](15,"div",9),l["\u0275\u0275elementStart"](16,"button",10),l["\u0275\u0275element"](17,"i",11),l["\u0275\u0275text"](18),l["\u0275\u0275pipe"](19,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"button",12),l["\u0275\u0275element"](21,"i",13),l["\u0275\u0275text"](22),l["\u0275\u0275pipe"](23,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275reference"](6),n=l["\u0275\u0275reference"](12);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,12,"ForgotPassword")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,14,"SendPasswordResetLink_Information")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](13,16,"EmailAddress")," *"),l["\u0275\u0275property"]("ngModel",t.model.emailAddress),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",n),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.saving),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](19,18,"Back"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!e.form.valid)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](23,20,"Submit"),"")}},directives:[a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,zt.a,a.RequiredValidator,a.MaxLengthValidator,a.EmailValidator,a.NgControlStatus,a.NgModel,Bt.a,S.f,gt.a],pipes:[ft.a],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})();class ln extends C.Id{}var dn=n("gGBz"),pn=n("KIW0");function un(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",17),l["\u0275\u0275elementStart"](1,"li",18),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",18),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",18),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",18),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",18),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](),t=l["\u0275\u0275reference"](12);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!t.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](3,10,"PasswordComplexity_RequireDigit_Hint")),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,12,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,14,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,16,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,18,"PasswordComplexity_RequiredLength_Hint",e.passwordComplexitySetting.requiredLength)," ")}}function hn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",17),l["\u0275\u0275elementStart"](1,"li",18),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",18),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",18),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",18),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",18),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"li",18),l["\u0275\u0275text"](17),l["\u0275\u0275pipe"](18,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](),t=l["\u0275\u0275reference"](18);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!t.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](3,12,"PasswordComplexity_RequireDigit_Hint")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,14,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,16,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,18,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,20,"PasswordComplexity_RequiredLength_Hint",e.passwordComplexitySetting.requiredLength)," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",t.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](18,23,"PasswordsDontMatch"))}}let mn=(()=>{class e extends I.a{constructor(e,t,n,r,i,o,a,s){super(e),this._accountService=t,this._router=n,this._activatedRoute=r,this._loginService=i,this._reCaptchaV3Service=o,this._appUrlService=a,this._profileService=s,this.recaptchaSiteKey=b.a.recaptchaSiteKey,this.model=new ln,this.passwordComplexitySetting=new C.id,this.saving=!1}ngOnInit(){this._profileService.getPasswordComplexitySetting().subscribe(e=>{this.passwordComplexitySetting=e.setting}),this._activatedRoute.snapshot.queryParams.c?(this.model.c=this._activatedRoute.snapshot.queryParams.c,this._accountService.resolveTenantId(new C.Jd({c:this.model.c})).subscribe(e=>{this.appSession.changeTenantIfNeeded(e)})):(this.model.userId=this._activatedRoute.snapshot.queryParams.userId,this.model.resetCode=this._activatedRoute.snapshot.queryParams.resetCode,this.appSession.changeTenantIfNeeded(this.parseTenantId(this._activatedRoute.snapshot.queryParams.tenantId)))}get useCaptcha(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnLogin")}save(){this.saving=!0,this._accountService.resetPassword(this.model).pipe(Object(O.a)(()=>{this.saving=!1})).subscribe(e=>{if(!e.canLogin)return void this._router.navigate(["account/login"]);let t=t=>{this.saving=!0,this._loginService.authenticateModel.userNameOrEmailAddress=e.userName,this._loginService.authenticateModel.password=this.model.password,this._loginService.authenticate(()=>{this.saving=!1},null,t)};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"login",e=>{t(e)}):t(null)})}parseTenantId(e){let t=e?parseInt(e):void 0;return NaN===t&&(t=void 0),t}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](C.b),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](S.a),l["\u0275\u0275directiveInject"](lt),l["\u0275\u0275directiveInject"](u),l["\u0275\u0275directiveInject"](sn.a),l["\u0275\u0275directiveInject"](C.Dd))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:31,vars:39,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post",1,"login-form","form",3,"ngSubmit"],["resetPassForm","ngForm"],[1,"form-group"],["type","password","name","Password","validateEqual","PasswordRepeat","reverse","true","required","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength","ngModelChange"],["Password","ngModel"],[1,"form-group",3,"hidden"],["class","form-text text-danger",4,"ngIf"],["type","password","name","PasswordRepeat","validateEqual","Password","reverse","false","required","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength"],["PasswordRepeat","ngModel"],[1,"pb-lg-0","pb-5"],["routerLink","/account/login","type","button",1,"btn","btn-light-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3",3,"disabled"],[1,"fa","fa-arrow-left"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-check"],[1,"form-text","text-danger"],[3,"hidden"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3,4),l["\u0275\u0275listener"]("ngSubmit",function(){return t.save()}),l["\u0275\u0275elementStart"](7,"p"),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",5),l["\u0275\u0275elementStart"](11,"input",6,7),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.password=e}),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](14,"div",8),l["\u0275\u0275template"](15,un,16,21,"ul",9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"div",5),l["\u0275\u0275element"](17,"input",10,11),l["\u0275\u0275pipe"](19,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"div",8),l["\u0275\u0275template"](21,hn,19,25,"ul",9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](22,"div",12),l["\u0275\u0275elementStart"](23,"button",13),l["\u0275\u0275element"](24,"i",14),l["\u0275\u0275text"](25),l["\u0275\u0275pipe"](26,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](27,"button",15),l["\u0275\u0275element"](28,"i",16),l["\u0275\u0275text"](29),l["\u0275\u0275pipe"](30,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275reference"](6),n=l["\u0275\u0275reference"](12),r=l["\u0275\u0275reference"](18);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,27,"ChangePassword")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,29,"PleaseEnterYourNewPassword")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](13,31,"Password")),l["\u0275\u0275property"]("ngModel",t.model.password)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",e.form.valid||e.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",n.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](19,33,"PasswordRepeat")),l["\u0275\u0275property"]("ngModel",t.model.passwordRepeat)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",e.form.valid||e.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.saving),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](26,35,"Back"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!e.form.valid)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](30,37,"Submit"),"")}},directives:[a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,dn.a,a.RequiredValidator,a.NgControlStatus,a.NgModel,pn.a,r.t,S.f,gt.a],pipes:[ft.a],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})(),gn=(()=>{class e{getPaymentGatewayType(e){return parseInt(e)===C.ue.Paypal?"Paypal":"Stripe"}getEditionPaymentType(e){return parseInt(e)===C.Db.BuyNow?"BuyNow":parseInt(e)===C.Db.Extend?"Extend":parseInt(e)===C.Db.NewRegistration?"NewRegistration":"Upgrade"}getInitialSelectedPaymentPeriodType(e){return e.dailyPrice>0?C.nd.Daily:e.weeklyPrice>0?C.nd.Weekly:e.monthlyPrice>0?C.nd.Monthly:e.annualPrice>0?C.nd.Annual:void 0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();function fn(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",11),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](e);const t=l["\u0275\u0275nextContext"]();return t.onPaymentPeriodChangeChange(t.paymentPeriodType.Daily)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",e.selectedPaymentPeriodType==e.paymentPeriodType.Daily)("value",e.paymentPeriodType.Daily),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"DailyPrice"),": ",e.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,e.edition.dailyPrice,"1.2-2")," ")}}function vn(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",14),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](e);const t=l["\u0275\u0275nextContext"]();return t.onPaymentPeriodChangeChange(t.paymentPeriodType.Weekly)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",e.selectedPaymentPeriodType==e.paymentPeriodType.Weekly)("value",e.paymentPeriodType.Weekly),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"WeeklyPrice"),": ",e.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,e.edition.weeklyPrice,"1.2-2")," ")}}function _n(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",11),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](e);const t=l["\u0275\u0275nextContext"]();return t.onPaymentPeriodChangeChange(t.paymentPeriodType.Monthly)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",e.selectedPaymentPeriodType==e.paymentPeriodType.Monthly)("value",e.paymentPeriodType.Monthly),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"MonthlyPrice"),": ",e.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,e.edition.monthlyPrice,"1.2-2")," ")}}function yn(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",14),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](e);const t=l["\u0275\u0275nextContext"]();return t.onPaymentPeriodChangeChange(t.paymentPeriodType.Annual)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",e.selectedPaymentPeriodType==e.paymentPeriodType.Annual)("value",e.paymentPeriodType.Annual),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"AnnualPrice"),": ",e.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,e.edition.annualPrice,"1.2-2")," ")}}function Sn(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",14),l["\u0275\u0275elementStart"](1,"label",15),l["\u0275\u0275elementStart"](2,"input",16),l["\u0275\u0275listener"]("ngModelChange",function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().recurringPaymentEnabled=t}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngModel",e.recurringPaymentEnabled),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,2,"AutomaticallyBillMyAccount")," ")}}function En(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button",19),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](e);const t=l["\u0275\u0275nextContext"]().$implicit;return l["\u0275\u0275nextContext"]().checkout(t.gatewayType)}),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]().$implicit,t=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"CheckoutWith"+t.getPaymentGatewayType(e.gatewayType))," ")}}function bn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",17),l["\u0275\u0275template"](1,En,3,3,"button",18),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.supportsRecurringPayments||!n.recurringPaymentEnabled)}}let In=(()=>{class e extends I.a{constructor(e,t,n,r,i,o){super(e),this._activatedRoute=t,this._router=n,this._paymnetHelperService=r,this._paymentAppService=i,this._tenantRegistrationService=o,this.edition=new C.Eb,this.tenantId=abp.session.tenantId,this.paymentPeriodType=C.nd,this.subscriptionPaymentGateway=C.ue,this.supportsRecurringPayments=!1,this.recurringPaymentEnabled=!1,this.editionId=0}ngOnInit(){let e=parseInt(this._activatedRoute.snapshot.queryParams.tenantId);abp.multiTenancy.setTenantIdCookie(e),this.editionPaymentType=this._activatedRoute.snapshot.queryParams.editionPaymentType,this.editionId=this._activatedRoute.snapshot.queryParams.editionId,this._tenantRegistrationService.getEdition(this.editionId).subscribe(e=>{this.edition=e,this.selectedPaymentPeriodType=this._paymnetHelperService.getInitialSelectedPaymentPeriodType(this.edition)}),this._paymentAppService.getActiveGateways(void 0).subscribe(e=>{this.paymentGateways=e,this.supportsRecurringPayments=e.some(e=>e.supportsRecurringPayments)})}checkout(e){let t={};t.editionId=this.editionId,t.editionPaymentType=this.editionPaymentType,t.paymentPeriodType=this.selectedPaymentPeriodType,t.recurringPaymentEnabled=this.recurringPaymentEnabled,t.subscriptionPaymentGatewayType=e,t.successUrl=b.a.remoteServiceBaseUrl+"/api/services/app/payment/"+this._paymnetHelperService.getEditionPaymentType(this.editionPaymentType)+"Succeed",t.errorUrl=b.a.remoteServiceBaseUrl+"/api/services/app/payment/PaymentFailed",this._paymentAppService.createPayment(t).subscribe(t=>{this._router.navigate(["account/"+this.getPaymentGatewayType(e).toLocaleLowerCase()+"-purchase"],{queryParams:{paymentId:t,redirectUrl:"account/register-tenant-result"}})})}getPaymentGatewayType(e){return this._paymnetHelperService.getPaymentGatewayType(e)}onPaymentPeriodChangeChange(e){this.selectedPaymentPeriodType=e}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](S.a),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](gn),l["\u0275\u0275directiveInject"](C.od),l["\u0275\u0275directiveInject"](C.De))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:19,vars:14,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post",1,"login-form","form"],[1,"mb-5"],[1,"radio-inline"],["class","form-group mr-5",4,"ngIf"],["class","form-group",4,"ngIf"],[1,"separator","separator-border-dashed"],[1,"pb-lg-0","pb-5"],["class","mb-2",4,"ngFor","ngForOf"],[1,"form-group","mr-5"],[1,"radio"],["type","radio","name","PaymentPeriodType",3,"checked","value","change"],[1,"form-group"],[1,"checkbox","mb-0"],["type","checkbox","name","RecurringPaymentEnabled",3,"ngModel","ngModelChange"],[1,"mb-2"],["class","btn btn-success btn-block",3,"click",4,"ngIf"],[1,"btn","btn-success","btn-block",3,"click"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3),l["\u0275\u0275elementStart"](6,"h4",4),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](9,"div",5),l["\u0275\u0275template"](10,fn,7,10,"div",6),l["\u0275\u0275template"](11,vn,7,10,"div",7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](12,"div",5),l["\u0275\u0275template"](13,_n,7,10,"div",6),l["\u0275\u0275template"](14,yn,7,10,"div",7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](15,"div",8),l["\u0275\u0275template"](16,Sn,6,4,"div",7),l["\u0275\u0275elementStart"](17,"div",9),l["\u0275\u0275template"](18,bn,2,1,"div",10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,10,"PaymentInfo")," "),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate2"]("",l["\u0275\u0275pipeBind1"](8,12,"Edition"),": ",t.edition.displayName,""),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",t.edition.dailyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.edition.weeklyPrice>0),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.edition.monthlyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.edition.annualPrice>0),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.supportsRecurringPayments),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngForOf",t.paymentGateways))},directives:[a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,r.t,r.s,a.CheckboxControlValueAccessor,a.NgControlStatus,a.NgModel],pipes:[ft.a,r.g],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})(),Tn=(()=>{class e{constructor(){}isEditionFree(e){return!(e.dailyPrice||e.weeklyPrice||e.monthlyPrice||e.annualPrice)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function wn(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div"),l["\u0275\u0275elementStart"](1,"div",10),l["\u0275\u0275elementStart"](2,"label",11),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,1,"RecurringSubscriptionUpgradeNote")," "))}function Cn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div"),l["\u0275\u0275elementStart"](1,"div",10),l["\u0275\u0275elementStart"](2,"label",12),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"div",13),l["\u0275\u0275elementStart"](6,"p",14),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,3,"Total")," "),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate2"](" ",e.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](8,5,e.additionalPrice,"1.2-2")," ")}}function An(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button",15),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](e);const n=t.$implicit;return l["\u0275\u0275nextContext"](2).checkout(n.gatewayType)}),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"CheckoutWith"+n.getPaymentGatewayType(e.gatewayType))," ")}}function kn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",1),l["\u0275\u0275elementStart"](1,"div",2),l["\u0275\u0275elementStart"](2,"h3",3),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",4),l["\u0275\u0275elementStart"](6,"h4",5),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](9,"div",6),l["\u0275\u0275template"](10,wn,5,3,"div",7),l["\u0275\u0275template"](11,Cn,9,8,"div",7),l["\u0275\u0275elementStart"](12,"div",8),l["\u0275\u0275template"](13,An,3,3,"button",9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,6,"PaymentInfo")," "),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](8,8,"Upgrade_Edition_Description",e.edition.displayName)," "),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",e.hasRecurringSubscription()),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!e.hasRecurringSubscription()),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngForOf",e.paymentGateways)}}let On=(()=>{class e extends I.a{constructor(e,t,n,r,i,o,a){super(e),this._router=t,this._paymentHelperService=n,this._activatedRoute=r,this._paymentAppService=i,this._tenantRegistrationAppService=o,this._editionHelperService=a,this.subscriptionPaymentType=C.ve,this.subscriptionStartType=C.xe,this.edition=new C.Eb,this.tenantId=abp.session.tenantId,this.subscriptionPaymentGateway=C.ue,this.editionPaymentTypeCheck=C.Db,this.showPaymentForm=!1}ngOnInit(){this.showMainSpinner(),this.editionPaymentType=parseInt(this._activatedRoute.snapshot.queryParams.editionPaymentType),this.upgradeEditionId=this._activatedRoute.snapshot.queryParams.upgradeEditionId,this.appSession.tenant.edition.isFree?this._tenantRegistrationAppService.getEdition(this.upgradeEditionId).subscribe(e=>{this._editionHelperService.isEditionFree(e)?this._paymentAppService.switchBetweenFreeEditions(e.id).subscribe(()=>{this.hideMainSpinner(),this._router.navigate(["app/admin/subscription-management"])}):(this.hideMainSpinner(),this.redirectToBuy())}):this._paymentAppService.hasAnyPayment().subscribe(e=>{if(!e)return this.hideMainSpinner(),void this.redirectToBuy();this._paymentAppService.getPaymentInfo(this.upgradeEditionId).subscribe(e=>{this.edition=e.edition,this.additionalPrice=Number(e.additionalPrice.toFixed(2)),this.additionalPrice<b.a.MinimumUpgradePaymentAmount?this._paymentAppService.upgradeSubscriptionCostsLessThenMinAmount(this.upgradeEditionId).subscribe(()=>{this.spinnerService.hide(),this.showPaymentForm=!0,this._router.navigate(["app/admin/subscription-management"])}):(this.spinnerService.hide(),this.showPaymentForm=!0)}),this._paymentAppService.getLastCompletedPayment().subscribe(e=>{let t=new C.ld;t.gatewayType=e.gateway,t.supportsRecurringPayments=!0,this.paymentGateways=[t],this.paymentPeriodType=e.paymentPeriodType,this.appSession.tenant.subscriptionPaymentType===this.subscriptionPaymentType.Manual&&this._paymentAppService.getActiveGateways(void 0).subscribe(e=>{this.paymentGateways=e})})})}checkout(e){let t=new C.ib;t.editionId=this.edition.id,t.editionPaymentType=this.editionPaymentType,t.paymentPeriodType=this.paymentPeriodType,t.recurringPaymentEnabled=this.hasRecurringSubscription(),t.subscriptionPaymentGatewayType=e,t.successUrl=b.a.remoteServiceBaseUrl+"/api/services/app/payment/"+this._paymentHelperService.getEditionPaymentType(this.editionPaymentType)+"Succeed",t.errorUrl=b.a.remoteServiceBaseUrl+"/api/services/app/payment/PaymentFailed",this._paymentAppService.createPayment(t).subscribe(t=>{this._router.navigate(["account/"+this.getPaymentGatewayType(e).toLocaleLowerCase()+"-purchase"],{queryParams:{paymentId:t,isUpgrade:!0,redirectUrl:"app/admin/subscription-management"}})})}getPaymentGatewayType(e){return this._paymentHelperService.getPaymentGatewayType(e)}hasRecurringSubscription(){return this.appSession.tenant.subscriptionPaymentType!==this.subscriptionPaymentType.Manual}redirectToBuy(){this._router.navigate(["account/buy"],{queryParams:{tenantId:this.appSession.tenant.id,editionPaymentType:C.Db.BuyNow,editionId:this.upgradeEditionId,subscriptionStartType:this.subscriptionStartType.Paid}})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](gn),l["\u0275\u0275directiveInject"](S.a),l["\u0275\u0275directiveInject"](C.od),l["\u0275\u0275directiveInject"](C.De),l["\u0275\u0275directiveInject"](Tn))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[["class","login-form",4,"ngIf"],[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post",1,"login-form","form"],[1,"mb-2"],[1,"separator","separator-border-dashed"],[4,"ngIf"],[1,"pb-lg-0","pb-5"],["class","btn btn-success btn-block",3,"click",4,"ngFor","ngForOf"],[1,"form-group","row"],[1,"col-sm-12"],[1,"col-sm-8"],[1,"col-sm-4","text-right"],["id","totalPrice",1,"font-weight-bolder"],[1,"btn","btn-success","btn-block",3,"click"]],template:function(e,t){1&e&&l["\u0275\u0275template"](0,kn,14,11,"div",0),2&e&&l["\u0275\u0275property"]("ngIf",t.showPaymentForm)},directives:[r.t,a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,r.s],pipes:[ft.a,r.g],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})();function xn(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",11),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](e);const t=l["\u0275\u0275nextContext"]();return t.onPaymentPeriodChangeChange(t.paymentPeriodType.Daily)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",e.selectedPaymentPeriodType===e.paymentPeriodType.Daily)("value",e.paymentPeriodType.Daily),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"DailyPrice"),": ",e.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,e.edition.dailyPrice,"1.2-2")," ")}}function Rn(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",14),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](e);const t=l["\u0275\u0275nextContext"]();return t.onPaymentPeriodChangeChange(t.paymentPeriodType.Weekly)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",e.selectedPaymentPeriodType===e.paymentPeriodType.Weekly)("value",e.paymentPeriodType.Weekly),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"WeeklyPrice"),": ",e.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,e.edition.weeklyPrice,"1.2-2")," ")}}function Pn(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",11),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](e);const t=l["\u0275\u0275nextContext"]();return t.onPaymentPeriodChangeChange(t.paymentPeriodType.Monthly)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",e.selectedPaymentPeriodType===e.paymentPeriodType.Monthly)("value",e.paymentPeriodType.Monthly),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"MonthlyPrice"),": ",e.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,e.edition.monthlyPrice,"1.2-2")," ")}}function Nn(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",14),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](e);const t=l["\u0275\u0275nextContext"]();return t.onPaymentPeriodChangeChange(t.paymentPeriodType.Annual)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",e.selectedPaymentPeriodType===e.paymentPeriodType.Annual)("value",e.paymentPeriodType.Annual),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"AnnualPrice"),": ",e.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,e.edition.annualPrice,"1.2-2")," ")}}function Ln(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button",15),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](e);const n=t.$implicit;return l["\u0275\u0275nextContext"]().checkout(n.gatewayType)}),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"CheckoutWith"+n.getPaymentGatewayType(e.gatewayType))," ")}}let Un=(()=>{class e extends I.a{constructor(e,t,n,r,i){super(e),this._router=t,this._paymnetHelperService=n,this._activatedRoute=r,this._paymentAppService=i,this.edition=new C.Eb,this.tenantId=abp.session.tenantId,this.paymentPeriodType=C.nd,this.subscriptionPaymentGateway=C.ue,this.editionPaymentTypeCheck=C.Db}ngOnInit(){this.editionPaymentType=parseInt(this._activatedRoute.snapshot.queryParams.editionPaymentType),this._paymentAppService.getPaymentInfo(void 0).subscribe(e=>{this.edition=e.edition,this.additionalPrice=Number(e.additionalPrice.toFixed(2)),this.selectedPaymentPeriodType=this._paymnetHelperService.getInitialSelectedPaymentPeriodType(this.edition)}),this._paymentAppService.getActiveGateways(void 0).subscribe(e=>{this.paymentGateways=e})}checkout(e){let t={};t.editionId=this.edition.id,t.editionPaymentType=this.editionPaymentType,t.paymentPeriodType=this.selectedPaymentPeriodType,t.recurringPaymentEnabled=!1,t.subscriptionPaymentGatewayType=e,t.successUrl=b.a.remoteServiceBaseUrl+"/api/services/app/payment/"+this._paymnetHelperService.getEditionPaymentType(this.editionPaymentType)+"Succeed",t.errorUrl=b.a.remoteServiceBaseUrl+"/api/services/app/payment/PaymentFailed",this._paymentAppService.createPayment(t).subscribe(t=>{this._router.navigate(["account/"+this.getPaymentGatewayType(e).toLocaleLowerCase()+"-purchase"],{queryParams:{paymentId:t,redirectUrl:"app/admin/subscription-management"}})})}getPaymentGatewayType(e){return this._paymnetHelperService.getPaymentGatewayType(e)}onPaymentPeriodChangeChange(e){this.selectedPaymentPeriodType=e}isUpgrade(){return this.additionalPrice>0}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](gn),l["\u0275\u0275directiveInject"](S.a),l["\u0275\u0275directiveInject"](C.od))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:18,vars:13,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],[1,"separator","separator-border-dashed"],["method","post",1,"login-form","form","mt-2"],[1,"mb-5"],[1,"radio-inline"],["class","form-group mr-2",4,"ngIf"],["class","form-group",4,"ngIf"],[1,"pb-lg-0","pb-5"],["class","btn btn-success btn-block",3,"click",4,"ngFor","ngForOf"],[1,"form-group","mr-2"],[1,"radio"],["type","radio","name","PaymentPeriodType",1,"form-control",3,"checked","value","change"],[1,"form-group"],[1,"btn","btn-success","btn-block",3,"click"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](5,"div",3),l["\u0275\u0275elementStart"](6,"form",4),l["\u0275\u0275elementStart"](7,"h4",5),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",6),l["\u0275\u0275template"](11,xn,7,10,"div",7),l["\u0275\u0275template"](12,Rn,7,10,"div",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"div",6),l["\u0275\u0275template"](14,Pn,7,10,"div",7),l["\u0275\u0275template"](15,Nn,7,10,"div",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"div",9),l["\u0275\u0275template"](17,Ln,3,3,"button",10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,8,"PaymentInfo")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](9,10,"Extend_Edition_Description",t.edition.displayName)," "),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",t.edition.dailyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.edition.weeklyPrice>0),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.edition.monthlyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.edition.annualPrice>0),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngForOf",t.paymentGateways))},directives:[a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,r.t,r.s],pipes:[ft.a,r.g],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})(),Mn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=l["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e})();function Dn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",5),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](2,1,"ConfirmationMailSentPleaseClickLinkInTheEmail",e.model.emailAddress)," ")}}function jn(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",6),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"YourAccountIsWaitingToBeActivatedByAdmin")," "))}function Hn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",7),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275element"](3,"br"),l["\u0275\u0275elementStart"](4,"a",8),l["\u0275\u0275text"](5),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,3,"TenantRegistrationLoginInfo"),""),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate"]("href",e.tenantUrl,l["\u0275\u0275sanitizeUrl"]),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](e.tenantUrl)}}let qn=(()=>{class e extends I.a{constructor(e,t,n,r){super(e),this._router=t,this._appUrlService=n,this._tenantRegistrationHelper=r,this.model=new C.Gd,this.saving=!1}ngOnInit(){this._tenantRegistrationHelper.registrationResult?(this.model=this._tenantRegistrationHelper.registrationResult,abp.multiTenancy.setTenantIdCookie(this.model.tenantId),this.tenantUrl=this._appUrlService.getAppRootUrlOfTenant(this.model.tenancyName)):this._router.navigate(["account/login"])}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](sn.a),l["\u0275\u0275directiveInject"](Mn))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:29,vars:23,consts:[[1,"login-form"],[1,"text-muted"],["class","alert alert-warning","role","alert",4,"ngIf"],["class","alert alert-primary","role","alert",4,"ngIf"],["class","alert alert-secondary","role","alert",4,"ngIf"],["role","alert",1,"alert","alert-warning"],["role","alert",1,"alert","alert-primary"],["role","alert",1,"alert","alert-secondary"],[3,"href"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"h4"),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"ul"),l["\u0275\u0275elementStart"](5,"li"),l["\u0275\u0275elementStart"](6,"span",1),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li"),l["\u0275\u0275elementStart"](11,"span",1),l["\u0275\u0275text"](12),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](15,"li"),l["\u0275\u0275elementStart"](16,"span",1),l["\u0275\u0275text"](17),l["\u0275\u0275pipe"](18,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](19),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"li"),l["\u0275\u0275elementStart"](21,"span",1),l["\u0275\u0275text"](22),l["\u0275\u0275pipe"](23,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](24),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](25,"div"),l["\u0275\u0275template"](26,Dn,3,4,"div",2),l["\u0275\u0275template"](27,jn,3,3,"div",3),l["\u0275\u0275template"](28,Hn,6,5,"div",4),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](3,13,"SuccessfullyRegistered")),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](8,15,"TenancyName"),":"),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",t.model.tenancyName,""),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](13,17,"TenantName"),":"),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",t.model.name,""),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](18,19,"UserName"),":"),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",t.model.userName,""),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](23,21,"EmailAddress"),":"),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",t.model.emailAddress,""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.model.isEmailConfirmationRequired),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!t.model.isActive),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.tenantUrl))},directives:[r.t],pipes:[ft.a],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})();class Fn extends C.Fd{}var Bn=n("YyRF");let Kn=(()=>{class e{constructor(e,t){this.el=e,this.zone=t,this.promptLabel="Enter a password",this.weakLabel="Weak",this.mediumLabel="Medium",this.strongLabel="Strong",this.feedback=!0}set showPassword(e){this.el.nativeElement.type=e?"text":"password"}ngDoCheck(){this.updateFilledState()}onInput(e){this.updateFilledState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}createPanel(){this.panel=document.createElement("div"),this.panel.className="p-password-panel p-component p-password-panel-overlay p-connected-overlay",this.meter=document.createElement("div"),this.meter.className="p-password-meter",this.info=document.createElement("div"),this.info.className="p-password-info",this.info.textContent=this.promptLabel,this.panel.appendChild(this.meter),this.panel.appendChild(this.info),this.panel.style.minWidth=Bn.b.getOuterWidth(this.el.nativeElement)+"px",document.body.appendChild(this.panel)}showOverlay(){this.feedback&&(this.panel||this.createPanel(),this.panel.style.zIndex=String(++Bn.b.zindex),this.panel.style.display="block",this.zone.runOutsideAngular(()=>{setTimeout(()=>{Bn.b.addClass(this.panel,"p-connected-overlay-visible"),this.bindScrollListener(),this.bindDocumentResizeListener()},1)}),Bn.b.absolutePosition(this.panel,this.el.nativeElement))}hideOverlay(){this.feedback&&this.panel&&(Bn.b.addClass(this.panel,"p-connected-overlay-hidden"),Bn.b.removeClass(this.panel,"p-connected-overlay-visible"),this.unbindScrollListener(),this.unbindDocumentResizeListener(),this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.ngOnDestroy()},150)}))}onFocus(){this.showOverlay()}onBlur(){this.hideOverlay()}onKeyup(e){if(this.feedback){let n=e.target.value,r=null,i=null;if(0===n.length)r=this.promptLabel,i="0px 0px";else{var t=this.testStrength(n);t<30?(r=this.weakLabel,i="0px -10px"):t>=30&&t<80?(r=this.mediumLabel,i="0px -20px"):t>=80&&(r=this.strongLabel,i="0px -30px")}this.panel&&Bn.b.hasClass(this.panel,"p-connected-overlay-visible")||this.showOverlay(),this.meter.style.backgroundPosition=i,this.info.textContent=r}}testStrength(e){let t,n=0;return t=e.match("[0-9]"),n+=25*this.normalize(t?t.length:1/4,1),t=e.match("[a-zA-Z]"),n+=10*this.normalize(t?t.length:.5,3),t=e.match("[!@#$%^&*?_~.,;=]"),n+=35*this.normalize(t?t.length:1/6,1),t=e.match("[A-Z]"),n+=30*this.normalize(t?t.length:1/6,1),n*=e.length/8,n>100?100:n}normalize(e,t){return e-t<=0?e/t:1+e/(e+t/4)*.5}get disabled(){return this.el.nativeElement.disabled}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new Bn.a(this.el.nativeElement,()=>{Bn.b.hasClass(this.panel,"p-connected-overlay-visible")&&this.hideOverlay()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}onWindowResize(){this.hideOverlay()}ngOnDestroy(){this.panel&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.unbindDocumentResizeListener(),document.body.removeChild(this.panel),this.panel=null,this.meter=null,this.info=null)}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.ElementRef),l["\u0275\u0275directiveInject"](l.NgZone))},e.\u0275dir=l["\u0275\u0275defineDirective"]({type:e,selectors:[["","pPassword",""]],hostVars:6,hostBindings:function(e,t){1&e&&l["\u0275\u0275listener"]("input",function(e){return t.onInput(e)})("focus",function(){return t.onFocus()})("blur",function(){return t.onBlur()})("keyup",function(e){return t.onKeyup(e)}),2&e&&l["\u0275\u0275classProp"]("p-inputtext",!0)("p-component",!0)("p-filled",t.filled)},inputs:{promptLabel:"promptLabel",weakLabel:"weakLabel",mediumLabel:"mediumLabel",strongLabel:"strongLabel",feedback:"feedback",showPassword:"showPassword"}}),e})(),zn=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.c]]}),e})();function Wn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"h4",29),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate2"]("",l["\u0275\u0275pipeBind1"](2,2,"Edition"),": ",e.model.edition.displayName,"")}}function Gn(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div"),l["\u0275\u0275elementStart"](1,"span",30),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](3,1,"TenantName_Regex_Description")))}function Vn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",17),l["\u0275\u0275elementStart"](1,"li",31),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",31),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",31),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",31),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",31),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](),t=l["\u0275\u0275reference"](33);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!t.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](3,10,"PasswordComplexity_RequireDigit_Hint")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,12,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,14,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,16,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,18,"PasswordComplexity_RequiredLength_Hint",e.passwordComplexitySetting.requiredLength)," ")}}function Qn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",17),l["\u0275\u0275elementStart"](1,"li",31),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",31),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",31),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",31),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",31),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"li",31),l["\u0275\u0275text"](17),l["\u0275\u0275pipe"](18,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](),t=l["\u0275\u0275reference"](39);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!t.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](3,12,"PasswordComplexity_RequireDigit_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,14,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,16,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,18,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,20,"PasswordComplexity_RequiredLength_Hint",e.passwordComplexitySetting.requiredLength)," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",t.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](18,23,"PasswordsDontMatch"))}}let Xn=(()=>{class e extends I.a{constructor(e,t,n,r,i,o,a){super(e),this._tenantRegistrationService=t,this._router=n,this._profileService=r,this._tenantRegistrationHelper=i,this._activatedRoute=o,this._reCaptchaV3Service=a,this.model=new Fn,this.passwordComplexitySetting=new C.id,this.subscriptionStartType=C.xe,this.paymentPeriodType=C.nd,this.selectedPaymentPeriodType=C.nd.Monthly,this.subscriptionPaymentGateway=C.ue,this.paymentId="",this.recaptchaSiteKey=b.a.recaptchaSiteKey,this.saving=!1}ngOnInit(){this.model.editionId=this._activatedRoute.snapshot.queryParams.editionId,this.editionPaymentType=this._activatedRoute.snapshot.queryParams.editionPaymentType,this.model.editionId&&(this.model.subscriptionStartType=this._activatedRoute.snapshot.queryParams.subscriptionStartType),null==this.appSession.tenant?this._profileService.getPasswordComplexitySetting().subscribe(e=>{this.passwordComplexitySetting=e.setting}):this._router.navigate(["account/login"])}ngAfterViewInit(){this.model.editionId&&this._tenantRegistrationService.getEdition(this.model.editionId).subscribe(e=>{this.model.edition=e})}get useCaptcha(){return this.setting.getBoolean("App.TenantManagement.UseCaptchaOnRegistration")}save(){let e=e=>{this.saving=!0,this.model.captchaResponse=e,this._tenantRegistrationService.registerTenant(this.model).pipe(Object(O.a)(()=>{this.saving=!1})).subscribe(e=>{this.notify.success(this.l("SuccessfullyRegistered")),this._tenantRegistrationHelper.registrationResult=e,parseInt(this.model.subscriptionStartType.toString())===C.xe.Paid?this._router.navigate(["account/buy"],{queryParams:{tenantId:e.tenantId,editionId:this.model.editionId,subscriptionStartType:this.model.subscriptionStartType,editionPaymentType:this.editionPaymentType}}):this._router.navigate(["account/register-tenant-result"])})};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"register_tenant",t=>{e(t)}):e(null)}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](C.De),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](C.Dd),l["\u0275\u0275directiveInject"](Mn),l["\u0275\u0275directiveInject"](S.a),l["\u0275\u0275directiveInject"](u))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:52,vars:62,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["class","text-center",4,"ngIf"],[1,"separator","separator-border-dashed"],["role","form","novalidate","",1,"login-form","form","mt-2",3,"submit"],["registerForm","ngForm"],[1,"mt-2"],[1,"form-group"],["autoFocus","","type","text","name","tenancyName","required","","maxlength","64","pattern","^[a-zA-Z][a-zA-Z0-9_-]{1,}$",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["tenancyName","ngModel"],[4,"ngIf"],["type","text","name","Name","required","","maxlength","128",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["nameInput","ngModel"],[3,"formCtrl"],["type","email","name","adminEmailAddress","required","","maxlength","256","email","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["adminEmailAddressInput","ngModel"],[1,"form-text","text-danger"],["type","password","name","Password","validateEqual","PasswordRepeat","reverse","true","required","","pPassword","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength","promptLabel","weakLabel","mediumLabel","strongLabel","ngModelChange"],["Password","ngModel"],[1,"form-group",3,"hidden"],["class","form-text text-danger",4,"ngIf"],["type","password","name","PasswordRepeat","validateEqual","Password","reverse","false","required","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength"],["PasswordRepeat","ngModel"],[1,"pb-lg-0","pb-5"],["routerLink","/account/login","type","button",1,"btn","btn-light-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3",3,"disabled"],[1,"fa","fa-arrow-left"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-check"],[1,"text-center"],[1,"form-text","text-danger","text-left"],[3,"hidden"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](5,Wn,3,4,"h4",3),l["\u0275\u0275element"](6,"div",4),l["\u0275\u0275elementStart"](7,"form",5,6),l["\u0275\u0275listener"]("submit",function(){return t.save()}),l["\u0275\u0275elementStart"](9,"h5",7),l["\u0275\u0275text"](10),l["\u0275\u0275pipe"](11,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](12,"div",8),l["\u0275\u0275elementStart"](13,"input",9,10),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.tenancyName=e}),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](16,Gn,4,3,"div",11),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"div",8),l["\u0275\u0275elementStart"](18,"input",12,13),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.name=e}),l["\u0275\u0275pipe"](20,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](21,"validation-messages",14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](22,"h5",7),l["\u0275\u0275text"](23),l["\u0275\u0275pipe"](24,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](25,"div",8),l["\u0275\u0275elementStart"](26,"input",15,16),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.adminEmailAddress=e}),l["\u0275\u0275pipe"](28,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](29,"span",17),l["\u0275\u0275element"](30,"validation-messages",14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](31,"div",8),l["\u0275\u0275elementStart"](32,"input",18,19),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.adminPassword=e}),l["\u0275\u0275pipe"](34,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](35,"div",20),l["\u0275\u0275template"](36,Vn,16,21,"ul",21),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](37,"div",8),l["\u0275\u0275element"](38,"input",22,23),l["\u0275\u0275pipe"](40,"localize"),l["\u0275\u0275elementStart"](41,"div",20),l["\u0275\u0275template"](42,Qn,19,25,"ul",21),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](43,"div",24),l["\u0275\u0275elementStart"](44,"button",25),l["\u0275\u0275element"](45,"i",26),l["\u0275\u0275text"](46),l["\u0275\u0275pipe"](47,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](48,"button",27),l["\u0275\u0275element"](49,"i",28),l["\u0275\u0275text"](50),l["\u0275\u0275pipe"](51,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275reference"](8),n=l["\u0275\u0275reference"](14),r=l["\u0275\u0275reference"](19),i=l["\u0275\u0275reference"](27),o=l["\u0275\u0275reference"](33),a=l["\u0275\u0275reference"](39);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,42,"TenantSignUp")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.model.edition),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](11,44,"TenantInformations")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](15,46,"TenancyName")," *"),l["\u0275\u0275property"]("ngModel",t.model.tenancyName),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",!n.valid&&!n.pristine),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](20,48,"TenantName")," *"),l["\u0275\u0275property"]("ngModel",t.model.name),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",r),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](24,50,"AccountSettings")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](28,52,"AdminEmailAddress")," *"),l["\u0275\u0275property"]("ngModel",t.model.adminEmailAddress),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("formCtrl",i),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](34,54,"AdminPassword")),l["\u0275\u0275property"]("ngModel",t.model.adminPassword)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength)("promptLabel",t.l("PleaseEnterYourNewPassword"))("weakLabel",t.l("weak"))("mediumLabel",t.l("medium"))("strongLabel",t.l("strong")),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",e.form.valid||e.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",o.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](40,56,"PasswordRepeat")),l["\u0275\u0275property"]("ngModel",t.model.passwordRepeat)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",e.form.valid||e.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",a.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.saving),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](47,58,"Back"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!e.form.valid)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](51,60,"Submit"),"")}},directives:[r.t,a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,zt.a,a.RequiredValidator,a.MaxLengthValidator,a.PatternValidator,a.NgControlStatus,a.NgModel,Bt.a,a.EmailValidator,dn.a,Kn,pn.a,S.f,gt.a],pipes:[ft.a],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})();class Jn extends C.Ed{}function Yn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",26),l["\u0275\u0275elementStart"](1,"li",27),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",27),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",27),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",27),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",27),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](),t=l["\u0275\u0275reference"](29);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!t.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](3,10,"PasswordComplexity_RequireDigit_Hint")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,12,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,14,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,16,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,18,"PasswordComplexity_RequiredLength_Hint",e.passwordComplexitySetting.requiredLength)," ")}}function $n(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",26),l["\u0275\u0275elementStart"](1,"li",27),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",27),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",27),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",27),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",27),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"li",27),l["\u0275\u0275text"](17),l["\u0275\u0275pipe"](18,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](),t=l["\u0275\u0275reference"](35);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!t.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](3,12,"PasswordComplexity_RequireDigit_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,14,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,16,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,18,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!t.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,20,"PasswordComplexity_RequiredLength_Hint",e.passwordComplexitySetting.requiredLength)," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",t.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](18,23,"PasswordsDontMatch"))}}let Zn=(()=>{class e extends I.a{constructor(e,t,n,r,i,o){super(e),this._accountService=t,this._router=n,this._loginService=r,this._profileService=i,this._reCaptchaV3Service=o,this.model=new Jn,this.passwordComplexitySetting=new C.id,this.recaptchaSiteKey=b.a.recaptchaSiteKey,this.saving=!1}ngOnInit(){null!=this.appSession.tenant?this._profileService.getPasswordComplexitySetting().subscribe(e=>{this.passwordComplexitySetting=e.setting}):this._router.navigate(["account/login"])}get useCaptcha(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnRegistration")}save(){let e=e=>{this.saving=!0,this.model.captchaResponse=e,this._accountService.register(this.model).pipe(Object(O.a)(()=>{this.saving=!1})).subscribe(e=>{if(!e.canLogin)return this.notify.success(this.l("SuccessfullyRegistered")),void this._router.navigate(["account/login"]);this.saving=!0,this._loginService.authenticateModel.userNameOrEmailAddress=this.model.userName,this._loginService.authenticateModel.password=this.model.password,this._loginService.authenticate(()=>{this.saving=!1})})};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"register",t=>{e(t)}):e(null)}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](C.b),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](lt),l["\u0275\u0275directiveInject"](C.Dd),l["\u0275\u0275directiveInject"](u))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:48,vars:60,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post","novalidate","",1,"login-form","form",3,"ngSubmit"],["registerForm","ngForm"],[1,"form-group"],["autoFocus","","type","text","name","Name","required","","maxlength","64",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["nameInput","ngModel"],[3,"formCtrl"],["type","text","name","Surname","required","","maxlength","64",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["surnameInput","ngModel"],["type","email","name","EmailAddress","required","","maxlength","256","pattern","^\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["emailAddressInput","ngModel"],["type","text","autocomplete","new-password","name","UserName","required","","maxlength","256",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["userNameInput","ngModel"],["type","password","name","Password","validateEqual","PasswordRepeat","reverse","true","required","","pPassword","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength","promptLabel","weakLabel","mediumLabel","strongLabel","ngModelChange"],["Password","ngModel"],[1,"form-group",3,"hidden"],["class","form-text text-danger",4,"ngIf"],["type","password","name","PasswordRepeat","validateEqual","Password","reverse","false","required","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength"],["PasswordRepeat","ngModel"],[1,"pb-lg-0","pb-5"],["routerLink","/account/login","type","button",1,"btn","btn-light-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3",3,"disabled"],[1,"fa","fa-arrow-left"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-check"],[1,"form-text","text-danger"],[3,"hidden"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3,4),l["\u0275\u0275listener"]("ngSubmit",function(){return t.save()}),l["\u0275\u0275elementStart"](7,"div",5),l["\u0275\u0275elementStart"](8,"input",6,7),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.name=e}),l["\u0275\u0275pipe"](10,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](11,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](12,"div",5),l["\u0275\u0275elementStart"](13,"input",9,10),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.surname=e}),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](16,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"div",5),l["\u0275\u0275elementStart"](18,"input",11,12),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.emailAddress=e}),l["\u0275\u0275pipe"](20,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](21,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](22,"div",5),l["\u0275\u0275elementStart"](23,"input",13,14),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.userName=e}),l["\u0275\u0275pipe"](25,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](26,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](27,"div",5),l["\u0275\u0275elementStart"](28,"input",15,16),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.password=e}),l["\u0275\u0275pipe"](30,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](31,"div",17),l["\u0275\u0275template"](32,Yn,16,21,"ul",18),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](33,"div",5),l["\u0275\u0275element"](34,"input",19,20),l["\u0275\u0275pipe"](36,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](37,"div",17),l["\u0275\u0275template"](38,$n,19,25,"ul",18),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](39,"div",21),l["\u0275\u0275elementStart"](40,"button",22),l["\u0275\u0275element"](41,"i",23),l["\u0275\u0275text"](42),l["\u0275\u0275pipe"](43,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](44,"button",24),l["\u0275\u0275element"](45,"i",25),l["\u0275\u0275text"](46),l["\u0275\u0275pipe"](47,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275reference"](6),n=l["\u0275\u0275reference"](9),r=l["\u0275\u0275reference"](14),i=l["\u0275\u0275reference"](19),o=l["\u0275\u0275reference"](24),a=l["\u0275\u0275reference"](29),s=l["\u0275\u0275reference"](35);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,42,"SignUp")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](10,44,"Name")," *"),l["\u0275\u0275property"]("ngModel",t.model.name),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",n),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](15,46,"Surname")," *"),l["\u0275\u0275property"]("ngModel",t.model.surname),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",r),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](20,48,"EmailAddress")," *"),l["\u0275\u0275property"]("ngModel",t.model.emailAddress),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",i),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](25,50,"UserName")," *"),l["\u0275\u0275property"]("ngModel",t.model.userName),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",o),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](30,52,"Password")),l["\u0275\u0275property"]("ngModel",t.model.password)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength)("promptLabel",t.l("PleaseEnterYourNewPassword"))("weakLabel",t.l("weak"))("mediumLabel",t.l("medium"))("strongLabel",t.l("strong")),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",e.form.valid||e.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",a.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](36,54,"PasswordRepeat")),l["\u0275\u0275property"]("ngModel",t.model.passwordRepeat)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",e.form.valid||e.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",s.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.saving),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](43,56,"Back"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!e.form.valid)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](47,58,"Submit"),"")}},directives:[a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,zt.a,a.RequiredValidator,a.MaxLengthValidator,a.NgControlStatus,a.NgModel,Bt.a,a.PatternValidator,dn.a,Kn,pn.a,r.t,S.f,gt.a],pipes:[ft.a],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})();function er(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",6),l["\u0275\u0275elementStart"](1,"div",7),l["\u0275\u0275element"](2,"i",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"div",9),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](5,1,"ThereIsNoEditionToUpgrade")))}function tr(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"h4",24),l["\u0275\u0275elementStart"](1,"span"),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](3,1,"Free"),""))}function nr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275element"](3,"br"),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2).$implicit,t=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate3"]("",t.appSession.application.currencySign," ",e.edition.dailyPrice," ",l["\u0275\u0275pipeBind1"](2,3,"PerDay"),"")}}function rr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275element"](3,"br"),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2).$implicit,t=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate3"]("",t.appSession.application.currencySign," ",e.edition.weeklyPrice," ",l["\u0275\u0275pipeBind1"](2,3,"PerWeek"),"")}}function ir(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275element"](3,"br"),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2).$implicit,t=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate3"]("",t.appSession.application.currencySign," ",e.edition.monthlyPrice," ",l["\u0275\u0275pipeBind1"](2,3,"PerMonth")," ")}}function or(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2).$implicit,t=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate3"]("",t.appSession.application.currencySign," ",e.edition.annualPrice," ",l["\u0275\u0275pipeBind1"](2,3,"PerYear"),"")}}function ar(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"h4",24),l["\u0275\u0275template"](1,nr,4,5,"span",25),l["\u0275\u0275template"](2,rr,4,5,"span",25),l["\u0275\u0275template"](3,ir,4,5,"span",25),l["\u0275\u0275template"](4,or,3,5,"span",25),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.edition.dailyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.edition.weeklyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.edition.monthlyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",e.edition.annualPrice>0)}}function sr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span",28),l["\u0275\u0275element"](1,"i",29),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",e.displayName," ")}}function cr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span",30),l["\u0275\u0275element"](1,"i",31),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",e.displayName," ")}}function lr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span",28),l["\u0275\u0275element"](1,"i",29),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit,t=l["\u0275\u0275nextContext"]().$implicit,n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate2"](" ",e.displayName,":",n.getFeatureValueForEdition(e,t)," ")}}function dr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275template"](1,sr,3,1,"span",26),l["\u0275\u0275template"](2,cr,3,1,"span",27),l["\u0275\u0275template"](3,lr,3,2,"span",26),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=l["\u0275\u0275nextContext"]().$implicit,r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.isTrueFalseFeature(e)&&r.featureEnabledForEdition(e,n)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.isTrueFalseFeature(e)&&!r.featureEnabledForEdition(e,n)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!r.isTrueFalseFeature(e))}}function pr(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button",32),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](e);const t=l["\u0275\u0275nextContext"]().$implicit,n=l["\u0275\u0275nextContext"]();return n.upgrade(t.edition,n.editionPaymentType.Upgrade)}),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()}2&e&&(l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"Upgrade")," "))}const ur=function(){return["/account/register-tenant"]},hr=function(e,t){return{editionId:e,subscriptionStartType:t}};function mr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"button",33),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit,t=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](5,ur))("queryParams",l["\u0275\u0275pureFunction2"](6,hr,e.edition.id,t.subscriptionStartType.Free)),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,3,"Start")," ")}}function gr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"button",34),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit,t=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](5,ur))("queryParams",l["\u0275\u0275pureFunction2"](6,hr,e.edition.id,t.subscriptionStartType.Trial)),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,3,"FreeTrial")," ")}}const fr=function(e,t,n){return{editionId:e,subscriptionStartType:t,editionPaymentType:n}};function vr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"button",35),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]().$implicit,t=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](5,ur))("queryParams",l["\u0275\u0275pureFunction3"](6,fr,e.edition.id,t.subscriptionStartType.Paid,t.editionPaymentType.NewRegistration)),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,3,"BuyNow")," ")}}function _r(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",10),l["\u0275\u0275elementStart"](1,"div",11),l["\u0275\u0275elementStart"](2,"span",12),l["\u0275\u0275namespaceSVG"](),l["\u0275\u0275elementStart"](3,"svg",13),l["\u0275\u0275element"](4,"polyline",14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275namespaceHTML"](),l["\u0275\u0275elementStart"](5,"span",15),l["\u0275\u0275element"](6,"i"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"span",16),l["\u0275\u0275text"](8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](9,tr,4,3,"h4",17),l["\u0275\u0275template"](10,ar,5,4,"h4",17),l["\u0275\u0275elementStart"](11,"p",18),l["\u0275\u0275template"](12,dr,4,3,"span",19),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](13,pr,3,3,"button",20),l["\u0275\u0275template"](14,mr,3,9,"button",21),l["\u0275\u0275template"](15,gr,3,9,"button",22),l["\u0275\u0275template"](16,vr,3,10,"button",23),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit,n=t.index,r=l["\u0275\u0275nextContext"]();l["\u0275\u0275classProp"]("border-left-md",n>0),l["\u0275\u0275advance"](6),l["\u0275\u0275classMapInterpolate1"]("fa ",r.editionIcons[n],""),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](e.edition.displayName),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.isFree(e.edition)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!r.isFree(e.edition)),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngForOf",r.editionsSelectOutput.allFeatures),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.isUserLoggedIn),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!r.isUserLoggedIn&&r.isFree(e.edition)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!r.isUserLoggedIn&&!r.isFree(e.edition)&&e.edition.trialDayCount),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!r.isUserLoggedIn&&!r.isFree(e.edition))}}let yr=(()=>{class e extends I.a{constructor(e,t,n,r){super(e),this._tenantRegistrationService=t,this._editionHelperService=n,this._router=r,this.editionsSelectOutput=new C.Gb,this.isUserLoggedIn=!1,this.isSetted=!1,this.editionPaymentType=C.Db,this.subscriptionStartType=C.xe,this.editionIcons=["flaticon-open-box","flaticon-rocket","flaticon-gift","flaticon-confetti","flaticon-cogwheel-2","flaticon-app","flaticon-coins","flaticon-piggy-bank","flaticon-bag","flaticon-lifebuoy","flaticon-technology-1","flaticon-cogwheel-1","flaticon-infinity","flaticon-interface-5","flaticon-squares-3","flaticon-interface-6","flaticon-mark","flaticon-business","flaticon-interface-7","flaticon-list-2","flaticon-bell","flaticon-technology","flaticon-squares-2","flaticon-notes","flaticon-profile","flaticon-layers","flaticon-interface-4","flaticon-signs","flaticon-menu-1","flaticon-symbol"]}ngOnInit(){this.isUserLoggedIn=abp.session.userId>0,this._tenantRegistrationService.getEditionsForSelect().subscribe(e=>{this.editionsSelectOutput=e,(!this.editionsSelectOutput.editionsWithFeatures||this.editionsSelectOutput.editionsWithFeatures.length<=0)&&this._router.navigate(["/account/register-tenant"])})}isFree(e){return this._editionHelperService.isEditionFree(e)}isTrueFalseFeature(e){return"CHECKBOX"===e.inputType.name}featureEnabledForEdition(e,t){const n=Object(T.a)(t.featureValues,{name:e.name});return!(!n||n.length<=0)&&"true"===n[0].value.toLowerCase()}getFeatureValueForEdition(e,t){const n=Object(T.a)(t.featureValues,{name:e.name});return!n||n.length<=0?"":n[0].value}upgrade(e,t){this._router.navigate(["/account/upgrade"],{queryParams:{upgradeEditionId:e.id,editionPaymentType:t}})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](C.De),l["\u0275\u0275directiveInject"](Tn),l["\u0275\u0275directiveInject"](S.e))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:8,vars:5,consts:[[1,"content","d-flex","flex-column","flex-column-fluid"],[1,"card","card-custom","gutter-b","shadow-lg"],[1,"card-body"],[1,"row","justify-content-center","mt-10","mb-0","pricing-items"],["class","alert alert-warning fade show","role","alert",4,"ngIf"],["class","pt-30 pt-md-25 px-5 mb-15 text-center","style","min-width:200px",3,"border-left-md",4,"ngFor","ngForOf"],["role","alert",1,"alert","alert-warning","fade","show"],[1,"alert-icon"],[1,"flaticon-warning"],[1,"alert-text"],[1,"pt-30","pt-md-25","px-5","mb-15","text-center",2,"min-width","200px"],[1,"d-flex","flex-center","position-relative","mb-25"],[1,"svg","svg-fill-primary","opacity-4","position-absolute"],["width","175","height","200"],["points","87,0 174,50 174,150 87,200 0,150 0,50 87,0"],[1,"pricing-item-icon","text-primary"],[1,"font-size-h1","d-block","d-block","font-weight-boldest","py-2","pricing-title"],["class","font-size-h6 d-block d-block font-weight-bold mb-7 pricing-subtitle","style","min-height: 100px;",4,"ngIf"],[1,"mb-4","d-flex","flex-column"],[4,"ngFor","ngForOf"],["class","btn btn-warning btn-pill  btn-brand btn-wide btn-uppercase btn-bolder btn-sm mx-2",3,"click",4,"ngIf"],["class","btn btn-success btn-pill  btn-brand btn-wide btn-uppercase btn-bolder btn-sm mx-2","href","#",3,"routerLink","queryParams",4,"ngIf"],["class","btn btn-warning btn-pill  btn-brand btn-wide btn-uppercase btn-bolder btn-sm mx-2","href","#",3,"routerLink","queryParams",4,"ngIf"],["class","btn btn-primary btn-pill  btn-brand btn-wide btn-uppercase btn-bolder btn-sm mx-2","href","#",3,"routerLink","queryParams",4,"ngIf"],[1,"font-size-h6","d-block","d-block","font-weight-bold","mb-7","pricing-subtitle",2,"min-height","100px"],[4,"ngIf"],["class","text-success text-center",4,"ngIf"],["class","text-muted text-center",4,"ngIf"],[1,"text-success","text-center"],[1,"far","fa-check-circle","text-success"],[1,"text-muted","text-center"],[1,"far","fa-times-circle","text-muted"],[1,"btn","btn-warning","btn-pill","btn-brand","btn-wide","btn-uppercase","btn-bolder","btn-sm","mx-2",3,"click"],["href","#",1,"btn","btn-success","btn-pill","btn-brand","btn-wide","btn-uppercase","btn-bolder","btn-sm","mx-2",3,"routerLink","queryParams"],["href","#",1,"btn","btn-warning","btn-pill","btn-brand","btn-wide","btn-uppercase","btn-bolder","btn-sm","mx-2",3,"routerLink","queryParams"],["href","#",1,"btn","btn-primary","btn-pill","btn-brand","btn-wide","btn-uppercase","btn-bolder","btn-sm","mx-2",3,"routerLink","queryParams"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div"),l["\u0275\u0275elementStart"](1,"div",0),l["\u0275\u0275elementStart"](2,"div"),l["\u0275\u0275elementStart"](3,"div",1),l["\u0275\u0275elementStart"](4,"div",2),l["\u0275\u0275elementStart"](5,"div",3),l["\u0275\u0275template"](6,er,6,3,"div",4),l["\u0275\u0275template"](7,_r,17,13,"div",5),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](2),l["\u0275\u0275classMap"](t.containerClass),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngIf",!t.editionsSelectOutput||!t.editionsSelectOutput.editionsWithFeatures),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",t.editionsSelectOutput.editionsWithFeatures))},directives:[r.t,r.s,S.f],pipes:[ft.a],styles:["body{background-color:#f2f3f8}button:disabled,button[disabled]{cursor:not-allowed!important}.row-centered{text-align:center;display:block!important}.col-centered{display:inline-table;float:none;text-align:center;margin-right:-4px}.pricing-items .pricing-title{font-size:3rem;font-weight:700;display:block;margin-top:5em;color:#6c7293}.pricing-items .pricing-subtitle{font-size:1.1rem;color:#adb1c7;font-weight:500;min-height:72px}.pricing-items .pricing-item-icon{left:50%;transform:translateX(-50%);position:absolute}.pricing-items .pricing-item-icon>i{font-size:8.57rem}"],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})();var Sr=n("IQ2n"),Er=n("PEYQ");function br(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",12),l["\u0275\u0275elementStart"](1,"div",13),l["\u0275\u0275element"](2,"i",14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"div",15),l["\u0275\u0275elementStart"](4,"h4"),l["\u0275\u0275text"](5),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"p"),l["\u0275\u0275elementStart"](7,"span"),l["\u0275\u0275text"](8),l["\u0275\u0275elementStart"](9,"strong"),l["\u0275\u0275text"](10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](11,"br"),l["\u0275\u0275elementStart"](12,"span"),l["\u0275\u0275text"](13),l["\u0275\u0275elementStart"](14,"strong"),l["\u0275\u0275text"](15),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",e.l("DemoPayPalAccount")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"]("",e.l("UserName"),": "),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](e.config.demoUsername),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"]("",e.l("Password"),": "),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](e.config.demoPassword)}}function Ir(e,t){if(1&e&&l["\u0275\u0275element"](0,"div",16),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("busyIf",e.paypalIsLoading)}}let Tr=(()=>{class e extends I.a{constructor(e,t,n,r,i,o){super(e),this.injector=e,this._activatedRoute=t,this._payPalPaymentAppService=n,this._paymentAppService=r,this._router=i,this._tenantRegistrationHelper=o,this.paypalIsLoading=!0,this.subscriptionPaymentGateway=C.ue,this.totalAmount=0,this.description=""}ngOnInit(){this.paymentId=this._activatedRoute.snapshot.queryParams.paymentId,this.redirectUrl=this._activatedRoute.snapshot.queryParams.redirectUrl,this._payPalPaymentAppService.getConfiguration().subscribe(e=>{this.config=e,(new A.a).load("https://www.paypal.com/sdk/js?client-id="+e.clientId+"&currency="+this.appSession.application.currency).then(()=>{this._paymentAppService.getPayment(this.paymentId).subscribe(e=>{this.description=e.description,this.totalAmount=e.amount,this.successCallbackUrl=e.successUrl,this.errorCallbackUrl=e.errorUrl,this.subscriptionPaymentGateway=e.gateway,this.paypalIsLoading=!1,this.preparePaypalButton()})})})}preparePaypalButton(){const e=this;window.paypal.Buttons({createOrder:function(t,n){return n.order.create({purchase_units:[{amount:{value:e.totalAmount,currency_code:e.appSession.application.currency}}]})},onApprove:function(t,n){e._payPalPaymentAppService.confirmPayment(e.paymentId,t.orderID).subscribe(()=>{Sr.a.ajax("post",e.successCallbackUrl+(e.successCallbackUrl.includes("?")?"&":"?")+"paymentId="+e.paymentId,null,null,t=>{e._tenantRegistrationHelper.registrationResult&&(e._tenantRegistrationHelper.registrationResult.isActive=!0),e._router.navigate([e.redirectUrl])})})}}).render("#paypal-button")}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](S.a),l["\u0275\u0275directiveInject"](C.jd),l["\u0275\u0275directiveInject"](C.od),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](Mn))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["paypal-purchase-component"]],inputs:{editionPaymentType:"editionPaymentType"},features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:23,vars:14,consts:[[1,"login-form"],[1,"card","card-bordered"],[1,"card-header"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-4"],[1,"col-sm-8","text-right"],[1,"font-weight-bold"],["id","totalPrice",1,"font-weight-bold"],["class","alert alert-custom alert-light-dark fade show mb-5","role","alert",4,"ngIf"],["id","paypal-button"],[3,"busyIf",4,"ngIf"],["role","alert",1,"alert","alert-custom","alert-light-dark","fade","show","mb-5"],[1,"alert-icon"],[1,"flaticon-questions-circular-button"],[1,"alert-text"],[3,"busyIf"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"h3"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"div",3),l["\u0275\u0275elementStart"](7,"div",4),l["\u0275\u0275elementStart"](8,"label",5),l["\u0275\u0275text"](9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",6),l["\u0275\u0275elementStart"](11,"p",7),l["\u0275\u0275text"](12),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"div",4),l["\u0275\u0275elementStart"](14,"label",5),l["\u0275\u0275text"](15),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"div",6),l["\u0275\u0275elementStart"](17,"p",8),l["\u0275\u0275text"](18),l["\u0275\u0275pipe"](19,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](20,br,16,5,"div",9),l["\u0275\u0275element"](21,"div",10),l["\u0275\u0275template"](22,Ir,1,1,"div",11),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,9,"TenantSignUp")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate"](t.l("Item")),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",t.description," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](t.l("Price")),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate2"](" ",t.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](19,11,t.totalAmount,"1.2-2")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.config&&t.config.demoUsername&&t.config.demoPassword),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.paypalIsLoading))},directives:[r.t,Er.a],pipes:[ft.a,r.g],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})();function wr(e,t){if(1&e&&l["\u0275\u0275element"](0,"div",11),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("busyIf",e.stripeIsLoading)}}let Cr=(()=>{class e extends I.a{constructor(e,t,n,r){super(e),this._activatedRoute=t,this._stripePaymentAppService=n,this._paymentAppService=r,this.amount=0,this.description="",this.stripeIsLoading=!0,this.subscriptionPaymentGateway=C.ue,this.subscriptionStartType=C.xe}ngOnInit(){this.spinnerService.show(),this.stripeIsLoading=!0,this.paymentId=this._activatedRoute.snapshot.queryParams.paymentId,(new A.a).load("https://js.stripe.com/v3").then(()=>{this._stripePaymentAppService.getConfiguration().subscribe(e=>{this._stripePaymentAppService.createPaymentSession(new C.ie({paymentId:this.paymentId,successUrl:b.a.appBaseUrl+"/account/stripe-payment-result",cancelUrl:b.a.appBaseUrl+"/account/stripe-cancel-payment"})).subscribe(t=>{this._paymentAppService.getPayment(this.paymentId).subscribe(n=>{this.spinnerService.hide(),this.amount=n.amount,this.description=n.description,this.successCallbackUrl=n.successUrl,this.errorCallbackUrl=n.errorUrl;let r=window.Stripe(e.publishableKey);document.getElementById("stripe-checkout").addEventListener("click",function(){r.redirectToCheckout({sessionId:t})}),this.stripeIsLoading=!1},e=>{this.spinnerService.hide()})},e=>{this.spinnerService.hide()})},e=>{this.spinnerService.hide()})}).catch(e=>{this.spinnerService.hide()})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](S.a),l["\u0275\u0275directiveInject"](C.je),l["\u0275\u0275directiveInject"](C.od))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["stripe-purchase-component"]],inputs:{editionPaymentType:"editionPaymentType"},features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:24,vars:17,consts:[[1,"login-form"],[1,"card","card-bordered"],[1,"card-header"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-4"],[1,"col-sm-8","text-right"],[1,"font-weight-bold"],["id","totalPrice",1,"font-weight-bold"],["id","stripe-checkout",1,"btn","btn-primary","btn-block",3,"disabled"],[3,"busyIf",4,"ngIf"],[3,"busyIf"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"h3"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"div",3),l["\u0275\u0275elementStart"](7,"div",4),l["\u0275\u0275elementStart"](8,"label",5),l["\u0275\u0275text"](9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",6),l["\u0275\u0275elementStart"](11,"p",7),l["\u0275\u0275text"](12),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"div",4),l["\u0275\u0275elementStart"](14,"label",5),l["\u0275\u0275text"](15),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"div",6),l["\u0275\u0275elementStart"](17,"p",8),l["\u0275\u0275text"](18),l["\u0275\u0275pipe"](19,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"button",9),l["\u0275\u0275text"](21),l["\u0275\u0275pipe"](22,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](23,wr,1,1,"div",10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,10,"TenantSignUp")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate"](t.l("Item")),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",t.description," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](t.l("Price")),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate2"](" ",t.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](19,12,t.amount,"1.2-2")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.stripeIsLoading),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](22,15,"Purchase")),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.stripeIsLoading))},directives:[r.t,Er.a],pipes:[ft.a,r.g],encapsulation:2,data:{animation:[Object(Ft.a)()]}}),e})(),Ar=(()=>{class e extends I.a{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["stripe-cancel-payment"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:11,vars:6,consts:[[1,"d-flex","h-100","align-items-center",2,"padding-bottom","150px !important"],[1,"login-form","align-middle","m-0","text-center"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],[1,"my-5"],[1,"fas","fa-times","fa-4x","text-danger"],["href","/app/admin/subscription-management",1,"btn","btn-info"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"h3",3),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"div",4),l["\u0275\u0275element"](7,"i",5),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](8,"a",6),l["\u0275\u0275text"](9),l["\u0275\u0275pipe"](10,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,2,"PaymentCouldNotCompleted")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](10,4,"GoToSubscriptionManagement"),""))},pipes:[ft.a],encapsulation:2}),e})(),kr=(()=>{class e extends I.a{constructor(e,t,n,r,i){super(e),this._stripePaymentService=t,this._activatedRoute=n,this._router=r,this._sessionService=i,this.controlTimeout=5e3,this.maxControlCount=5}ngOnInit(){this.sessionId=this._activatedRoute.snapshot.queryParams.sessionId,this._stripePaymentService.getPayment(this.sessionId).subscribe(e=>{this._sessionService.tenantId!==e.tenantId&&this._router.navigate([""]),this.paymentId=e.id,this.getPaymentResult()})}getPaymentResult(){this._stripePaymentService.getPaymentResult(this.paymentId).subscribe(e=>{e.paymentDone?this._router.navigate(["account/payment-completed"]):this.controlAgain()},e=>{this.controlAgain()})}controlAgain(){0!==this.maxControlCount&&(setTimeout(()=>{this.getPaymentResult()},this.controlTimeout),this.controlTimeout*=2,this.maxControlCount--)}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](C.je),l["\u0275\u0275directiveInject"](S.a),l["\u0275\u0275directiveInject"](S.e),l["\u0275\u0275directiveInject"](at.d))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["stripe-payment-result"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:12,vars:10,consts:[[1,"d-flex","h-100","align-items-center",2,"padding-bottom","150px !important"],[1,"login-formalign-middle","m-0"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],[1,"text-center"],[2,"position","relative","margin-top","60px !important"],[3,"busyIf"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"h3",3),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"p",4),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"localize"),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",5),l["\u0275\u0275element"](11,"div",6),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,4,"PleaseWait")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate2"](" ",l["\u0275\u0275pipeBind1"](8,6,"ReceivingPaymentResult")," ",l["\u0275\u0275pipeBind1"](9,8,"PleaseWait")," "),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("busyIf",!0))},directives:[Er.a],pipes:[ft.a],encapsulation:2}),e})(),Or=(()=>{class e extends I.a{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["payment-completed"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:14,vars:9,consts:[[1,"d-flex","h-100","align-items-center",2,"padding-bottom","150px !important"],[1,"login-form","align-middle","m-0","text-center"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],[1,"text-center"],[1,"my-5"],[1,"fas","fa-check","fa-4x","text-success"],["href","/app/admin/subscription-management",1,"btn","btn-info"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"h3",3),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"p",4),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](9,"div",5),l["\u0275\u0275element"](10,"i",6),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](11,"a",7),l["\u0275\u0275text"](12),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,3,"ThankYou")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](8,5,"YourPaymentHasBeenCompleted")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](13,7,"GoToSubscriptionManagement"),""))},pipes:[ft.a],encapsulation:2}),e})();function xr(e,t){if(1&e&&l["\u0275\u0275element"](0,"img",24),2&e){const e=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("src",e.userInfo.profilePicture,l["\u0275\u0275sanitizeUrl"])}}function Rr(e,t){if(1&e&&l["\u0275\u0275element"](0,"validation-messages",25),2&e){l["\u0275\u0275nextContext"]();const e=l["\u0275\u0275reference"](25);l["\u0275\u0275property"]("formCtrl",e)}}let Pr=(()=>{class e extends I.a{constructor(e,t,n,r){super(e),this._profileService=t,this._reCaptchaV3Service=n,this.loginService=r,this.recaptchaSiteKey=b.a.recaptchaSiteKey,this.submitting=!1,this.getLastUserInfo()}getLastUserInfo(){let e=abp.utils.getCookieValue("userInfo");e||(location.href="");let t=JSON.parse(e);t||(location.href=""),this.loginService.authenticateModel.userNameOrEmailAddress=t.userName,this.userInfo={userName:t.userName,tenant:t.tenant,profilePicture:""},this._profileService.getProfilePictureByUserName(t.userName).subscribe(e=>{this.userInfo.profilePicture=e.profilePicture?"data:image/jpeg;base64,"+e.profilePicture:b.a.appBaseUrl+"/assets/common/images/default-profile-picture.png"},()=>{this.userInfo.profilePicture=b.a.appBaseUrl+"/assets/common/images/default-profile-picture.png"})}login(){let e=e=>{this.showMainSpinner(),this.submitting=!0,this.loginService.authenticate(()=>{this.submitting=!1,this.hideMainSpinner()},null,e)};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"login",t=>{e(t)}):e(null)}get useCaptcha(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnLogin")}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](C.Dd),l["\u0275\u0275directiveInject"](u),l["\u0275\u0275directiveInject"](lt))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-session-lock-screen"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:38,vars:20,consts:[[1,"card","card-bordered","gutter-b","card-stretch"],[1,"card-body","text-center","pt-4"],["role","alert",1,"alert","alert-custom","alert-light-warning"],[1,"alert-text",2,"font-weight","bold"],[1,"fa","fa-lock","float-right"],[1,"mt-7","pb-2"],[1,"symbol","symbol-circle","symbol-lg-75"],["class","symbol-label","alt","profileimage",3,"src",4,"ngIf"],[1,"my-2"],["href","#",1,"text-dark","font-weight-bold","text-hover-primary","font-size-h4"],[1,"text-dark","font-weight-normal","font-size-h4"],[1,"text-dark","font-weight-bold"],["method","post","novalidate","",1,"form","mt-4",3,"ngSubmit"],["loginForm","ngForm"],[1,"form-group"],["type","hidden","name","usernameOrEmailAddress"],["type","password","autocomplete","new-password","name","password","required","","maxlength","32",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["passwordInput","ngModel"],[3,"formCtrl",4,"ngIf"],[1,"mt-9","mb-6"],[1,"col-5","mt-2","float-left"],[1,"checkbox"],["type","checkbox","name","rememberMe","value","true",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","col-4","float-right",3,"disabled"],["alt","profileimage",1,"symbol-label",3,"src"],[3,"formCtrl"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"div",3),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275element"](6,"i",4),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"div",5),l["\u0275\u0275elementStart"](8,"div",6),l["\u0275\u0275template"](9,xr,1,1,"img",7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",8),l["\u0275\u0275elementStart"](11,"a",9),l["\u0275\u0275text"](12),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"div",8),l["\u0275\u0275elementStart"](14,"span",10),l["\u0275\u0275text"](15,"Tenant: "),l["\u0275\u0275elementStart"](16,"span",11),l["\u0275\u0275text"](17),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](18,"form",12,13),l["\u0275\u0275listener"]("ngSubmit",function(){return t.login()}),l["\u0275\u0275elementStart"](20,"div",8),l["\u0275\u0275elementStart"](21,"div",14),l["\u0275\u0275element"](22,"input",15),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](23,"div",14),l["\u0275\u0275elementStart"](24,"input",16,17),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.loginService.authenticateModel.password=e}),l["\u0275\u0275pipe"](26,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](27,Rr,1,1,"validation-messages",18),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](28,"div",19),l["\u0275\u0275elementStart"](29,"div",20),l["\u0275\u0275elementStart"](30,"label",21),l["\u0275\u0275elementStart"](31,"input",22),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.loginService.rememberMe=e}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](32,"span"),l["\u0275\u0275text"](33),l["\u0275\u0275pipe"](34,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](35,"button",23),l["\u0275\u0275text"](36),l["\u0275\u0275pipe"](37,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275reference"](19),n=l["\u0275\u0275reference"](25);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](5,12,"YourSessionIsLocked")),l["\u0275\u0275advance"](5),l["\u0275\u0275property"]("ngIf",t.userInfo&&t.userInfo.profilePicture),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](t.userInfo.userName),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate"](t.userInfo.tenant),l["\u0275\u0275advance"](7),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](26,14,"Password"),"*"),l["\u0275\u0275property"]("ngModel",t.loginService.authenticateModel.password),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",!n.touched),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngModel",t.loginService.rememberMe),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](34,16,"RememberMe")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!e.form.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](37,18,"LogIn"))}},directives:[r.t,a["\u0275angular_packages_forms_forms_y"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,a.RequiredValidator,a.MaxLengthValidator,a.NgControlStatus,a.NgModel,a.CheckboxControlValueAccessor,Bt.a],pipes:[ft.a],styles:["app-session-lock-screen[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column}"],data:{animation:[Object(Ft.a)()]}}),e})();var Nr=n("ll/a");let Lr=(()=>{class e{constructor(e,t){this.router=e,this._uiCustomizationService=t,e.events.subscribe(e=>{setTimeout(()=>{this.toggleBodyCssClass(e.url)},0)})}toggleBodyCssClass(e){e?e.indexOf("/account/")>=0?this.setAccountModuleBodyClassInternal():document.body.className=this._uiCustomizationService.getAppModuleBodyClass():this.setAccountModuleBodyClassInternal()}setAccountModuleBodyClassInternal(){let e="";document.body.className.indexOf("swal2-toast-shown")>=0&&(e+=" swal2-toast-shown"),document.body.className=this._uiCustomizationService.getAccountModuleBodyClass()+" "+e}}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)(l["\u0275\u0275inject"](S.e),l["\u0275\u0275inject"](E.a))},imports:[[S.i.forChild([{path:"",component:Dt,children:[{path:"",redirectTo:"login"},{path:"login",component:$t,canActivate:[Ht]},{path:"register",component:Zn,canActivate:[Ht]},{path:"register-tenant",component:Xn,canActivate:[Ht]},{path:"register-tenant-result",component:qn,canActivate:[Ht]},{path:"forgot-password",component:cn,canActivate:[Ht]},{path:"reset-password",component:mn,canActivate:[Ht]},{path:"email-activation",component:Kt,canActivate:[Ht]},{path:"confirm-email",component:qt,canActivate:[Ht]},{path:"send-code",component:tn,canActivate:[Ht]},{path:"verify-code",component:an,canActivate:[Ht]},{path:"buy",component:In},{path:"extend",component:Un},{path:"upgrade",component:On},{path:"select-edition",component:yr},{path:"paypal-purchase",component:Tr},{path:"stripe-purchase",component:Cr},{path:"stripe-payment-result",component:kr},{path:"stripe-cancel-payment",component:Ar},{path:"payment-completed",component:Or},{path:"session-locked",component:Pr},{path:"enrollment",component:Nr.a},{path:"**",redirectTo:"login"}]}])],S.i]}),e})();var Ur=n("+yPr"),Mr=n("S56A"),Dr=function(){return function(){}}();n("LRne"),n("w1tV"),n("lJxs");var jr=function(){function e(){}var t;return t=e,e.forRoot=function(e){return{ngModule:t,providers:[{provide:Dr,useValue:e}]}},e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)}}),e}();function Hr(){return(new Ur.a).map("recaptcha",abp.localization.currentLanguage.name)}let qr=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[lt,Mn,gn,Ht],imports:[[r.c,a.FormsModule,i.e,i.d,h,y.c.forRoot(),o.a,c.a,s.a,Lr,x.b.forRoot(),zn,Mr.a,jr]]}),e})()},tS1D:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n("D0XW");const i=(()=>{function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e})();var o=n("mlxB"),a=n("zx2A");class s{constructor(e,t,n,r){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=n,this.scheduler=r}call(e,t){return t.subscribe(new c(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))}}class c extends a.b{constructor(e,t,n,r,i){super(e),this.absoluteTimeout=t,this.waitFor=n,this.withObservable=r,this.scheduler=i,this.scheduleTimeout()}static dispatchTimeout(e){const{withObservable:t}=e;e._unsubscribeAndRecycle(),e.add(Object(a.c)(t,new a.a(e)))}scheduleTimeout(){const{action:e}=this;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(c.dispatchTimeout,this.waitFor,this))}_next(e){this.absoluteTimeout||this.scheduleTimeout(),super._next(e)}_unsubscribe(){this.action=void 0,this.scheduler=null,this.withObservable=null}}var l=n("z6cu");function d(e,t=r.a){return function(e,t,n=r.a){return r=>{let i=Object(o.a)(e),a=i?+e-n.now():Math.abs(e);return r.lift(new s(a,i,t,n))}}(e,Object(l.a)(new i),t)}}}]);