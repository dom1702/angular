(function(){function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){s=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{5756:function(e,t,n){var r=function(){"use strict";return r=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},r.prototype._singletonInstance)return r.prototype._singletonInstance;if(r.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),r.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var n=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n)}},r.prototype._openPopup=function(e,t,n,r){try{var i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=window.open(e,t,"width="+n+", height="+r+", top="+(s/2-r/2+o)+", left="+(a/2-n/2+i));return c.focus&&c.focus(),c}catch(l){return this.warn("Error opening popup, "+l.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},r.prototype._handlePopupError=function(e,t,n,r,i){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,i),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(r,null,n)},r.prototype._loginPopup=function(e,t,n){var r=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),i=n||this.callback;if(null!=r){if(this._openedWindows.push(r),-1!=this.config.redirectUri.indexOf("#"))var o=this.config.redirectUri.split("#")[0];else o=this.config.redirectUri;var a=this,s=window.setInterval(function(){if(!r||r.closed||void 0===r.closed){var e="Popup Window closed",n="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return a.isAngular&&a._broadcast("adal:popUpClosed",n+a.CONSTANTS.RESOURCE_DELIMETER+e),a._handlePopupError(i,t,e,n,n),void window.clearInterval(s)}try{var c=r.location;if(-1!=encodeURI(c.href).indexOf(encodeURI(o)))return a.isAngular?a._broadcast("adal:popUpHashChanged",c.hash):a.handleWindowCallback(c.hash),window.clearInterval(s),a._loginInProgress=!1,a._acquireTokenInProgress=!1,a.info("Closing popup window"),a._openedWindows=[],void r.close()}catch(l){}},1)}else{var c="Popup Window is null. This can happen if you are using IE";this._handlePopupError(i,t,"Error opening popup",c,c)}},r.prototype._broadcast=function(e,t){!function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}();var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},r.prototype.loginInProgress=function(){return this._loginInProgress},r.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},r.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),r=this.config.expireOffsetSeconds||300;return n&&n>this._now()+r?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},r.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},r.prototype.registerCallback=function(e,t,n){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var r=this;this._callBacksMappedToRenewStates[e].push(n),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(n,i,o,a){r._activeRenewals[t]=null;for(var s=0;s<r._callBacksMappedToRenewStates[e].length;++s)try{r._callBacksMappedToRenewStates[e][s](n,i,o,a)}catch(o){r.warn(o)}r._callBacksMappedToRenewStates[e]=null,r._callBackMappedToRenewStates[e]=null})},r.prototype._renewToken=function(e,t,n){this.info("renewToken is called for resource:"+e);var r=this._addAdalFrame("adalRenewFrame"+e),i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n=n||"token",e),"prompt");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),o+="&nonce="+encodeURIComponent(this._idTokenNonce)),o=this._addHintParameters(o+="&prompt=none"),this.registerCallback(i,e,t),this.verbosePii("Navigate to:"+o),r.src="about:blank",this._loadFrameTimeout(o,"adalRenewFrame"+e,e)},r.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var n=this._addAdalFrame("adalIdTokenFrame"),r=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose("Renew Idtoken Expected state: "+r);var i=null==t?null:this.config.clientId,o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(t=t||"id_token",i),"prompt");o=this._addHintParameters(o+="&prompt=none"),o+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,e),this.verbosePii("Navigate to:"+o),n.src="about:blank",this._loadFrameTimeout(o,"adalIdTokenFrame",this.config.clientId)},r.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},r.prototype._urlRemoveQueryStringParameter=function(e,t){var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e.replace(n,"")},r.prototype._loadFrameTimeout=function(e,t,n){this.verbose("Set loading state to pending for: "+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var r=this;setTimeout(function(){if(r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){r.verbose("Loading frame has timed out after: "+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+n);var e=r._activeRenewals[n];e&&r._callBackMappedToRenewStates[e]&&r._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},r.CONSTANTS.LOADFRAME_TIMEOUT)},r.prototype._loadFrame=function(e,t){var n=this;n.info("LoadFrame: "+t);var r=t;setTimeout(function(){var t=n._addAdalFrame(r);""!==t.src&&"about:blank"!==t.src||(t.src=e,n._loadFrame(e,r))},500)},r.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var n=this.getCachedToken(e);return n?(this.info("Token is already in cache for resource:"+e),void t(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},r.prototype.acquireTokenPopup=function(e,t,n,r){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(i,e,r),this._loginPopup(o,e,r)},r.prototype.acquireTokenRedirect=function(e,t,n){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");var r=this.callback;if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,i,!0),this.promptUser(o)},r.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},r.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},r.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},r.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t="common",n="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+n}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},r.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},r.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))}},r.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&this._user.profile.upn.indexOf("@")>-1)){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},r.prototype._createUser=function(e){var t=null,n=this._extractIdToken(e);return n&&n.hasOwnProperty("aud")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:n},n.hasOwnProperty("upn")?t.userName=n.upn:n.hasOwnProperty("email")&&(t.userName=n.email)):this.warn("IdToken has invalid aud field")),t},r.prototype._getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},r.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},r.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},r.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),n={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(n.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){if(n.valid=!0,!t.hasOwnProperty("state"))return this.warn("No state returned"),n;if(this.verbose("State: "+t.state),n.stateResponse=t.state,this._matchState(n))return n;if(!n.stateMatch&&window.parent){n.requestType=this._requestType;for(var r=this._renewStates,i=0;i<r.length;i++)if(r[i]===n.stateResponse){n.stateMatch=!0;break}}}return n},r.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]&&t[n]===e.profile.nonce)return!0}return!1},r.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]&&t[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r)for(r=r.split(this.CONSTANTS.CACHE_DELIMETER),n=0;n<r.length;n++)if(r[n]&&r[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0;return!1},r.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},r.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t,n=this._getResourceFromState(e.stateResponse);e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)?(this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description))):e.stateMatch?(this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(n)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),this._hasResource(n=this.config.loginResource?this.config.loginResource:this.config.clientId)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))):(e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse)),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},r.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(e.indexOf(n)>-1)return this.config.endpoints[n];return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},r.prototype._getHostFromUri=function(e){return String(e).replace(/^(https?:)\/\//,"").split("/")[0]},r.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,n=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var r,i,o=t.getRequestInfo(e),a=null;i=n||window.parent!==window?t._callBackMappedToRenewStates[o.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(o),o.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),r=o.parameters[t.CONSTANTS.ACCESS_TOKEN]||o.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ACCESS_TOKEN):o.requestType===this.REQUEST_TYPE.LOGIN&&(r=o.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ID_TOKEN);var s=o.parameters[t.CONSTANTS.ERROR_DESCRIPTION],c=o.parameters[t.CONSTANTS.ERROR];try{i&&i(s,r,c,a)}catch(l){t.error("Error occurred in user defined callback function: "+l)}window.parent!==window||n||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},r.prototype._getNavigateUrl=function(e,t){var n="common";this.config.tenant&&(n=this.config.tenant);var r=this.instance+n+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+r),r},r.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var n=this._base64DecodeStringUrlSafe(t.JWSPayload);return n?JSON.parse(n):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(r){this.error("The returned id_token could not be decoded",r)}return null},r.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},r.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(e=String(e).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,i,o,a,s,c,l,u="",d=0;d<n;d+=4){if(r=t.indexOf(e.charAt(d)),i=t.indexOf(e.charAt(d+1)),o=t.indexOf(e.charAt(d+2)),a=t.indexOf(e.charAt(d+3)),d+2===n-1){c=(s=r<<18|i<<12|o<<6)>>16&255,l=s>>8&255,u+=String.fromCharCode(c,l);break}if(d+1===n-1){c=(s=r<<18|i<<12)>>16&255,u+=String.fromCharCode(c);break}c=(s=r<<18|i<<12|o<<6|a)>>16&255,l=s>>8&255,u+=String.fromCharCode(c,l,255&s)}return u},r.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},r.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},r.prototype._serialize=function(e,t,n){var r=[];if(null!==t){r.push("?response_type="+e),r.push("client_id="+encodeURIComponent(t.clientId)),n&&r.push("resource="+encodeURIComponent(n)),r.push("redirect_uri="+encodeURIComponent(t.redirectUri)),r.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&r.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&r.push(t.extraQueryParameter);var i=t.correlationId?t.correlationId:this._guid();r.push("client-request-id="+encodeURIComponent(i))}return r.join("&")},r.prototype._deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},o={};for(t=r.exec(e);t;)o[i(t[1])]=i(t[2]),t=r.exec(e);return o},r.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},r.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",i=0,o="",a=0;a<36;a++)"-"!==n[a]&&"4"!==n[a]&&(i=16*Math.random()|0),"x"===n[a]?o+=r[i]:"y"===n[a]?(i&=3,o+=r[i|=8]):o+=n[a];return o},r.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},r.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},r.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height=n.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},r.prototype._saveItem=function(e,t,n){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(n){var r=this._getItem(e)||"";localStorage.setItem(e,r+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},r.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},r.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},r.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},r.prototype.log=function(e,t,n,r){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var i=(new Date).toUTCString(),o="";o=this.config.correlationId?i+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:i+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,n&&(o+="\nstack:\n"+n.stack),Logging.log(o)}},r.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},r.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},r.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},r.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},r.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},r.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},r.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},r.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},r.prototype._libVersion=function(){return"1.0.18"},e.exports&&(e.exports=r,e.exports.inject=function(e){return new r(e)}),r}()},LgUO:function LgUO(module,__webpack_exports__,__webpack_require__){"use strict";(function(module){__webpack_require__.d(__webpack_exports__,"a",function(){return AuthConfig}),__webpack_require__.d(__webpack_exports__,"b",function(){return OAuthModule}),__webpack_require__.d(__webpack_exports__,"c",function(){return OAuthService});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("fXoL"),_angular_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("ofXK"),_angular_common_http__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("tk/3"),tslib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("mrSG"),rxjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("XNiG"),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("LRne"),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("Cfvw"),rxjs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("Nv8m"),rxjs__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("z6cu"),rxjs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("itXk"),rxjs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("VRyK"),rxjs_operators__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("pLZG"),rxjs_operators__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("vkgz"),rxjs_operators__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("Kj3r"),rxjs_operators__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("3E0/"),rxjs_operators__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("eIep"),rxjs_operators__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("lJxs"),rxjs_operators__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("SxV6"),rxjs_operators__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("JIr8"),rxjs_operators__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("tS1D"),rxjs_operators__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("IzEk"),rxjs_operators__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("5+tZ"),LoginOptions=function e(){_classCallCheck(this,e),this.preventClearHashAfterLogin=!1},OAuthLogger=function e(){_classCallCheck(this,e)},OAuthStorage=function e(){_classCallCheck(this,e)},MemoryStorage=function(){var e=function(){function e(){_classCallCheck(this,e),this.data=new Map}return _createClass(e,[{key:"getItem",value:function(e){return this.data.get(e)}},{key:"removeItem",value:function(e){this.data.delete(e)}},{key:"setItem",value:function(e,t){this.data.set(e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}(),ReceivedTokens=function e(){_classCallCheck(this,e)};function b64DecodeUnicode(e){var t=e.replace(/\-/g,"+").replace(/\_/g,"/");return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function base64UrlEncode(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}var ValidationHandler=function e(){_classCallCheck(this,e)},AbstractValidationHandler=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"validateAtHash",value:function(e){return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.b)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.inferHashAlgorithm(e.idTokenHeader),t.next=3,this.calcHash(e.accessToken,n);case 3:return r=t.sent,i=base64UrlEncode(r.substr(0,r.length/2)),o=e.idTokenClaims.at_hash.replace(/=/g,""),t.abrupt("return",(i!==o&&(console.error("exptected at_hash: "+i),console.error("actual at_hash: "+o)),i===o));case 7:case"end":return t.stop()}},t,this)}))}},{key:"inferHashAlgorithm",value:function(e){var t=e.alg;if(!t.match(/^.S[0-9]{3}$/))throw new Error("Algorithm not supported: "+t);return"sha-"+t.substr(2)}}]),e}(),UrlHelperService=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getHashFragmentParams",value:function(e){var t=e||window.location.hash;if(0!==(t=decodeURIComponent(t)).indexOf("#"))return{};var n=t.indexOf("?");return t=t.substr(n>-1?n+1:1),this.parseQueryString(t)}},{key:"parseQueryString",value:function(e){var t,n,r,i,o,a,s,c={};if(null===e)return c;t=e.split("&");for(var l=0;l<t.length;l++)-1===(r=(n=t[l]).indexOf("="))?(i=n,o=null):(i=n.substr(0,r),o=n.substr(r+1)),a=decodeURIComponent(i),s=decodeURIComponent(o),"/"===a.substr(0,1)&&(a=a.substr(1)),c[a]=s;return c}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}(),OAuthEvent=function e(t){_classCallCheck(this,e),this.type=t},OAuthSuccessEvent=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return _classCallCheck(this,n),(r=t.call(this,e)).info=i,r}return n}(OAuthEvent),OAuthInfoEvent=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return _classCallCheck(this,n),(r=t.call(this,e)).info=i,r}return n}(OAuthEvent),OAuthErrorEvent=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return _classCallCheck(this,n),(i=t.call(this,e)).reason=r,i.params=o,i}return n}(OAuthEvent),AuthConfig=function e(t){_classCallCheck(this,e),this.clientId="",this.redirectUri="",this.postLogoutRedirectUri="",this.loginUrl="",this.scope="openid profile",this.resource="",this.rngUrl="",this.oidc=!0,this.requestAccessToken=!0,this.options=null,this.issuer="",this.logoutUrl="",this.clearHashAfterLogin=!0,this.tokenEndpoint=null,this.revocationEndpoint=null,this.customTokenParameters=[],this.userinfoEndpoint=null,this.responseType="",this.showDebugInformation=!1,this.silentRefreshRedirectUri="",this.silentRefreshMessagePrefix="",this.silentRefreshShowIFrame=!1,this.siletRefreshTimeout=2e4,this.silentRefreshTimeout=2e4,this.dummyClientSecret=null,this.requireHttps="remoteOnly",this.strictDiscoveryDocumentValidation=!0,this.jwks=null,this.customQueryParams=null,this.silentRefreshIFrameName="angular-oauth-oidc-silent-refresh-iframe",this.timeoutFactor=.75,this.sessionChecksEnabled=!1,this.sessionCheckIntervall=3e3,this.sessionCheckIFrameUrl=null,this.sessionCheckIFrameName="angular-oauth-oidc-check-session-iframe",this.disableAtHashCheck=!1,this.skipSubjectCheck=!1,this.useIdTokenHintForSilentRefresh=!1,this.skipIssuerCheck=!1,this.nonceStateSeparator=";",this.useHttpBasicAuth=!1,this.waitForTokenInMsec=0,this.disablePKCE=!1,this.openUri=function(e){location.href=e},t&&Object.assign(this,t)},WebHttpUrlEncodingCodec=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"encodeKey",value:function(e){return encodeURIComponent(e)}},{key:"encodeValue",value:function(e){return encodeURIComponent(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD="function"==typeof define&&__webpack_require__("PDX0"),ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e,t){return function(n){return new Sha256(t,!0).update(n)[e]()}},\u02750=createOutputMethod,createMethod=function(e){var t=createOutputMethod("hex",e);NODE_JS&&(t=nodeWrap(t,e)),t.create=function(){return new Sha256(e)},t.update=function(e){return t.create().update(e)};for(var n=0;n<OUTPUT_TYPES.length;++n){var r=OUTPUT_TYPES[n];t[r]=createOutputMethod(r,e)}return t},\u02751=createMethod,nodeWrap=function nodeWrap(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod},\u02752=nodeWrap,createHmacOutputMethod=function(e,t){return function(n,r){return new HmacSha256(n,t,!0).update(r)[e]()}},\u02753=createHmacOutputMethod,createHmacMethod=function(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e)},t.update=function(e,n){return t.create(e).update(n)};for(var n=0;n<OUTPUT_TYPES.length;++n){var r=OUTPUT_TYPES[n];t[r]=createHmacOutputMethod(r,e)}return t},\u02754=createHmacMethod;function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function HmacSha256(e,t,n){var r,i=typeof e;if("string"===i){var o,a=[],s=e.length,c=0;for(r=0;r<s;++r)(o=e.charCodeAt(r))<128?a[c++]=o:o<2048?(a[c++]=192|o>>6,a[c++]=128|63&o):o<55296||o>=57344?(a[c++]=224|o>>12,a[c++]=128|o>>6&63,a[c++]=128|63&o):(o=65536+((1023&o)<<10|1023&e.charCodeAt(++r)),a[c++]=240|o>>18,a[c++]=128|o>>12&63,a[c++]=128|o>>6&63,a[c++]=128|63&o);e=a}else{if("object"!==i)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR)}e.length>64&&(e=new Sha256(t,!0).update(e).array());var l=[],u=[];for(r=0;r<64;++r){var d=e[r]||0;l[r]=92^d,u[r]=54^d}Sha256.call(this,t,n),this.update(u),this.oKeyPad=l,this.inner=!0,this.sharedMemory=n}Sha256.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!==n){if("object"!==n)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0}for(var r,i,o=0,a=e.length,s=this.blocks;o<a;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)for(i=this.start;o<a&&i<64;++o)s[i>>2]|=e[o]<<SHIFT[3&i++];else for(i=this.start;o<a&&i<64;++o)(r=e.charCodeAt(o))<128?s[i>>2]|=r<<SHIFT[3&i++]:r<2048?(s[i>>2]|=(192|r>>6)<<SHIFT[3&i++],s[i>>2]|=(128|63&r)<<SHIFT[3&i++]):r<55296||r>=57344?(s[i>>2]|=(224|r>>12)<<SHIFT[3&i++],s[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],s[i>>2]|=(128|63&r)<<SHIFT[3&i++]):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++o)),s[i>>2]|=(240|r>>18)<<SHIFT[3&i++],s[i>>2]|=(128|r>>12&63)<<SHIFT[3&i++],s[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],s[i>>2]|=(128|63&r)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=s[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var e,t,n,r,i,o,a=this.h0,s=this.h1,c=this.h2,l=this.h3,u=this.h4,d=this.h5,p=this.h6,h=this.h7,m=this.blocks;for(e=16;e<64;++e)m[e]=m[e-16]+(((t=m[e-15])>>>7|t<<25)^(t>>>18|t<<14)^t>>>3)+m[e-7]+(((t=m[e-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)<<0;for(o=s&c,e=0;e<64;e+=4)this.first?(this.is224?(n=300032,h=(t=m[0]-1413257819)-150054599<<0,l=t+24177077<<0):(n=704751109,h=(t=m[0]-210244248)-1521486534<<0,l=t+143694565<<0),this.first=!1):(h=l+(t=h+((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&d^~u&p)+K[e]+m[e])<<0,l=t+(((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+((n=a&s)^a&c^o))<<0),p=c+(t=p+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&u^~h&d)+K[e+1]+m[e+1])<<0,c=t+(((l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10))+((r=l&a)^l&s^n))<<0,d=s+(t=d+((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&h^~p&u)+K[e+2]+m[e+2])<<0,s=t+(((c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10))+((i=c&l)^c&a^r))<<0,u=a+(t=u+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(d&p^~d&h)+K[e+3]+m[e+3])<<0,a=t+(((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+((o=s&c)^s&l^i))<<0;this.h0=this.h0+a<<0,this.h1=this.h1+s<<0,this.h2=this.h2+c<<0,this.h3=this.h3+l<<0,this.h4=this.h4+u<<0,this.h5=this.h5+d<<0,this.h6=this.h6+p<<0,this.h7=this.h7+h<<0},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,i=this.h4,o=this.h5,a=this.h6,s=this.h7,c=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a];return this.is224||(c+=HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]),c},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,i=this.h4,o=this.h5,a=this.h6,s=this.h7,c=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,r>>24&255,r>>16&255,r>>8&255,255&r,i>>24&255,i>>16&255,i>>8&255,255&i,o>>24&255,o>>16&255,o>>8&255,255&o,a>>24&255,a>>16&255,a>>8&255,255&a];return this.is224||c.push(s>>24&255,s>>16&255,s>>8&255,255&s),c},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0);var HashHandler=function e(){_classCallCheck(this,e)},DefaultHashHandler=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"calcHash",value:function(e,t){return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.b)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=exports.array(e),t.abrupt("return",this.toHashString2(n));case 2:case"end":return t.stop()}},t,this)}))}},{key:"toHashString2",value:function(e){var t,n="",r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=String.fromCharCode(i)}}catch(err){r.e(err)}finally{r.f()}return n}},{key:"toHashString",value:function(e){var t,n="",r=_createForOfIteratorHelper(new Uint8Array(e));try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=String.fromCharCode(i)}}catch(err){r.e(err)}finally{r.f()}return n}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}(),OAuthService=function(){var e=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a,s,c,l,u){var d,p;_classCallCheck(this,n),(d=t.call(this)).ngZone=e,d.http=r,d.config=a,d.urlHelper=s,d.logger=c,d.crypto=l,d.discoveryDocumentLoaded=!1,d.state="",d.eventsSubject=new rxjs__WEBPACK_IMPORTED_MODULE_4__.a,d.discoveryDocumentLoadedSubject=new rxjs__WEBPACK_IMPORTED_MODULE_4__.a,d.grantTypesSupported=[],d.inImplicitFlow=!1,d.saveNoncesInLocalStorage=!1,d.debug("angular-oauth2-oidc v10"),d.document=u,a||(a={}),d.discoveryDocumentLoaded$=d.discoveryDocumentLoadedSubject.asObservable(),d.events=d.eventsSubject.asObservable(),o&&(d.tokenValidationHandler=o),a&&d.configure(a);try{i?d.setStorage(i):"undefined"!=typeof sessionStorage&&d.setStorage(sessionStorage)}catch(m){console.error("No OAuthStorage provided and cannot access default (sessionStorage).Consider providing a custom OAuthStorage implementation in your module.",m)}if("undefined"!=typeof window&&void 0!==window.localStorage){var h=null===(p=null===window||void 0===window?void 0:window.navigator)||void 0===p?void 0:p.userAgent;((null==h?void 0:h.includes("MSIE "))||(null==h?void 0:h.includes("Trident")))&&(d.saveNoncesInLocalStorage=!0)}return d.setupRefreshTimer(),d}return _createClass(n,[{key:"configure",value:function(e){Object.assign(this,new AuthConfig,e),this.config=Object.assign({},new AuthConfig,e),this.sessionChecksEnabled&&this.setupSessionCheck(),this.configChanged()}},{key:"configChanged",value:function(){this.setupRefreshTimer()}},{key:"restartSessionChecksIfStillLoggedIn",value:function(){this.hasValidIdToken()&&this.initSessionCheck()}},{key:"restartRefreshTimerIfStillLoggedIn",value:function(){this.setupExpirationTimers()}},{key:"setupSessionCheck",value:function(){var e=this;this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(function(e){return"token_received"===e.type})).subscribe(function(t){e.initSessionCheck()})}},{key:"setupAutomaticSilentRefresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!0;this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.a)(function(e){"token_received"===e.type?i=!0:"logout"===e.type&&(i=!1)}),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(function(e){return"token_expires"===e.type}),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.a)(1e3)).subscribe(function(o){null!=n&&"any"!==n&&o.info!==n||!i||e.refreshInternal(t,r).catch(function(t){e.debug("Automatic silent refresh did not work")})}),this.restartRefreshTimerIfStillLoggedIn()}},{key:"refreshInternal",value:function(e,t){return this.useSilentRefresh||"code"!==this.responseType?this.silentRefresh(e,t):this.refreshToken()}},{key:"loadDiscoveryDocumentAndTryLogin",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.loadDiscoveryDocument().then(function(n){return e.tryLogin(t)})}},{key:"loadDiscoveryDocumentAndLogin",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.loadDiscoveryDocumentAndTryLogin(t=t||{}).then(function(n){return!(!e.hasValidIdToken()||!e.hasValidAccessToken())||(e.initLoginFlow("string"==typeof t.state?t.state:""),!1)})}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showDebugInformation&&this.logger.debug.apply(this.logger,t)}},{key:"validateUrlFromDiscoveryDocument",value:function(e){var t=[],n=this.validateUrlForHttps(e),r=this.validateUrlAgainstIssuer(e);return n||t.push("https for all urls required. Also for urls received by discovery."),r||t.push("Every url in discovery document has to start with the issuer url.Also see property strictDiscoveryDocumentValidation."),t}},{key:"validateUrlForHttps",value:function(e){if(!e)return!0;var t=e.toLowerCase();return!1===this.requireHttps||!(!t.match(/^http:\/\/localhost($|[:\/])/)&&!t.match(/^http:\/\/localhost($|[:\/])/)||"remoteOnly"!==this.requireHttps)||t.startsWith("https://")}},{key:"assertUrlNotNullAndCorrectProtocol",value:function(e,t){if(!e)throw new Error("'".concat(t,"' should not be null"));if(!this.validateUrlForHttps(e))throw new Error("'".concat(t,"' must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS)."))}},{key:"validateUrlAgainstIssuer",value:function(e){return!this.strictDiscoveryDocumentValidation||!e||e.toLowerCase().startsWith(this.issuer.toLowerCase())}},{key:"setupRefreshTimer",value:function(){var e=this;"undefined"!=typeof window?((this.hasValidIdToken()||this.hasValidAccessToken())&&(this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.setupExpirationTimers()),this.tokenReceivedSubscription&&this.tokenReceivedSubscription.unsubscribe(),this.tokenReceivedSubscription=this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(function(e){return"token_received"===e.type})).subscribe(function(t){e.clearAccessTokenTimer(),e.clearIdTokenTimer(),e.setupExpirationTimers()})):this.debug("timer not supported on this plattform")}},{key:"setupExpirationTimers",value:function(){this.hasValidAccessToken()&&this.setupAccessTokenTimer(),this.hasValidIdToken()&&this.setupIdTokenTimer()}},{key:"setupAccessTokenTimer",value:function(){var e=this,t=this.getAccessTokenExpiration(),n=this.getAccessTokenStoredAt(),r=this.calcTimeout(n,t);this.ngZone.runOutsideAngular(function(){e.accessTokenTimeoutSubscription=Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(new OAuthInfoEvent("token_expires","access_token")).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.a)(r)).subscribe(function(t){e.ngZone.run(function(){e.eventsSubject.next(t)})})})}},{key:"setupIdTokenTimer",value:function(){var e=this,t=this.getIdTokenExpiration(),n=this.getIdTokenStoredAt(),r=this.calcTimeout(n,t);this.ngZone.runOutsideAngular(function(){e.idTokenTimeoutSubscription=Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(new OAuthInfoEvent("token_expires","id_token")).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.a)(r)).subscribe(function(t){e.ngZone.run(function(){e.eventsSubject.next(t)})})})}},{key:"stopAutomaticRefresh",value:function(){this.clearAccessTokenTimer(),this.clearIdTokenTimer()}},{key:"clearAccessTokenTimer",value:function(){this.accessTokenTimeoutSubscription&&this.accessTokenTimeoutSubscription.unsubscribe()}},{key:"clearIdTokenTimer",value:function(){this.idTokenTimeoutSubscription&&this.idTokenTimeoutSubscription.unsubscribe()}},{key:"calcTimeout",value:function(e,t){var n=Date.now();return Math.max(0,(t-e)*this.timeoutFactor-(n-e))}},{key:"setStorage",value:function(e){this._storage=e,this.configChanged()}},{key:"loadDiscoveryDocument",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise(function(n,r){t||((t=e.issuer||"").endsWith("/")||(t+="/"),t+=".well-known/openid-configuration"),e.validateUrlForHttps(t)?e.http.get(t).subscribe(function(t){if(!e.validateDiscoveryDocument(t))return e.eventsSubject.next(new OAuthErrorEvent("discovery_document_validation_error",null)),void r("discovery_document_validation_error");e.loginUrl=t.authorization_endpoint,e.logoutUrl=t.end_session_endpoint||e.logoutUrl,e.grantTypesSupported=t.grant_types_supported,e.issuer=t.issuer,e.tokenEndpoint=t.token_endpoint,e.userinfoEndpoint=t.userinfo_endpoint||e.userinfoEndpoint,e.jwksUri=t.jwks_uri,e.sessionCheckIFrameUrl=t.check_session_iframe||e.sessionCheckIFrameUrl,e.discoveryDocumentLoaded=!0,e.discoveryDocumentLoadedSubject.next(t),e.revocationEndpoint=t.revocation_endpoint,e.sessionChecksEnabled&&e.restartSessionChecksIfStillLoggedIn(),e.loadJwks().then(function(r){var i=new OAuthSuccessEvent("discovery_document_loaded",{discoveryDocument:t,jwks:r});e.eventsSubject.next(i),n(i)}).catch(function(t){e.eventsSubject.next(new OAuthErrorEvent("discovery_document_load_error",t)),r(t)})},function(t){e.logger.error("error loading discovery document",t),e.eventsSubject.next(new OAuthErrorEvent("discovery_document_load_error",t)),r(t)}):r("issuer  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).")})}},{key:"loadJwks",value:function(){var e=this;return new Promise(function(t,n){e.jwksUri?e.http.get(e.jwksUri).subscribe(function(n){e.jwks=n,e.eventsSubject.next(new OAuthSuccessEvent("discovery_document_loaded")),t(n)},function(t){e.logger.error("error loading jwks",t),e.eventsSubject.next(new OAuthErrorEvent("jwks_load_error",t)),n(t)}):t(null)})}},{key:"validateDiscoveryDocument",value:function(e){var t;return this.skipIssuerCheck||e.issuer===this.issuer?(t=this.validateUrlFromDiscoveryDocument(e.authorization_endpoint)).length>0?(this.logger.error("error validating authorization_endpoint in discovery document",t),!1):(t=this.validateUrlFromDiscoveryDocument(e.end_session_endpoint)).length>0?(this.logger.error("error validating end_session_endpoint in discovery document",t),!1):((t=this.validateUrlFromDiscoveryDocument(e.token_endpoint)).length>0&&this.logger.error("error validating token_endpoint in discovery document",t),(t=this.validateUrlFromDiscoveryDocument(e.revocation_endpoint)).length>0&&this.logger.error("error validating revocation_endpoint in discovery document",t),(t=this.validateUrlFromDiscoveryDocument(e.userinfo_endpoint)).length>0?(this.logger.error("error validating userinfo_endpoint in discovery document",t),!1):(t=this.validateUrlFromDiscoveryDocument(e.jwks_uri)).length>0?(this.logger.error("error validating jwks_uri in discovery document",t),!1):(this.sessionChecksEnabled&&!e.check_session_iframe&&this.logger.warn("sessionChecksEnabled is activated but discovery document does not contain a check_session_iframe field"),!0)):(this.logger.error("invalid issuer in discovery document","expected: "+this.issuer,"current: "+e.issuer),!1)}},{key:"fetchTokenUsingPasswordFlowAndLoadUserProfile",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h;return this.fetchTokenUsingPasswordFlow(e,t,r).then(function(){return n.loadUserProfile()})}},{key:"loadUserProfile",value:function(){var e=this;if(!this.hasValidAccessToken())throw new Error("Can not load User Profile without access_token");if(!this.validateUrlForHttps(this.userinfoEndpoint))throw new Error("userinfoEndpoint must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");return new Promise(function(t,n){var r=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h).set("Authorization","Bearer "+e.getAccessToken());e.http.get(e.userinfoEndpoint,{headers:r}).subscribe(function(r){e.debug("userinfo received",r);var i=e.getIdentityClaims()||{};e.skipSubjectCheck||!e.oidc||i.sub&&r.sub===i.sub?(r=Object.assign({},i,r),e._storage.setItem("id_token_claims_obj",JSON.stringify(r)),e.eventsSubject.next(new OAuthSuccessEvent("user_profile_loaded")),t(r)):n("if property oidc is true, the received user-id (sub) has to be the user-id of the user that has logged in with oidc.\nif you are not using oidc but just oauth2 password flow set oidc to false")},function(t){e.logger.error("error loading user info",t),e.eventsSubject.next(new OAuthErrorEvent("user_profile_load_error",t)),n(t)})})}},{key:"fetchTokenUsingPasswordFlow",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h;return this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint"),new Promise(function(i,o){var a=new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.i({encoder:new WebHttpUrlEncodingCodec}).set("grant_type","password").set("scope",n.scope).set("username",e).set("password",t);if(n.useHttpBasicAuth){var s=btoa("".concat(n.clientId,":").concat(n.dummyClientSecret));r=r.set("Authorization","Basic "+s)}if(n.useHttpBasicAuth||(a=a.set("client_id",n.clientId)),!n.useHttpBasicAuth&&n.dummyClientSecret&&(a=a.set("client_secret",n.dummyClientSecret)),n.customQueryParams){var c,l=_createForOfIteratorHelper(Object.getOwnPropertyNames(n.customQueryParams));try{for(l.s();!(c=l.n()).done;){var u=c.value;a=a.set(u,n.customQueryParams[u])}}catch(err){l.e(err)}finally{l.f()}}r=r.set("Content-Type","application/x-www-form-urlencoded"),n.http.post(n.tokenEndpoint,a,{headers:r}).subscribe(function(e){n.debug("tokenResponse",e),n.storeAccessTokenResponse(e.access_token,e.refresh_token,e.expires_in||n.fallbackAccessTokenExpirationTimeInSec,e.scope,n.extractRecognizedCustomParameters(e)),n.eventsSubject.next(new OAuthSuccessEvent("token_received")),i(e)},function(e){n.logger.error("Error performing password flow",e),n.eventsSubject.next(new OAuthErrorEvent("token_error",e)),o(e)})})}},{key:"refreshToken",value:function(){var e=this;return this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint"),new Promise(function(t,n){var r=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.i).set("grant_type","refresh_token").set("scope",e.scope).set("refresh_token",e._storage.getItem("refresh_token")),i=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h).set("Content-Type","application/x-www-form-urlencoded");if(e.useHttpBasicAuth){var o=btoa("".concat(e.clientId,":").concat(e.dummyClientSecret));i=i.set("Authorization","Basic "+o)}if(e.useHttpBasicAuth||(r=r.set("client_id",e.clientId)),!e.useHttpBasicAuth&&e.dummyClientSecret&&(r=r.set("client_secret",e.dummyClientSecret)),e.customQueryParams){var a,s=_createForOfIteratorHelper(Object.getOwnPropertyNames(e.customQueryParams));try{for(s.s();!(a=s.n()).done;){var c=a.value;r=r.set(c,e.customQueryParams[c])}}catch(err){s.e(err)}finally{s.f()}}e.http.post(e.tokenEndpoint,r,{headers:i}).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.a)(function(t){return t.id_token?Object(rxjs__WEBPACK_IMPORTED_MODULE_6__.a)(e.processIdToken(t.id_token,t.access_token,!0)).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.a)(function(t){return e.storeIdToken(t)}),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_16__.a)(function(e){return t})):Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(t)})).subscribe(function(n){e.debug("refresh tokenResponse",n),e.storeAccessTokenResponse(n.access_token,n.refresh_token,n.expires_in||e.fallbackAccessTokenExpirationTimeInSec,n.scope,e.extractRecognizedCustomParameters(n)),e.eventsSubject.next(new OAuthSuccessEvent("token_received")),e.eventsSubject.next(new OAuthSuccessEvent("token_refreshed")),t(n)},function(t){e.logger.error("Error refreshing token",t),e.eventsSubject.next(new OAuthErrorEvent("token_refresh_error",t)),n(t)})})}},{key:"removeSilentRefreshEventListener",value:function(){this.silentRefreshPostMessageEventListener&&(window.removeEventListener("message",this.silentRefreshPostMessageEventListener),this.silentRefreshPostMessageEventListener=null)}},{key:"setupSilentRefreshEventListener",value:function(){var e=this;this.removeSilentRefreshEventListener(),this.silentRefreshPostMessageEventListener=function(t){var n=e.processMessageEventMessage(t);e.tryLogin({customHashFragment:n,preventClearHashAfterLogin:!0,customRedirectUri:e.silentRefreshRedirectUri||e.redirectUri}).catch(function(t){return e.debug("tryLogin during silent refresh failed",t)})},window.addEventListener("message",this.silentRefreshPostMessageEventListener)}},{key:"silentRefresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.getIdentityClaims()||{};if(this.useIdTokenHintForSilentRefresh&&this.hasValidIdToken()&&(t.id_token_hint=this.getIdToken()),!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(void 0===this.document)throw new Error("silent refresh is not supported on this platform");var i=this.document.getElementById(this.silentRefreshIFrameName);i&&this.document.body.removeChild(i),this.silentRefreshSubject=r.sub;var o=this.document.createElement("iframe");o.id=this.silentRefreshIFrameName,this.setupSilentRefreshEventListener(),this.createLoginUrl(null,null,this.silentRefreshRedirectUri||this.redirectUri,n,t).then(function(t){o.setAttribute("src",t),e.silentRefreshShowIFrame||(o.style.display="none"),e.document.body.appendChild(o)});var a=this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(function(e){return e instanceof OAuthErrorEvent}),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.a)()),s=this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(function(e){return"token_received"===e.type}),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.a)()),c=Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(new OAuthErrorEvent("silent_refresh_timeout",null)).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_14__.a)(this.silentRefreshTimeout));return Object(rxjs__WEBPACK_IMPORTED_MODULE_7__.a)([a,s,c]).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_16__.a)(function(t){if(t instanceof OAuthErrorEvent)throw"silent_refresh_timeout"===t.type||(t=new OAuthErrorEvent("silent_refresh_error",t)),e.eventsSubject.next(t),t;return"token_received"===t.type&&(t=new OAuthSuccessEvent("silently_refreshed"),e.eventsSubject.next(t)),t})).toPromise()}},{key:"initImplicitFlowInPopup",value:function(e){return this.initLoginFlowInPopup(e)}},{key:"initLoginFlowInPopup",value:function(e){var t=this;return e=e||{},this.createLoginUrl(null,null,this.silentRefreshRedirectUri,!1,{display:"popup"}).then(function(n){return new Promise(function(r,i){var o,a=window.open(n,"_blank",t.calculatePopupFeatures(e));a?o=window.setInterval(function(){a&&!a.closed||(s(),i(new OAuthErrorEvent("popup_closed",{})))},500):i(new OAuthErrorEvent("popup_blocked",{}));var s=function(){window.clearInterval(o),window.removeEventListener("message",c),null!==a&&a.close(),a=null},c=function(e){var n=t.processMessageEventMessage(e);n&&null!==n?t.tryLogin({customHashFragment:n,preventClearHashAfterLogin:!0,customRedirectUri:t.silentRefreshRedirectUri}).then(function(){s(),r()},function(e){s(),i(e)}):console.log("false event firing")};window.addEventListener("message",c)})})}},{key:"calculatePopupFeatures",value:function(e){var t=e.height||470,n=e.width||500,r=window.screenLeft+(window.outerWidth-n)/2;return"location=no,toolbar=no,width=".concat(n,",height=").concat(t,",top=").concat(window.screenTop+(window.outerHeight-t)/2,",left=").concat(r)}},{key:"processMessageEventMessage",value:function(e){var t="#";if(this.silentRefreshMessagePrefix&&(t+=this.silentRefreshMessagePrefix),e&&e.data&&"string"==typeof e.data){var n=e.data;return n.startsWith(t)?"#"+n.substr(t.length):void 0}}},{key:"canPerformSessionCheck",value:function(){return!!this.sessionChecksEnabled&&(this.sessionCheckIFrameUrl?this.getSessionState()?void 0!==this.document:(console.warn("sessionChecksEnabled is activated but there is no session_state"),!1):(console.warn("sessionChecksEnabled is activated but there is no sessionCheckIFrameUrl"),!1))}},{key:"setupSessionCheckEventListener",value:function(){var e=this;this.removeSessionCheckEventListener(),this.sessionCheckEventListener=function(t){var n=t.origin.toLowerCase(),r=e.issuer.toLowerCase();if(e.debug("sessionCheckEventListener"),r.startsWith(n)){switch(t.data){case"unchanged":e.handleSessionUnchanged();break;case"changed":e.ngZone.run(function(){e.handleSessionChange()});break;case"error":e.ngZone.run(function(){e.handleSessionError()})}e.debug("got info from session check inframe",t)}else e.debug("sessionCheckEventListener","wrong origin",n,"expected",r,"event",t)},this.ngZone.runOutsideAngular(function(){window.addEventListener("message",e.sessionCheckEventListener)})}},{key:"handleSessionUnchanged",value:function(){this.debug("session check","session unchanged")}},{key:"handleSessionChange",value:function(){var e=this;this.eventsSubject.next(new OAuthInfoEvent("session_changed")),this.stopSessionCheckTimer(),this.useSilentRefresh||"code"!==this.responseType?this.silentRefreshRedirectUri?(this.silentRefresh().catch(function(t){return e.debug("silent refresh failed after session changed")}),this.waitForSilentRefreshAfterSessionChange()):(this.eventsSubject.next(new OAuthInfoEvent("session_terminated")),this.logOut(!0)):this.refreshToken().then(function(t){e.debug("token refresh after session change worked")}).catch(function(t){e.debug("token refresh did not work after session changed"),e.eventsSubject.next(new OAuthInfoEvent("session_terminated")),e.logOut(!0)})}},{key:"waitForSilentRefreshAfterSessionChange",value:function(){var e=this;this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(function(e){return"silently_refreshed"===e.type||"silent_refresh_timeout"===e.type||"silent_refresh_error"===e.type}),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_17__.a)()).subscribe(function(t){"silently_refreshed"!==t.type&&(e.debug("silent refresh did not work after session changed"),e.eventsSubject.next(new OAuthInfoEvent("session_terminated")),e.logOut(!0))})}},{key:"handleSessionError",value:function(){this.stopSessionCheckTimer(),this.eventsSubject.next(new OAuthInfoEvent("session_error"))}},{key:"removeSessionCheckEventListener",value:function(){this.sessionCheckEventListener&&(window.removeEventListener("message",this.sessionCheckEventListener),this.sessionCheckEventListener=null)}},{key:"initSessionCheck",value:function(){if(this.canPerformSessionCheck()){var e=this.document.getElementById(this.sessionCheckIFrameName);e&&this.document.body.removeChild(e);var t=this.document.createElement("iframe");t.id=this.sessionCheckIFrameName,this.setupSessionCheckEventListener(),t.setAttribute("src",this.sessionCheckIFrameUrl),t.style.display="none",this.document.body.appendChild(t),this.startSessionCheckTimer()}}},{key:"startSessionCheckTimer",value:function(){var e=this;this.stopSessionCheckTimer(),this.ngZone.runOutsideAngular(function(){e.sessionCheckTimer=setInterval(e.checkSession.bind(e),e.sessionCheckIntervall)})}},{key:"stopSessionCheckTimer",value:function(){this.sessionCheckTimer&&(clearInterval(this.sessionCheckTimer),this.sessionCheckTimer=null)}},{key:"checkSession",value:function(){var e=this.document.getElementById(this.sessionCheckIFrameName);e||this.logger.warn("checkSession did not find iframe",this.sessionCheckIFrameName);var t=this.getSessionState();t||this.stopSessionCheckTimer(),e.contentWindow.postMessage(this.clientId+" "+t,this.issuer)}},{key:"createLoginUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.b)(this,void 0,void 0,regeneratorRuntime.mark(function o(){var a,s,c,l,u,d,p,h,m,g,f,v,y,_,S;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a=n||this.redirectUri,o.next=3,this.createAndSaveNonce();case 3:if(s=o.sent,e=e?s+this.config.nonceStateSeparator+encodeURIComponent(e):s,this.requestAccessToken||this.oidc){o.next=6;break}throw new Error("Either requestAccessToken or oidc or both must be true");case 6:if(this.responseType=this.config.responseType?this.config.responseType:this.oidc&&this.requestAccessToken?"id_token token":this.oidc&&!this.requestAccessToken?"id_token":"token",c=this.loginUrl.indexOf("?")>-1?"&":"?",l=this.scope,this.oidc&&!l.match(/(^|\s)openid($|\s)/)&&(l="openid "+l),u=this.loginUrl+c+"response_type="+encodeURIComponent(this.responseType)+"&client_id="+encodeURIComponent(this.clientId)+"&state="+encodeURIComponent(e)+"&redirect_uri="+encodeURIComponent(a)+"&scope="+encodeURIComponent(l),!this.responseType.includes("code")||this.disablePKCE){o.next=19;break}return o.next=14,this.createChallangeVerifierPairForPKCE();case 14:d=o.sent,p=_slicedToArray(d,2),h=p[0],m=p[1],this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.setItem("PKCE_verifier",m):this._storage.setItem("PKCE_verifier",m),u+="&code_challenge="+h,u+="&code_challenge_method=S256";case 19:for(t&&(u+="&login_hint="+encodeURIComponent(t)),this.resource&&(u+="&resource="+encodeURIComponent(this.resource)),this.oidc&&(u+="&nonce="+encodeURIComponent(s)),r&&(u+="&prompt=none"),g=0,f=Object.keys(i);g<f.length;g++)v=f[g],u+="&"+encodeURIComponent(v)+"="+encodeURIComponent(i[v]);if(this.customQueryParams){y=_createForOfIteratorHelper(Object.getOwnPropertyNames(this.customQueryParams));try{for(y.s();!(_=y.n()).done;)S=_.value,u+="&"+S+"="+encodeURIComponent(this.customQueryParams[S])}catch(err){y.e(err)}finally{y.f()}}return o.abrupt("return",u);case 23:case"end":return o.stop()}},o,this)}))}},{key:"initImplicitFlowInternal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!this.inImplicitFlow){if(this.inImplicitFlow=!0,!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");var r={},i=null;"string"==typeof n?i=n:"object"==typeof n&&(r=n),this.createLoginUrl(t,i,null,!1,r).then(this.config.openUri).catch(function(t){console.error("Error in initImplicitFlow",t),e.inImplicitFlow=!1})}}},{key:"initImplicitFlow",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";""!==this.loginUrl?this.initImplicitFlowInternal(t,n):this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(function(e){return"discovery_document_loaded"===e.type})).subscribe(function(r){return e.initImplicitFlowInternal(t,n)})}},{key:"resetImplicitFlow",value:function(){this.inImplicitFlow=!1}},{key:"callOnTokenReceivedIfExists",value:function(e){var t=this;if(e.onTokenReceived){var n={idClaims:t.getIdentityClaims(),idToken:t.getIdToken(),accessToken:t.getAccessToken(),state:t.state};e.onTokenReceived(n)}}},{key:"storeAccessTokenResponse",value:function(e,t,n,r,i){var o=this;if(this._storage.setItem("access_token",e),r&&!Array.isArray(r)?this._storage.setItem("granted_scopes",JSON.stringify(r.split("+"))):r&&Array.isArray(r)&&this._storage.setItem("granted_scopes",JSON.stringify(r)),this._storage.setItem("access_token_stored_at",""+Date.now()),n){var a=1e3*n,s=(new Date).getTime()+a;this._storage.setItem("expires_at",""+s)}t&&this._storage.setItem("refresh_token",t),i&&i.forEach(function(e,t){o._storage.setItem(t,e)})}},{key:"tryLogin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return"code"===this.config.responseType?this.tryLoginCodeFlow(e).then(function(e){return!0}):this.tryLoginImplicitFlow(e)}},{key:"parseQueryString",value:function(e){return e&&0!==e.length?("?"===e.charAt(0)&&(e=e.substr(1)),this.urlHelper.parseQueryString(e)):{}}},{key:"tryLoginCodeFlow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=(e=e||{}).customHashFragment?e.customHashFragment.substring(1):window.location.search,n=this.getCodePartsFromUrl(t),r=n.code,i=n.state,o=n.session_state;if(!e.preventClearHashAfterLogin){var a=location.href.replace(/[&\?]code=[^&\$]*/,"").replace(/[&\?]scope=[^&\$]*/,"").replace(/[&\?]state=[^&\$]*/,"").replace(/[&\?]session_state=[^&\$]*/,"");history.replaceState(null,window.name,a)}var s=this.parseState(i),c=_slicedToArray(s,2),l=c[0],u=c[1];if(this.state=u,n.error){this.debug("error trying to login"),this.handleLoginError({},n);var d=new OAuthErrorEvent("code_error",{},n);return this.eventsSubject.next(d),Promise.reject(d)}if(!l)return Promise.resolve();if(!this.validateNonce(l)){var p=new OAuthErrorEvent("invalid_nonce_in_state",null);return this.eventsSubject.next(p),Promise.reject(p)}return this.storeSessionState(o),r?this.getTokenFromCode(r,e).then(function(e){return null}):Promise.resolve()}},{key:"getCodePartsFromUrl",value:function(e){return e&&0!==e.length?("?"===e.charAt(0)&&(e=e.substr(1)),this.urlHelper.parseQueryString(e)):this.urlHelper.getHashFragmentParams()}},{key:"getTokenFromCode",value:function(e,t){var n,r=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.i).set("grant_type","authorization_code").set("code",e).set("redirect_uri",t.customRedirectUri||this.redirectUri);this.disablePKCE||((n=this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.getItem("PKCE_verifier"):this._storage.getItem("PKCE_verifier"))?r=r.set("code_verifier",n):console.warn("No PKCE verifier found in oauth storage!"));return this.fetchAndProcessToken(r)}},{key:"fetchAndProcessToken",value:function(e){var t=this;this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint");var n=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){var r=btoa("".concat(this.clientId,":").concat(this.dummyClientSecret));n=n.set("Authorization","Basic "+r)}return this.useHttpBasicAuth||(e=e.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(e=e.set("client_secret",this.dummyClientSecret)),new Promise(function(r,i){if(t.customQueryParams){var o,a=_createForOfIteratorHelper(Object.getOwnPropertyNames(t.customQueryParams));try{for(a.s();!(o=a.n()).done;){var s=o.value;e=e.set(s,t.customQueryParams[s])}}catch(err){a.e(err)}finally{a.f()}}t.http.post(t.tokenEndpoint,e,{headers:n}).subscribe(function(e){t.debug("refresh tokenResponse",e),t.storeAccessTokenResponse(e.access_token,e.refresh_token,e.expires_in||t.fallbackAccessTokenExpirationTimeInSec,e.scope,t.extractRecognizedCustomParameters(e)),t.oidc&&e.id_token?t.processIdToken(e.id_token,e.access_token).then(function(n){t.storeIdToken(n),t.eventsSubject.next(new OAuthSuccessEvent("token_received")),t.eventsSubject.next(new OAuthSuccessEvent("token_refreshed")),r(e)}).catch(function(e){t.eventsSubject.next(new OAuthErrorEvent("token_validation_error",e)),console.error("Error validating tokens"),console.error(e),i(e)}):(t.eventsSubject.next(new OAuthSuccessEvent("token_received")),t.eventsSubject.next(new OAuthSuccessEvent("token_refreshed")),r(e))},function(e){console.error("Error getting token",e),t.eventsSubject.next(new OAuthErrorEvent("token_refresh_error",e)),i(e)})})}},{key:"tryLoginImplicitFlow",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=(n=n||{}).customHashFragment?this.urlHelper.getHashFragmentParams(n.customHashFragment):this.urlHelper.getHashFragmentParams(),this.debug("parsed url",e);var r=e.state,i=this.parseState(r),o=_slicedToArray(i,2),a=o[0],s=o[1];if(this.state=s,e.error){this.debug("error trying to login"),this.handleLoginError(n,e);var c=new OAuthErrorEvent("token_error",{},e);return this.eventsSubject.next(c),Promise.reject(c)}var l=e.access_token,u=e.id_token,d=e.session_state,p=e.scope;if(!this.requestAccessToken&&!this.oidc)return Promise.reject("Either requestAccessToken or oidc (or both) must be true.");if(this.requestAccessToken&&!l)return Promise.resolve(!1);if(this.requestAccessToken&&!n.disableOAuth2StateCheck&&!r)return Promise.resolve(!1);if(this.oidc&&!u)return Promise.resolve(!1);if(this.sessionChecksEnabled&&!d&&this.logger.warn("session checks (Session Status Change Notification) were activated in the configuration but the id_token does not contain a session_state claim"),this.requestAccessToken&&!n.disableOAuth2StateCheck&&!this.validateNonce(a)){var h=new OAuthErrorEvent("invalid_nonce_in_state",null);return this.eventsSubject.next(h),Promise.reject(h)}return this.requestAccessToken&&this.storeAccessTokenResponse(l,null,e.expires_in||this.fallbackAccessTokenExpirationTimeInSec,p),this.oidc?this.processIdToken(u,l).then(function(e){return n.validationHandler?n.validationHandler({accessToken:l,idClaims:e.idTokenClaims,idToken:e.idToken,state:r}).then(function(t){return e}):e}).then(function(e){return t.storeIdToken(e),t.storeSessionState(d),t.clearHashAfterLogin&&!n.preventClearHashAfterLogin&&(location.hash=""),t.eventsSubject.next(new OAuthSuccessEvent("token_received")),t.callOnTokenReceivedIfExists(n),t.inImplicitFlow=!1,!0}).catch(function(e){return t.eventsSubject.next(new OAuthErrorEvent("token_validation_error",e)),t.logger.error("Error validating tokens"),t.logger.error(e),Promise.reject(e)}):(this.eventsSubject.next(new OAuthSuccessEvent("token_received")),this.clearHashAfterLogin&&!n.preventClearHashAfterLogin&&(location.hash=""),this.callOnTokenReceivedIfExists(n),Promise.resolve(!0))}},{key:"parseState",value:function(e){var t=e,n="";if(e){var r=e.indexOf(this.config.nonceStateSeparator);r>-1&&(t=e.substr(0,r),n=e.substr(r+this.config.nonceStateSeparator.length))}return[t,n]}},{key:"validateNonce",value:function(e){var t;return(t=this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.getItem("nonce"):this._storage.getItem("nonce"))===e||(console.error("Validating access_token failed, wrong state/nonce.",t,e),!1)}},{key:"storeIdToken",value:function(e){this._storage.setItem("id_token",e.idToken),this._storage.setItem("id_token_claims_obj",e.idTokenClaimsJson),this._storage.setItem("id_token_expires_at",""+e.idTokenExpiresAt),this._storage.setItem("id_token_stored_at",""+Date.now())}},{key:"storeSessionState",value:function(e){this._storage.setItem("session_state",e)}},{key:"getSessionState",value:function(){return this._storage.getItem("session_state")}},{key:"handleLoginError",value:function(e,t){e.onLoginError&&e.onLoginError(t),this.clearHashAfterLogin&&!e.preventClearHashAfterLogin&&(location.hash="")}},{key:"processIdToken",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.split("."),a=b64DecodeUnicode(this.padBase64(o[0])),s=JSON.parse(a),c=b64DecodeUnicode(this.padBase64(o[1])),l=JSON.parse(c);if(n=this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.getItem("nonce"):this._storage.getItem("nonce"),Array.isArray(l.aud)){if(l.aud.every(function(e){return e!==r.clientId})){var u="Wrong audience: "+l.aud.join(",");return this.logger.warn(u),Promise.reject(u)}}else if(l.aud!==this.clientId){var d="Wrong audience: "+l.aud;return this.logger.warn(d),Promise.reject(d)}if(!l.sub){var p="No sub claim in id_token";return this.logger.warn(p),Promise.reject(p)}if(this.sessionChecksEnabled&&this.silentRefreshSubject&&this.silentRefreshSubject!==l.sub){var h="After refreshing, we got an id_token for another user (sub). Expected sub: ".concat(this.silentRefreshSubject,", received sub: ").concat(l.sub);return this.logger.warn(h),Promise.reject(h)}if(!l.iat){var m="No iat claim in id_token";return this.logger.warn(m),Promise.reject(m)}if(!this.skipIssuerCheck&&l.iss!==this.issuer){var g="Wrong issuer: "+l.iss;return this.logger.warn(g),Promise.reject(g)}if(!i&&l.nonce!==n){var f="Wrong nonce: "+l.nonce;return this.logger.warn(f),Promise.reject(f)}if(!this.hasOwnProperty("responseType")||"code"!==this.responseType&&"id_token"!==this.responseType||(this.disableAtHashCheck=!0),!this.disableAtHashCheck&&this.requestAccessToken&&!l.at_hash){var v="An at_hash is needed!";return this.logger.warn(v),Promise.reject(v)}var y=Date.now(),_=1e3*l.iat,S=1e3*l.exp,E=1e3*(this.clockSkewInSec||600);if(_-E>=y||S+E<=y){var b="Token has expired";return console.error(b),console.error({now:y,issuedAtMSec:_,expiresAtMSec:S}),Promise.reject(b)}var I={accessToken:t,idToken:e,jwks:this.jwks,idTokenClaims:l,idTokenHeader:s,loadKeys:function(){return r.loadJwks()}};return this.disableAtHashCheck?this.checkSignature(I).then(function(t){return{idToken:e,idTokenClaims:l,idTokenClaimsJson:c,idTokenHeader:s,idTokenHeaderJson:a,idTokenExpiresAt:S}}):this.checkAtHash(I).then(function(t){if(!r.disableAtHashCheck&&r.requestAccessToken&&!t){var n="Wrong at_hash";return r.logger.warn(n),Promise.reject(n)}return r.checkSignature(I).then(function(t){var n={idToken:e,idTokenClaims:l,idTokenClaimsJson:c,idTokenHeader:s,idTokenHeaderJson:a,idTokenExpiresAt:S};return r.disableAtHashCheck?n:r.checkAtHash(I).then(function(e){if(r.requestAccessToken&&!e){var t="Wrong at_hash";return r.logger.warn(t),Promise.reject(t)}return n})})})}},{key:"getIdentityClaims",value:function(){var e=this._storage.getItem("id_token_claims_obj");return e?JSON.parse(e):null}},{key:"getGrantedScopes",value:function(){var e=this._storage.getItem("granted_scopes");return e?JSON.parse(e):null}},{key:"getIdToken",value:function(){return this._storage?this._storage.getItem("id_token"):null}},{key:"padBase64",value:function(e){for(;e.length%4!=0;)e+="=";return e}},{key:"getAccessToken",value:function(){return this._storage?this._storage.getItem("access_token"):null}},{key:"getRefreshToken",value:function(){return this._storage?this._storage.getItem("refresh_token"):null}},{key:"getAccessTokenExpiration",value:function(){return this._storage.getItem("expires_at")?parseInt(this._storage.getItem("expires_at"),10):null}},{key:"getAccessTokenStoredAt",value:function(){return parseInt(this._storage.getItem("access_token_stored_at"),10)}},{key:"getIdTokenStoredAt",value:function(){return parseInt(this._storage.getItem("id_token_stored_at"),10)}},{key:"getIdTokenExpiration",value:function(){return this._storage.getItem("id_token_expires_at")?parseInt(this._storage.getItem("id_token_expires_at"),10):null}},{key:"hasValidAccessToken",value:function(){if(this.getAccessToken()){var e=this._storage.getItem("expires_at"),t=new Date;return!(e&&parseInt(e,10)<t.getTime())}return!1}},{key:"hasValidIdToken",value:function(){if(this.getIdToken()){var e=this._storage.getItem("id_token_expires_at"),t=new Date;return!(e&&parseInt(e,10)<t.getTime())}return!1}},{key:"getCustomTokenResponseProperty",value:function(e){return this._storage&&this.config.customTokenParameters&&this.config.customTokenParameters.indexOf(e)>=0&&null!==this._storage.getItem(e)?JSON.parse(this._storage.getItem(e)):null}},{key:"authorizationHeader",value:function(){return"Bearer "+this.getAccessToken()}},{key:"logOut",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=!1;"boolean"==typeof t&&(r=t,t={});var i=this.getIdToken();if(this._storage.removeItem("access_token"),this._storage.removeItem("id_token"),this._storage.removeItem("refresh_token"),this.saveNoncesInLocalStorage?(localStorage.removeItem("nonce"),localStorage.removeItem("PKCE_verifier")):(this._storage.removeItem("nonce"),this._storage.removeItem("PKCE_verifier")),this._storage.removeItem("expires_at"),this._storage.removeItem("id_token_claims_obj"),this._storage.removeItem("id_token_expires_at"),this._storage.removeItem("id_token_stored_at"),this._storage.removeItem("access_token_stored_at"),this._storage.removeItem("granted_scopes"),this._storage.removeItem("session_state"),this.config.customTokenParameters&&this.config.customTokenParameters.forEach(function(t){return e._storage.removeItem(t)}),this.silentRefreshSubject=null,this.eventsSubject.next(new OAuthInfoEvent("logout")),this.logoutUrl&&!r&&(i||this.postLogoutRedirectUri)){var o;if(!this.validateUrlForHttps(this.logoutUrl))throw new Error("logoutUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(this.logoutUrl.indexOf("{{")>-1)o=this.logoutUrl.replace(/\{\{id_token\}\}/,i).replace(/\{\{client_id\}\}/,this.clientId);else{var a=new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.i;i&&(a=a.set("id_token_hint",i));var s=this.postLogoutRedirectUri||this.redirectUri;for(var c in s&&(a=a.set("post_logout_redirect_uri",s),n&&(a=a.set("state",n))),t)a=a.set(c,t[c]);o=this.logoutUrl+(this.logoutUrl.indexOf("?")>-1?"&":"?")+a.toString()}this.config.openUri(o)}}},{key:"createAndSaveNonce",value:function(){var e=this;return this.createNonce().then(function(t){return e.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.setItem("nonce",t):e._storage.setItem("nonce",t),t})}},{key:"ngOnDestroy",value:function(){this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.removeSilentRefreshEventListener();var e=this.document.getElementById(this.silentRefreshIFrameName);e&&e.remove(),this.stopSessionCheckTimer(),this.removeSessionCheckEventListener();var t=this.document.getElementById(this.sessionCheckIFrameName);t&&t.remove()}},{key:"createNonce",value:function(){var e=this;return new Promise(function(t){if(e.rngUrl)throw new Error("createNonce with rng-web-api has not been implemented so far");var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=45,i="",o="undefined"==typeof self?null:self.crypto||self.msCrypto;if(o){var a=new Uint8Array(r);o.getRandomValues(a),a.map||(a.map=Array.prototype.map),a=a.map(function(e){return n.charCodeAt(e%n.length)}),i=String.fromCharCode.apply(null,a)}else for(;0<r--;)i+=n[Math.random()*n.length|0];t(base64UrlEncode(i))})}},{key:"checkAtHash",value:function(e){return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.b)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.tokenValidationHandler?this.tokenValidationHandler.validateAtHash(e):(this.logger.warn("No tokenValidationHandler configured. Cannot check at_hash."),!0));case 1:case"end":return t.stop()}},t,this)}))}},{key:"checkSignature",value:function(e){return this.tokenValidationHandler?this.tokenValidationHandler.validateSignature(e):(this.logger.warn("No tokenValidationHandler configured. Cannot check signature."),Promise.resolve(null))}},{key:"initLoginFlow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"code"===this.responseType?this.initCodeFlow(e,t):this.initImplicitFlow(e,t)}},{key:"initCodeFlow",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};""!==this.loginUrl?this.initCodeFlowInternal(t,n):this.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(function(e){return"discovery_document_loaded"===e.type})).subscribe(function(r){return e.initCodeFlowInternal(t,n)})}},{key:"initCodeFlowInternal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");this.createLoginUrl(e,"",null,!1,t).then(this.config.openUri).catch(function(e){console.error("Error in initAuthorizationCodeFlow"),console.error(e)})}},{key:"createChallangeVerifierPairForPKCE",value:function(){return Object(tslib__WEBPACK_IMPORTED_MODULE_3__.b)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.crypto){e.next=2;break}throw new Error("PKCE support for code flow needs a CryptoHander. Did you import the OAuthModule using forRoot() ?");case 2:return e.next=4,this.createNonce();case 4:return t=e.sent,e.t0=base64UrlEncode,e.next=8,this.crypto.calcHash(t,"sha-256");case 8:return e.t1=e.sent,e.t2=(0,e.t0)(e.t1),e.t3=t,e.abrupt("return",[e.t2,e.t3]);case 12:case"end":return e.stop()}},e,this)}))}},{key:"extractRecognizedCustomParameters",value:function(e){var t=new Map;return this.config.customTokenParameters?(this.config.customTokenParameters.forEach(function(n){e[n]&&t.set(n,JSON.stringify(e[n]))}),t):t}},{key:"revokeTokenAndLogout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.revocationEndpoint,i=this.getAccessToken(),o=this.getRefreshToken();if(i){var a=new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.i,s=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.h).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){var c=btoa("".concat(this.clientId,":").concat(this.dummyClientSecret));s=s.set("Authorization","Basic "+c)}if(this.useHttpBasicAuth||(a=a.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(a=a.set("client_secret",this.dummyClientSecret)),this.customQueryParams){var l,u=_createForOfIteratorHelper(Object.getOwnPropertyNames(this.customQueryParams));try{for(u.s();!(l=u.n()).done;){var d=l.value;a=a.set(d,this.customQueryParams[d])}}catch(err){u.e(err)}finally{u.f()}}return new Promise(function(c,l){var u,d;if(i){var p=a.set("token",i).set("token_type_hint","access_token");u=e.http.post(r,p,{headers:s})}else u=Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(null);if(o){var h=a.set("token",o).set("token_type_hint","refresh_token");d=e.http.post(r,h,{headers:s})}else d=Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(null);n&&(u=u.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.a)(function(e){return 0===e.status?Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(null):Object(rxjs__WEBPACK_IMPORTED_MODULE_8__.a)(e)})),d=d.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.a)(function(e){return 0===e.status?Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(null):Object(rxjs__WEBPACK_IMPORTED_MODULE_8__.a)(e)}))),Object(rxjs__WEBPACK_IMPORTED_MODULE_9__.a)([u,d]).subscribe(function(n){e.logOut(t),c(n),e.logger.info("Token successfully revoked")},function(t){e.logger.error("Error revoking token",t),e.eventsSubject.next(new OAuthErrorEvent("token_revoke_error",t)),l(t)})})}}}]),n}(AuthConfig);return e.\u0275fac=function(t){return new(t||e)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](_angular_core__WEBPACK_IMPORTED_MODULE_0__.NgZone),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](_angular_common_http__WEBPACK_IMPORTED_MODULE_2__.c),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthStorage,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](ValidationHandler,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](AuthConfig,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](UrlHelperService),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthLogger),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](HashHandler,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](_angular_common__WEBPACK_IMPORTED_MODULE_1__.e))},e.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}(),OAuthModuleConfig=function e(){_classCallCheck(this,e)},OAuthResourceServerConfig=function e(){_classCallCheck(this,e)},OAuthResourceServerErrorHandler=function e(){_classCallCheck(this,e)},OAuthNoopResourceServerErrorHandler=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"handleError",value:function(e){return Object(rxjs__WEBPACK_IMPORTED_MODULE_8__.a)(e)}}]),e}(),DefaultOAuthInterceptor=function(){var e=function(){function e(t,n,r,i){_classCallCheck(this,e),this.authStorage=t,this.oAuthService=n,this.errorHandler=r,this.moduleConfig=i}return _createClass(e,[{key:"checkUrl",value:function(e){return this.moduleConfig.resourceServer.customUrlValidation?this.moduleConfig.resourceServer.customUrlValidation(e):!this.moduleConfig.resourceServer.allowedUrls||!!this.moduleConfig.resourceServer.allowedUrls.find(function(t){return e.startsWith(t)})}},{key:"intercept",value:function(e,t){var n=this,r=e.url.toLowerCase();return this.moduleConfig&&this.moduleConfig.resourceServer&&this.checkUrl(r)?this.moduleConfig.resourceServer.sendAccessToken?Object(rxjs__WEBPACK_IMPORTED_MODULE_10__.a)(Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(this.oAuthService.getAccessToken()).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(function(e){return!!e})),this.oAuthService.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.a)(function(e){return"token_received"===e.type}),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_19__.a)(this.oAuthService.waitForTokenInMsec||0),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.a)(function(e){return Object(rxjs__WEBPACK_IMPORTED_MODULE_5__.a)(null)}),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_16__.a)(function(e){return n.oAuthService.getAccessToken()}))).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_20__.a)(1),Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.a)(function(r){if(r){var i=e.headers.set("Authorization","Bearer "+r);e=e.clone({headers:i})}return t.handle(e).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.a)(function(e){return n.errorHandler.handleError(e)}))})):t.handle(e).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.a)(function(e){return n.errorHandler.handleError(e)})):t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthStorage),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthService),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthResourceServerErrorHandler),_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275inject"](OAuthModuleConfig,8))},e.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac}),e}(),NullValidationHandler=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"validateSignature",value:function(e){return Promise.resolve(null)}},{key:"validateAtHash",value:function(e){return Promise.resolve(!0)}}]),e}();function createDefaultLogger(){return console}function createDefaultStorage(){return"undefined"!=typeof sessionStorage?sessionStorage:new MemoryStorage}var OAuthModule=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NullValidationHandler;return{ngModule:e,providers:[OAuthService,UrlHelperService,{provide:OAuthLogger,useFactory:createDefaultLogger},{provide:OAuthStorage,useFactory:createDefaultStorage},{provide:ValidationHandler,useClass:n},{provide:HashHandler,useClass:DefaultHashHandler},{provide:OAuthResourceServerErrorHandler,useClass:OAuthNoopResourceServerErrorHandler},{provide:OAuthModuleConfig,useValue:t},{provide:_angular_common_http__WEBPACK_IMPORTED_MODULE_2__.a,useClass:DefaultOAuthInterceptor,multi:!0}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__["\u0275\u0275defineInjector"]({imports:[[_angular_common__WEBPACK_IMPORTED_MODULE_1__.c]]}),e}(),err="PLEASE READ THIS CAREFULLY:\n\nBeginning with angular-oauth2-oidc version 9, the JwksValidationHandler\nhas been moved to an library of its own. If you need it for implementing\nOAuth2/OIDC **implicit flow**, please install it using npm:\n\n  npm i angular-oauth2-oidc-jwks --save\n\nAfter that, you can import it into your application:\n\n  import { JwksValidationHandler } from 'angular-oauth2-oidc-jwks';\n\nPlease note, that this dependency is not needed for the **code flow**,\nwhich is nowadays the **recommented** one for single page applications.\nThis also results in smaller bundle sizes.\n",JwksValidationHandler=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),e=t.call(this),console.error(err),e}return n}(NullValidationHandler),AUTH_CONFIG=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("AUTH_CONFIG")}).call(this,__webpack_require__("3UD+")(module))},Nv8m:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("DH7j"),i=n("yCtX"),o=n("l7GE"),a=n("ZUHj");function s(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length){if(!Object(r.a)(t[0]))return t[0];t=t[0]}return Object(i.a)(t,void 0).lift(new c)}var c=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new l(e))}}]),e}(),l=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).hasFirst=!1,r.observables=[],r.subscriptions=[],r}return _createClass(n,[{key:"_next",value:function(e){this.observables.push(e)}},{key:"_complete",value:function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(var n=0;n<t&&!this.hasFirst;n++){var r=e[n],i=Object(a.a)(this,r,void 0,n);this.subscriptions&&this.subscriptions.push(i),this.add(i)}this.observables=null}}},{key:"notifyNext",value:function(e,t,n){if(!this.hasFirst){this.hasFirst=!0;for(var r=0;r<this.subscriptions.length;r++)if(r!==n){var i=this.subscriptions[r];i.unsubscribe(),this.remove(i)}this.subscriptions=null}this.destination.next(t)}}]),n}(o.a)},PDX0:function(e,t){(function(t){e.exports=t}).call(this,{})},sXTw:function(e,t,n){"use strict";n.r(t),n.d(t,"getRecaptchaLanguage",function(){return _i}),n.d(t,"AccountModule",function(){return Ei});var r=n("ofXK"),i=n("tk/3"),o=n("pmn7"),a=n("3Pt+"),s=n("YirH"),c=n("yc4G"),l=n("fXoL"),u={InvisibleReCaptcha:0,ReCaptcha2:1};u[u.InvisibleReCaptcha]="InvisibleReCaptcha",u[u.ReCaptcha2]="ReCaptcha2";var d,p,h,m,g,f,v,y,_=((h=function(){function e(t){_classCallCheck(this,e),this.zone=t,this.windowGrecaptcha="grecaptcha",this.windowOnLoadCallbackProperty="ngx_captcha_onload_callback",this.globalDomain="recaptcha.net",this.defaultDomain="google.com"}return _createClass(e,[{key:"registerCaptchaScript",value:function(e,t,n,r){var i=this;if(this.grecaptchaScriptLoaded())this.zone.run(function(){n(window[i.windowGrecaptcha])});else{window[this.windowOnLoadCallbackProperty]=function(){return i.zone.run(n.bind(i,window[i.windowGrecaptcha]))};var o=document.createElement("script");o.innerHTML="",o.src=this.getCaptchaScriptUrl(e,t,r),o.async=!0,o.defer=!0,document.getElementsByTagName("head")[0].appendChild(o)}}},{key:"cleanup",value:function(){window[this.windowOnLoadCallbackProperty]=void 0,window[this.windowGrecaptcha]=void 0}},{key:"grecaptchaScriptLoaded",value:function(){return!(!window[this.windowOnLoadCallbackProperty]||!window[this.windowGrecaptcha])}},{key:"getLanguageParam",value:function(e){return e?"&hl="+e:""}},{key:"getCaptchaScriptUrl",value:function(e,t,n){return"https://www.".concat(e?this.globalDomain:this.defaultDomain,"/recaptcha/api.js?onload=").concat(this.windowOnLoadCallbackProperty,"&render=").concat(t).concat(this.getLanguageParam(n))}}]),e}()).\u0275fac=function(e){return new(e||h)(l["\u0275\u0275inject"](l.NgZone))},h.\u0275prov=l["\u0275\u0275defineInjectable"]({token:h,factory:h.\u0275fac}),h),S=((p=function(){function e(t,n){_classCallCheck(this,e),this.scriptService=t,this.zone=n}return _createClass(e,[{key:"execute",value:function(e,t,n,r){this.executeAsPromise(e,t,r).then(n)}},{key:"executeAsPromise",value:function(e,t,n){var r=this;return new Promise(function(i,o){r.scriptService.registerCaptchaScript(!(!n||!n.useGlobalDomain),e,function(n){r.zone.runOutsideAngular(function(){try{n.execute(e,{action:t}).then(function(e){return r.zone.run(function(){return i(e)})})}catch(a){o(a)}})})})}}]),e}()).\u0275fac=function(e){return new(e||p)(l["\u0275\u0275inject"](_),l["\u0275\u0275inject"](l.NgZone))},p.\u0275prov=l["\u0275\u0275defineInjectable"]({token:p,factory:p.\u0275fac}),p),E=((d=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||d)},d.\u0275mod=l["\u0275\u0275defineNgModule"]({type:d}),d.\u0275inj=l["\u0275\u0275defineInjector"]({providers:[_,S],imports:[[r.c]]}),d),b=n("K3ix"),I=n("tyNb"),T=n("i3/Z"),w=n("nS6G"),C=n("Q86s"),k=n("Z0Cl"),A=n("Tr3h"),O=n("KALY"),x=n("Q9gK"),R=n("zmn3"),P=n("nYR2"),N=n("LgUO"),L=n("5756"),U=n("sJZM"),M=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var n=new Uint8Array(16);return t.getRandomValues(n),n[6]|=64,n[6]&=79,n[8]|=128,n[8]&=191,e.decimalToHex(n[0])+e.decimalToHex(n[1])+e.decimalToHex(n[2])+e.decimalToHex(n[3])+"-"+e.decimalToHex(n[4])+e.decimalToHex(n[5])+"-"+e.decimalToHex(n[6])+e.decimalToHex(n[7])+"-"+e.decimalToHex(n[8])+e.decimalToHex(n[9])+"-"+e.decimalToHex(n[10])+e.decimalToHex(n[11])+e.decimalToHex(n[12])+e.decimalToHex(n[13])+e.decimalToHex(n[14])+e.decimalToHex(n[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",i="0123456789abcdef",o=0,a="",s=0;s<36;s++)"-"!==r[s]&&"4"!==r[s]&&(o=16*Math.random()|0),"x"===r[s]?a+=i[o]:"y"===r[s]?(o&=3,a+=i[o|=8]):a+=r[s];return a},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},o={};for(t=r.exec(e);t;)o[i(t[1])]=i(t[2]),t=r.exec(e);return o},e}(),D=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(m||(m={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(g||(g={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(f||(f={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(v||(v={})),function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(y||(y={}));var j,H=[y.SID,y.LOGIN_HINT],q={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},F=function(e){function t(n,r){var i=e.call(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i.errorCode=n,i.errorMessage=r,i.name="AuthError",i}return U.d(t,e),t.createUnexpectedError=function(e){return new t("unexpected_error","Unexpected error in authentication.: "+e)},t.createNoWindowObjectError=function(e){return new t("no_window_object","No window object available. Details: "+e)},t}(Error),B=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(n){return null}},e}(),K="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",z=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,t.prototype),i}return U.d(t,e),t.createEndpointResolutionError=function(e){var n="Error: could not resolve endpoints. Please check network and try again.";return e&&!B.isEmpty(e)&&(n+=" Details: "+e),new t("endpoints_resolution_error",n)},t.createPopupWindowError=function(e){var n=K;return e&&!B.isEmpty(e)&&(n+=" Details: "+e),new t("popup_window_error",n)},t.createTokenRenewalTimeoutError=function(){return new t("token_renewal_error","Token renewal operation failed due to timeout.")},t.createInvalidIdTokenError=function(e){return new t("invalid_id_token","Invalid ID token format. Given token: "+e)},t.createInvalidStateError=function(e,n){return new t("invalid_state_error","Invalid state. "+e+", state expected : "+n+".")},t.createNonceMismatchError=function(e,n){return new t("nonce_mismatch_error","Nonce is not matching, Nonce received:  "+e+", nonce expected : "+n+".")},t.createLoginInProgressError=function(){return new t("login_progress_error","Login_In_Progress: Error during login call - login is already in progress.")},t.createAcquireTokenInProgressError=function(){return new t("acquiretoken_progress_error","AcquireToken_In_Progress: Error during login call - login is already in progress.")},t.createUserCancelledError=function(){return new t("user_cancelled","User cancelled the flow.")},t.createErrorInCallbackFunction=function(e){return new t("callback_error","Error occurred in token received callback function. "+e+".")},t.createUserLoginRequiredError=function(){return new t("user_login_error","User login is required. For silent calls, request must contain either sid or login_hint")},t.createUserDoesNotExistError=function(){return new t("user_non_existent","User object does not exist. Please call a login API.")},t.createClientInfoDecodingError=function(e){return new t("client_info_decoding_error","The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause. Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t("client_info_not_populated_error","The service did not populate client_info in the response, Please verify with the service team Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t("null_or_empty_id_token","The idToken is null or empty. Please review the trace to determine the root cause. Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t("id_token_parsing_error","ID token cannot be parsed. Please review stack trace to determine root cause. Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t("token_encoding_error","The token to be decoded is not encoded correctly. Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t("invalid_interaction_type","The interaction type passed to the handler was incorrect or unknown")},t.createCacheParseError=function(e){return new t("cannot_parse_cache","invalid key: "+e+", The cached token key is not a valid JSON and cannot be parsed")},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t("block_token_requests","Token calls are blocked in hidden iframes")},t}(F),W={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},G={code:"authority_uri_insecure",desc:"Authority URIs must use https."},V={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},Q=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,t.prototype),i}return U.d(t,e),t.createNoSetConfigurationError=function(){return new t("no_config_set","Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object.")},t.createStorageNotSupportedError=function(e){return new t("storage_not_supported","The value for the cacheLocation is not supported. Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t("no_redirect_callbacks","No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.")},t.createInvalidCallbackObjectError=function(e){return new t("invalid_callback_object","The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics. Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t("empty_input_scopes_error","Scopes cannot be passed as empty array. Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t("nonarray_input_scopes_error","Scopes cannot be passed as non-array. Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t("scopes_required","Scopes are required to obtain an access token. Given value: "+e)},t.createInvalidPromptError=function(e){return new t("invalid_prompt_value","Supported prompt values are 'login', 'select_account', 'consent' and 'none' Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t("claims_request_parsing_error","Could not parse the given claims request object. Given value: "+e)},t.createEmptyRequestError=function(){return new t("empty_request_error","Request object is required.")},t.createInvalidCorrelationIdError=function(){return new t("invalid_guid_sent_as_correlationId","Please set the correlationId as a valid guid")},t.createKnownAuthoritiesNotSetError=function(){return new t("b2c_known_authorities_not_set","Must set known authorities when validateAuthority is set to True and using B2C")},t.createInvalidAuthorityTypeError=function(){return new t(W.code,W.desc)},t.createUntrustedAuthorityError=function(e){return new t("untrusted_authority","The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false. Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var n={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t("telemetry_config_error","Telemetry config is not configured with required values mising values: "+Object.keys(n).reduce(function(t,r){return e[r]?t:t.concat([r+" ("+n[r]+")"])},[]).join(","))},t.createSsoSilentError=function(){return new t("sso_silent_error","request must contain either sid or login_hint")},t.createInvalidAuthorityMetadataError=function(){return new t("authority_metadata_error","Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields.")},t}(z),X=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var n=this.trimAndConvertArrayToLowerCase(e.slice()),r=this.trimAndConvertArrayToLowerCase(t.slice()),i=0;i<r.length;i++)if(n.indexOf(r[i].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var n=this.trimAndConvertArrayToLowerCase(e.slice());return this.trimAndConvertArrayToLowerCase(t.slice()).every(function(e){return n.indexOf(e.toString().toLowerCase())>=0})},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map(function(e){return t.trimAndConvertToLowerCase(e)})},e.trimScopes=function(e){return e.map(function(e){return e.trim()})},e.removeElement=function(e,t){var n=this.trimAndConvertToLowerCase(t);return e.filter(function(e){return e!==n})},e.parseScope=function(e){var t="";if(e)for(var n=0;n<e.length;++n)t+=n!==e.length-1?e[n]+" ":e[n];return t},e.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw Q.createScopesNonArrayError(e);if(e.length<1&&t)throw Q.createEmptyScopesArrayError(e.toString())}else if(t)throw Q.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(D.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var n=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,r=this.trimAndConvertArrayToLowerCase(e.slice());return n?r.concat(n):r}return null},e.onlyContainsOidcScopes=function(e){var t=e.length,n=0;return e.indexOf(D.openidScope)>-1&&(n+=1),e.indexOf(D.profileScope)>-1&&(n+=1),t>0&&t===n},e.containsAnyOidcScopes=function(e){var t=e.indexOf(D.openidScope)>-1,n=e.indexOf(D.profileScope)>-1;return t||n},e.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},e.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(D.openidScope)&&t.push(D.openidScope),-1===t.indexOf(D.profileScope)&&t.push(D.profileScope),t},e.removeDefaultScopes=function(e){return e.filter(function(e){return e!==D.openidScope&&e!==D.profileScope})},e.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?D.oidcScopes:e},e}(),J=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),n=e.authorityInstance.AuthorizationEndpoint;return n.indexOf("?")<0?n+="?":n+="&",""+n+t.join("&")},e.createNavigationUrlString=function(e){var t=X.appendDefaultScopes(e.scopes),n=[];return n.push("response_type="+e.responseType),n.push("scope="+encodeURIComponent(X.parseScope(t))),n.push("client_id="+encodeURIComponent(e.clientId)),n.push("redirect_uri="+encodeURIComponent(e.redirectUri)),n.push("state="+encodeURIComponent(e.state)),n.push("nonce="+encodeURIComponent(e.nonce)),n.push("client_info=1"),n.push("x-client-SKU="+e.xClientSku),n.push("x-client-Ver="+e.xClientVer),e.promptValue&&n.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&n.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&n.push(e.queryParameters),e.extraQueryParameters&&n.push(e.extraQueryParameters),n.push("client-request-id="+encodeURIComponent(e.correlationId)),n},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){var n=e.toLowerCase(),r=this.GetUrlComponents(n),i=r.PathSegments;return!t||0===i.length||i[0]!==D.common&&i[0]!==y.ORGANIZATIONS&&i[0]!==y.CONSUMERS||(i[0]=t),this.constructAuthorityUriFromObject(r,i)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),n=this.GetUrlComponents(t).PathSegments;return 0!==n.length&&n[0]===D.common},e.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),n=this.GetUrlComponents(t).PathSegments;return 0!==n.length&&n[0]===y.ORGANIZATIONS},e.isConsumersAuthority=function(e){var t=this.CanonicalizeUri(e),n=this.GetUrlComponents(t).PathSegments;return 0!==n.length&&n[0]===y.CONSUMERS},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=e.match(t);if(!n||n.length<6)throw"Valid url required";var r={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5]},i=r.AbsolutePath.split("/");return i=i.filter(function(e){return e&&e.length>0}),r.PathSegments=i,n[6]&&(r.Search=n[6]),n[8]&&(r.Hash=n[8]),r},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(B.isEmpty(e))return e;var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e.replace(n,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),n=e.indexOf("#/");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var n=e.deserializeHash(t);return n.hasOwnProperty(m.ERROR_DESCRIPTION)||n.hasOwnProperty(m.ERROR)||n.hasOwnProperty(m.ACCESS_TOKEN)||n.hasOwnProperty(m.ID_TOKEN)},e.deserializeHash=function(t){var n=e.getHashFromUrl(t);return M.deserialize(n)},e.getHostFromUri=function(e){return String(e).replace(/^(https?:)\/\//,"").split("/")[0]},e}(),Y=function(e,t,n,r,i){this.authority=J.CanonicalizeUri(e),this.clientId=t,this.scopes=n,this.homeAccountIdentifier=M.base64Encode(r)+"."+M.base64Encode(i)},$=function(e,t,n,r){this.accessToken=e,this.idToken=t,this.expiresIn=n,this.homeAccountIdentifier=r},Z=function(){function e(e,t,n,r,i,o,a){this.authorityInstance=e,this.clientId=t,this.nonce=M.createNewGuid(),this.scopes=i?i.slice():D.oidcScopes,this.scopes=X.trimScopes(this.scopes),this.state=o,this.correlationId=a,this.xClientSku="MSAL.JS",this.xClientVer="1.4.11",this.responseType=n,this.redirectUri=r}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,n,r,i){var o={};n&&(n.prompt&&(this.promptValue=n.prompt),n.claimsRequest&&(this.claimsValue=n.claimsRequest),e.isSSOParam(n)&&(o=this.constructUnifiedCacheQueryParameter(n,null))),r&&(o=this.constructUnifiedCacheQueryParameter(null,r)),o=this.addHintParameters(t,o);var a=n?n.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(o),this.extraQueryParameters=e.generateQueryParametersString(a,i)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var n,r;if(e)if(e.account){var i=e.account;i.sid?(n=y.SID,r=i.sid):i.userName&&(n=y.LOGIN_HINT,r=i.userName)}else e.sid?(n=y.SID,r=e.sid):e.loginHint&&(n=y.LOGIN_HINT,r=e.loginHint);else t&&t.hasOwnProperty(D.upn)&&(n=y.ID_TOKEN,r=t.upn);return this.addSSOParameter(n,r)},e.prototype.addHintParameters=function(e,t){return e&&!t[y.SID]&&(!t[y.LOGIN_HINT]&&e.sid&&this.promptValue===q.NONE?t=this.addSSOParameter(y.SID,e.sid,t):!t[y.LOGIN_HINT]&&e.userName&&!B.isEmpty(e.userName)&&(t=this.addSSOParameter(y.LOGIN_HINT,e.userName,t))),t},e.prototype.addSSOParameter=function(e,t,n){if(n||(n={}),!t)return n;switch(e){case y.SID:n[y.SID]=t;break;case y.ID_TOKEN:case y.LOGIN_HINT:n[y.LOGIN_HINT]=t}return n},e.generateQueryParametersString=function(e,t){var n=null;return e&&Object.keys(e).forEach(function(r){r===D.domain_hint&&(t||e[y.SID])||(n?n+="&"+r+"="+encodeURIComponent(e[r]):n=r+"="+encodeURIComponent(e[r]))}),n},e.isSSOParam=function(e){return!(!e||!(e.account||e.sid||e.loginHint))},e.determineResponseType=function(e,t){return X.onlyContainsOidcScopes(t)?"id_token":e?this.responseTypeForMatchingAccounts(t):"id_token token"},e.responseTypeForMatchingAccounts=function(e){return X.containsAnyOidcScopes(e)?"id_token token":"token"},e}(),ee=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,n){var r=this;return new Promise(function(n,i){var o=new XMLHttpRequest;if(o.open(t,e,!0),o.onload=function(){var e;(o.status<200||o.status>=300)&&i(r.handleError(o.responseText));try{e=JSON.parse(o.responseText)}catch(t){i(r.handleError(o.responseText))}n({statusCode:o.status,body:e})},o.onerror=function(){i(o.status)},"GET"!==t)throw"not implemented";o.send()})},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(n){return e}},e}(),te=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,n){t&&!this.getTrustedHostList().length&&n.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})},e.getAliases=function(e,t,n){return U.b(this,void 0,void 0,function(){var r,i,o;return U.e(this,function(a){return r=new ee,o=t.createAndStartHttpEvent(n,"GET",i="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize","getAliases"),[2,r.sendRequestAsync(i,"GET",!0).then(function(e){return o.httpResponseStatus=e.statusCode,t.stopEvent(o),e.body.metadata}).catch(function(e){throw o.serverErrorCode=e,t.stopEvent(o),e})]})})},e.setTrustedAuthoritiesFromNetwork=function(t,n,r){return U.b(this,void 0,void 0,function(){var i;return U.e(this,function(o){switch(o.label){case 0:return[4,this.getAliases(t,n,r)];case 1:return o.sent().forEach(function(t){t.aliases.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})}),i=J.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(i)&&e.TrustedHostList.push(i.toLowerCase()),[2]}})})},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(j||(j={}));var ne,re=function(){function e(e,t,n){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=n}return e.isAdfs=function(e){var t=J.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===D.ADFS},Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return e.isAdfs(this.canonicalAuthority)?j.Adfs:j.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=J.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=J.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===j.Adfs?this.CanonicalAuthority+".well-known/openid-configuration":this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(t){throw W}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw G;if(!e.PathSegments||e.PathSegments.length<1)throw V},e.prototype.DiscoverEndpoints=function(e,t,n){var r=new ee,i=t.createAndStartHttpEvent(n,"GET",e,"openIdConfigurationEndpoint");return r.sendRequestAsync(e,"GET",!0).then(function(e){return i.httpResponseStatus=e.statusCode,t.stopEvent(i),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}}).catch(function(e){throw i.serverErrorCode=e,t.stopEvent(i),e})},e.prototype.resolveEndpointsAsync=function(e,t){return U.b(this,void 0,void 0,function(){var n,r,i;return U.e(this,function(o){switch(o.label){case 0:return this.IsValidationEnabled?(n=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==te.getTrustedHostList().length?[3,2]:[4,te.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:o.sent(),o.label=2;case 2:if(!te.IsInTrustedHostList(n))throw Q.createUntrustedAuthorityError(n);o.label=3;case 3:return r=this.GetOpenIdConfigurationEndpoint(),i=this,[4,this.DiscoverEndpoints(r,e,t)];case 4:return i.tenantDiscoveryResponse=o.sent(),[2,this.tenantDiscoveryResponse]}})})},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}(),ie=function(){function e(t,n){if(!t||B.isEmpty(t))return this.uid="",void(this.utid="");try{var r=M.base64Decode(t),i=JSON.parse(r);i&&(i.hasOwnProperty("uid")&&(this.uid=n?e.stripPolicyFromUid(i.uid,n):i.uid),i.hasOwnProperty("utid")&&(this.utid=i.utid))}catch(o){throw z.createClientInfoDecodingError(o)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e.createClientInfoFromIdToken=function(t,n){return new e(M.base64Encode(JSON.stringify({uid:t.subject,utid:""})),n)},e.stripPolicyFromUid=function(e,t){var n=e.split("-"),r=t.split("/").reverse(),i="";return B.isEmpty(r[0])?r.length>1&&(i=r[1]):i=r[0],n[n.length-1]===i?n.slice(0,n.length-1).join("-"):e},e.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return M.base64Encode(e)},e}(),oe=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}(),ae=function(){function e(){}return e.decodeJwt=function(e){if(B.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.validateExpirationIsWithinOffset=function(e,t){var n=t||300;return e&&e>oe.now()+n},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var n=M.base64Decode(t.JWSPayload);return n?JSON.parse(n):null}catch(r){}return null},e}(),se=function(e){if(B.isEmpty(e))throw z.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=ae.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(t){throw z.createIdTokenParsingError(t)}},ce=function(e,t){this.key=e,this.value=t},le=function(){function e(e){if(!window)throw F.createNoWindowObjectError("Browser storage class could not find window object");if(void 0===window[e]||null===window[e])throw Q.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,n){window[this.cacheLocation].setItem(e,t),n&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,n){var r=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";n&&(r+="expires="+this.getCookieExpirationTime(n)+";"),document.cookie=r},e.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),ue=function(){function e(){}return e.validateRequest=function(e,t,n,r){if(!t&&!e)throw Q.createEmptyRequestError();var i,o;e&&(i=t?X.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,X.validateInputScope(i,!t),i=X.translateClientIdIfSingleScope(i,n),this.validatePromptParameter(e.prompt),o=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var a=this.validateAndGenerateState(e&&e.state,r),s=this.validateAndGenerateCorrelationId(e&&e.correlationId);return U.a({},e,{extraQueryParameters:o,scopes:i,state:a,correlationId:s})},e.validatePromptParameter=function(e){if(e&&[q.LOGIN,q.SELECT_ACCOUNT,q.CONSENT,q.NONE].indexOf(e)<0)throw Q.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var n=U.a({},e);return n?(t&&delete n[D.claims],H.forEach(function(e){n[e]&&delete n[e]}),n):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(t){throw Q.createClaimsRequestParsingError(t)}},e.validateAndGenerateState=function(t,n){return B.isEmpty(t)?e.generateLibraryState(n):""+e.generateLibraryState(n)+D.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:M.createNewGuid(),ts:oe.now(),method:e},n=JSON.stringify(t);return M.base64Encode(n)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(D.resourceDelimiter)[0];if(M.isGuid(t))return{id:t,ts:oe.now(),method:D.interactionTypeRedirect};try{var n=M.base64Decode(t);return JSON.parse(n)}catch(r){throw z.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!M.isGuid(e))throw Q.createInvalidCorrelationIdError();return M.isGuid(e)?e:M.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+D.resourceDelimiter+e.authority},e}(),de=function(e){function t(t,n,r){var i=e.call(this,n)||this;return i.clientId=t,i.rollbackEnabled=!0,i.migrateCacheEntries(r),i}return U.d(t,e),t.prototype.migrateCacheEntries=function(t){var n,r=this,i=D.cachePrefix+"."+f.CLIENT_INFO,o=D.cachePrefix+"."+v.ERROR,a=D.cachePrefix+"."+v.ERROR_DESC,s=e.prototype.getItem.call(this,D.cachePrefix+"."+f.IDTOKEN);if(s)try{n=new se(s)}catch(l){return}if(n&&n.claims&&n.claims.aud===this.clientId){var c=[s,e.prototype.getItem.call(this,i),e.prototype.getItem.call(this,o),e.prototype.getItem.call(this,a)];[f.IDTOKEN,f.CLIENT_INFO,v.ERROR,v.ERROR_DESC].forEach(function(e,n){return r.duplicateCacheEntry(e,c[n],t)})}},t.prototype.duplicateCacheEntry=function(e,t,n){t&&this.setItem(e,t,n)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(n){return 0===e.indexOf(""+D.cachePrefix)||0===e.indexOf(D.adalIdToken)?e:t?D.cachePrefix+"."+this.clientId+"."+e:D.cachePrefix+"."+e}},t.prototype.matchKeyForType=function(e,t,n,r){var i=B.validateAndParseJsonCacheKey(e);if(!i)return null;var o=e.match(t)&&e.match(n),a=!1;switch(r){case m.ACCESS_TOKEN:a=!!e.match(D.scopes);break;case m.ID_TOKEN:a=!e.match(D.scopes)}return o&&a?i:null},t.prototype.setItem=function(t,n,r){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),n,r),this.rollbackEnabled&&!r&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),n,r)},t.prototype.getItem=function(t,n){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),n)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,n=window[this.cacheLocation];for(t in n)n.hasOwnProperty(t)&&-1!==t.indexOf(D.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var n=this,r=t&&ue.parseLibraryState(t).id,i=this.tokenRenewalInProgress(t),o=window[this.cacheLocation];r&&!i&&Object.keys(o).forEach(function(t){-1!==t.indexOf(r)&&(n.removeItem(t),e.prototype.clearItemCookie.call(n,t))}),this.removeItem(g.INTERACTION_STATUS),this.removeItem(g.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,n,r){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),n,r),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),n,r)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllTokensByType=function(e,t,n){var r=this;return Object.keys(window[this.cacheLocation]).reduce(function(i,o){var a=r.matchKeyForType(o,e,t,n);if(a){var s=r.getItem(o);if(s)try{var c=new ce(a,JSON.parse(s));return i.concat([c])}catch(l){return i}}return i},[])},t.prototype.getAllAccessTokens=function(e,t){return this.getAllTokensByType(e,t,m.ACCESS_TOKEN)},t.prototype.getAllIdTokens=function(e,t){return this.getAllTokensByType(e,t,m.ID_TOKEN)},t.prototype.getAllTokens=function(e,t){var n=this.getAllAccessTokens(e,t),r=this.getAllIdTokens(e,t);return n.concat(r)},t.prototype.tokenRenewalInProgress=function(e){var n=this.getItem(t.generateTemporaryCacheKey(g.RENEW_STATUS,e));return!(!n||n!==D.inProgress)},t.prototype.clearMsalCookie=function(n){var r=this;n?(this.clearItemCookie(t.generateTemporaryCacheKey(g.NONCE_IDTOKEN,n)),this.clearItemCookie(t.generateTemporaryCacheKey(g.STATE_LOGIN,n)),this.clearItemCookie(t.generateTemporaryCacheKey(g.LOGIN_REQUEST,n)),this.clearItemCookie(t.generateTemporaryCacheKey(g.STATE_ACQ_TOKEN,n))):document.cookie.split(";").forEach(function(t){var n=t.trim().split("=")[0];n.indexOf(D.cachePrefix)>-1&&e.prototype.clearItemCookie.call(r,n)})},t.generateAcquireTokenAccountKey=function(e,t){var n=ue.parseLibraryState(t).id;return""+g.ACQUIRE_TOKEN_ACCOUNT+D.resourceDelimiter+e+D.resourceDelimiter+n},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(g.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var n=ue.parseLibraryState(t).id;return""+e+D.resourceDelimiter+n},t}(le),pe=function(){function e(e,t,n,r,i,o,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=n,this.name=r,this.idToken=i,this.idTokenClaims=i,this.sid=o,this.environment=a}return e.createAccount=function(t,n){var r,i=t.objectId||t.subject,o=n?n.uid:"",a=n?n.utid:"";return B.isEmpty(o)||(r=B.isEmpty(a)?M.base64Encode(o):M.base64Encode(o)+"."+M.base64Encode(a)),new e(i,r,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!!(e&&t&&e.homeAccountIdentifier&&t.homeAccountIdentifier&&e.homeAccountIdentifier===t.homeAccountIdentifier)},e}(),he=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+D.resourceDelimiter+t},e.monitorIframeForHash=function(t,n,r,i){return new Promise(function(o,a){var s=oe.relativeNowMs()+n;i.verbose("monitorWindowForIframe polling started");var c=setInterval(function(){if(oe.relativeNowMs()>s)return i.error("monitorIframeForHash unable to find hash in url, timing out"),i.errorPii("monitorIframeForHash polling timed out for url: "+r),clearInterval(c),void a(z.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(n){}e&&J.urlContainsHash(e)&&(i.verbose("monitorIframeForHash found url in hash"),clearInterval(c),o(t.location.hash))},e.POLLING_INTERVAL_MS)})},e.monitorPopupForHash=function(t,n,r,i){return new Promise(function(o,a){var s=n/e.POLLING_INTERVAL_MS,c=0;i.verbose("monitorWindowForHash polling started");var l=setInterval(function(){if(t.closed)return i.error("monitorWindowForHash window closed"),clearInterval(l),void a(z.createUserCancelledError());var n;try{n=t.location.href}catch(d){}if(n&&"about:blank"!==n)if(c++,n&&J.urlContainsHash(n)){i.verbose("monitorPopupForHash found url in hash"),clearInterval(l);var u=t.location.hash;e.clearUrlFragment(t),o(u)}else c>s&&(i.error("monitorPopupForHash unable to find hash in url, timing out"),i.errorPii("monitorPopupForHash polling timed out for url: "+r),clearInterval(l),a(z.createTokenRenewalTimeoutError()))},e.POLLING_INTERVAL_MS)})},e.loadFrame=function(e,t,n,r){var i=this;return r.infoPii("LoadFrame: "+t),new Promise(function(o,a){setTimeout(function(){var n=i.loadFrameSync(e,t,r);n?o(n):a("Unable to load iframe with name: "+t)},n)})},e.loadFrameSync=function(t,n,r){var i=e.addHiddenIFrame(n,r);return i?(""!==i.src&&"about:blank"!==i.src||(i.src=t,r.infoPii("Frame Name : "+n+" Navigated to: "+t)),i):null},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.infoPii("Add msal frame to document:"+e);var n=document.getElementById(e);if(!n){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var r=document.createElement("iframe");r.setAttribute("id",e),r.setAttribute("aria-hidden","true"),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),n=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(n=window.frames[e])}return n},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map(function(e,n){return t.item(n)}).filter(function(t){try{return t.contentWindow.location.hash===e}catch(n){return!1}})[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter(function(e){try{return e.location.hash===t}catch(n){return!1}})[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach(function(e){return e.close()})},e.blockReloadInHiddenIframes=function(){if(J.urlContainsHash(window.location.hash)&&e.isInIframe())throw z.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(g.REDIRECT_REQUEST);if(t&&!J.urlContainsHash(window.location.hash)){var n=t.split(D.resourceDelimiter);n.shift();var r=n.length>0?n.join(D.resourceDelimiter):null;e.resetTempCacheItems(r)}},e.clearUrlFragment=function(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,null,""+e.location.pathname+e.location.search)},e.POLLING_INTERVAL_MS=50,e}(),me=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var n=Number(t.expiration);return n&&!e.expiresOn&&(e.expiresOn=new Date(1e3*n)),U.a({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e.buildAuthResponse=function(t,n,r,i,o,a){switch(r.responseType){case"id_token":return n=U.a({},n,{tokenType:m.ID_TOKEN,account:i,scopes:o,accountState:a}),(n=e.setResponseIdToken(n,t)).idToken?n:null;case"id_token token":return(n=e.setResponseIdToken(n,t))&&n.accessToken&&n.idToken?n:null;case"token":return e.setResponseIdToken(n,t);default:return null}},e}(),ge=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,n){return U.b(this,void 0,void 0,function(){var r;return U.e(this,function(i){switch(i.label){case 0:return[4,e.resolveEndpointsAsync(t,n)];case 1:return r=i.sent(),this.metadataMap.set(e.CanonicalAuthority,r),[2,r]}})})},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var n=JSON.parse(t);if(!n.authorization_endpoint||!n.end_session_endpoint||!n.issuer)throw Q.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:n.authorization_endpoint,EndSessionEndpoint:n.end_session_endpoint,Issuer:n.issuer})}}catch(r){throw Q.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,n){return B.isEmpty(e)?null:(n&&this.saveMetadataFromConfig(e,n),new re(e,t,this.metadataMap.get(e)))},e.metadataMap=new Map,e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(ne||(ne={}));var fe=function(){function e(e,t){void 0===t&&(t={}),this.level=ne.Info;var n=t.correlationId,r=void 0===n?"":n,i=t.level,o=void 0===i?ne.Info:i,a=t.piiLoggingEnabled,s=void 0!==a&&a;this.localCallback=e,this.correlationId=r,this.level=o,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,n){if(!(e>this.level||!this.piiLoggingEnabled&&n)){var r,i=(new Date).toUTCString();r=B.isEmpty(this.correlationId)?i+":1.4.11-"+ne[e]+(n?"-pii":"")+" "+t:i+":"+this.correlationId+"-1.4.11-"+ne[e]+(n?"-pii":"")+" "+t,this.executeCallback(e,r,n)}},e.prototype.executeCallback=function(e,t,n){this.localCallback&&this.localCallback(e,t,n)},e.prototype.error=function(e){this.logMessage(ne.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(ne.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(ne.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(ne.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(ne.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(ne.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(ne.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(ne.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),ve={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return J.getCurrentUrl()},postLogoutRedirectUri:function(){return J.getCurrentUrl()},navigateToLoginRequestUrl:!0},ye={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},_e={logger:new fe(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},Se={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map},Ee=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return U.d(t,e),t.createServerUnavailableError=function(){return new t("server_unavailable","Server is temporarily unavailable.")},t.createUnknownServerError=function(e){return new t("unknown_server_error",e)},t}(F),be={code:"interaction_required"},Ie={code:"consent_required"},Te={code:"login_required"},we=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return U.d(t,e),t.isInteractionRequiredError=function(e){return e&&[be.code,Ie.code,Te.code].indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(Te.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(be.code,e)},t.createConsentRequiredAuthError=function(e){return new t(Ie.code,e)},t}(Ee);function Ce(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var ke,Ae,Oe,xe=function(e){var t=J.GetUrlComponents(e);if(re.isAdfs(e))return e;var n=t.PathSegments;if(n&&n.length>=2){var r="tfp"===n[1]?2:1;r<n.length&&(n[r]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+n.join("/")},Re=function(e){return M.base64Encode(e)},Pe=function(e){return"msal."+(e||"")},Ne=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},Le=function(){function e(e,t,n){var r;this.eventId=M.createNewGuid(),this.label=n,this.event=((r={})[Pe("event_name")]=e,r[Pe("elapsed_time")]=-1,r["Microsoft.MSAL.correlation_id"]=t,r)}return e.prototype.setElapsedTime=function(e){this.event[Pe("elapsed_time")]=e},e.prototype.stop=function(){var e,t,n;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,n=this.perfEndMark,Ne()&&(window.performance.mark(n),window.performance.measure(e,t,n),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(n))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[Pe("start_time")]=this.startTimestamp,e=this.perfStartMark,Ne()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event["Microsoft.MSAL.correlation_id"]},set:function(e){this.event["Microsoft.MSAL.correlation_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[Pe("event_name")]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return U.a({},this.event,{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),e}(),Ue=function(e){function t(t,n,r,i){var o=e.call(this,Pe("default_event"),n,"DefaultEvent")||this;return o.event[Pe("client_id")]=r,o.event[Pe("sdk_plaform")]=t.sdk,o.event[Pe("sdk_version")]=t.sdkVersion,o.event[Pe("application_name")]=t.applicationName,o.event[Pe("application_version")]=t.applicationVersion,o.event[Pe("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,o.event.Microsoft_MSAL_ui_event_count=o.getEventCount(Pe("ui_event"),i),o.event.Microsoft_MSAL_http_event_count=o.getEventCount(Pe("http_event"),i),o.event.Microsoft_MSAL_cache_event_count=o.getEventCount(Pe("cache_event"),i),o}return U.d(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(Le),Me=Pe("authority"),De=Pe("authority_type"),je=Pe("ui_behavior"),He=Pe("tenant_id"),qe=Pe("user_id"),Fe=Pe("was_successful"),Be=Pe("api_error_code"),Ke=Pe("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(Ae||(Ae={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(Oe||(Oe={}));var ze,We,Ge=((ke={})[Oe.AcquireTokenSilent]=Ae.AcquireTokenSilent,ke[Oe.AcquireTokenPopup]=Ae.AcquireTokenPopup,ke[Oe.AcquireTokenRedirect]=Ae.AcquireTokenRedirect,ke[Oe.LoginPopup]=Ae.LoginPopup,ke[Oe.LoginRedirect]=Ae.LoginRedirect,ke[Oe.Logout]=Ae.Logout,ke),Ve=function(e){function t(t,n,r){var i=e.call(this,Pe("api_event"),t,r)||this;return r&&(i.apiCode=Ge[r],i.apiEventIdentifier=r),i.piiEnabled=n,i}return U.d(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event["msal.api_telem_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event["msal.api_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[Me]=xe(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[Be]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[He]=this.piiEnabled&&e?Re(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[qe]=this.piiEnabled&&e?Re(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[Fe]},set:function(e){this.event[Fe]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[Ke]=this.piiEnabled&&e?Re(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[De]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[je]=e.toLowerCase()},enumerable:!0,configurable:!0}),t}(Le),Qe=Pe("http_path"),Xe=Pe("user_agent"),Je=Pe("query_parameters"),Ye=Pe("api_version"),$e=Pe("response_code"),Ze=Pe("oauth_error_code"),et=Pe("http_method"),tt=Pe("request_id_header"),nt=Pe("spe_info"),rt=Pe("server_error_code"),it=Pe("server_sub_error_code"),ot=Pe("url"),at=function(e){function t(t,n){return e.call(this,Pe("http_event"),t,n)||this}return U.d(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=xe(e);this.event[ot]=t&&t.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[Qe]=xe(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[Xe]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[Je]=Z.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[Ye]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[$e]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[Ze]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[et]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[tt]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[nt]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[rt]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[it]=e},enumerable:!0,configurable:!0}),t}(Le),st=function(){function e(e,t,n){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=U.a({sdk:D.libraryName,sdkVersion:"1.4.11",networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=n}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},function(){},t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]&&(e.stop(),this.incrementEventCount(e),this.completedEvents[e.telemetryCorrelationId]=(this.completedEvents[e.telemetryCorrelationId]||[]).concat([e]),delete this.inProgressEvents[e.key])},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var n=this.getOrphanedEvents(e);n.forEach(function(e){return t.incrementEventCount(e)});var r=this.completedEvents[e].concat(n);delete this.completedEvents[e];var i=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],r&&r.length){var o=new Ue(this.telemetryPlatform,e,this.clientId,i),a=r.concat([o]);this.telemetryEmitter(a.map(function(e){return e.get()}))}}},e.prototype.createAndStartApiEvent=function(e,t){var n=new Ve(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(n),n},e.prototype.stopAndFlushApiEvent=function(e,t,n,r){t.wasSuccessful=n,r&&(t.apiErrorCode=r),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,n,r){var i=new at(e,r);return i.url=n,i.httpMethod=t,this.startEvent(i),i},e.prototype.incrementEventCount=function(e){var t,n=e.eventName,r=this.eventCountByCorrelationId[e.telemetryCorrelationId];r?r[n]=r[n]?r[n]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[n]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(n,r){if(-1!==r.indexOf(e)){var i=t.inProgressEvents[r];return delete t.inProgressEvents[r],n.concat([i])}return n},[])},e}(),ct=function(){function e(){}return e.filterTokenCacheItemsByScope=function(e,t){return e.filter(function(e){var n=e.key.scopes.split(" "),r=X.removeDefaultScopes(t);return X.containsScope(n,0===r.length?t:r)})},e.filterTokenCacheItemsByAuthority=function(e,t){return e.filter(function(e){return J.CanonicalizeUri(e.key.authority)===t})},e.filterTokenCacheItemsByDomain=function(e,t){return e.filter(function(e){return J.GetUrlComponents(e.key.authority).HostNameAndPort===t})},e}(),lt=function(){function e(e){var t,n,r,i,o,a,s;this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(r=void 0===(n=(t=e).cache)?{}:n,o=void 0===(i=t.system)?{}:i,s=void 0===(a=t.framework)?{}:a,{auth:U.a({},ve,t.auth),cache:U.a({},ye,r),system:U.a({},_e,o),framework:U.a({},Se,s)}),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),te.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),ge.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new de(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var c=window.location.hash,l=J.urlContainsHash(c);he.checkIfBackButtonIsPressed(this.cacheStorage),l&&this.getResponseState(c).method===D.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(c)}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=ge.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw Q.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(D.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(D.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),J.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,n){if(this.logger.verbose("AuthResponseHandler has been called"),e===D.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==D.interactionTypePopup)throw z.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),n(t)}},e.prototype.authErrorHandler=function(e,t,n,r){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.removeItem(g.INTERACTION_STATUS),e===D.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,n.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,n)}else{if(e!==D.interactionTypePopup)throw z.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),r(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=ue.validateRequest(e,!0,this.clientId,D.interactionTypeRedirect);this.acquireTokenInteractive(D.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=ue.validateRequest(e,!1,this.clientId,D.interactionTypeRedirect);this.acquireTokenInteractive(D.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var n=ue.validateRequest(e,!0,this.clientId,D.interactionTypePopup),r=this.telemetryManager.createAndStartApiEvent(n.correlationId,Oe.LoginPopup);return new Promise(function(e,r){t.acquireTokenInteractive(D.interactionTypePopup,!0,n,e,r)}).then(function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!1,e.errorCode),e})},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var n=ue.validateRequest(e,!1,this.clientId,D.interactionTypePopup),r=this.telemetryManager.createAndStartApiEvent(n.correlationId,Oe.AcquireTokenPopup);return new Promise(function(e,r){t.acquireTokenInteractive(D.interactionTypePopup,!1,n,e,r)}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!1,e.errorCode),e})},e.prototype.acquireTokenInteractive=function(e,t,n,r,i){var o=this;this.logger.verbose("AcquireTokenInteractive has been called"),he.blockReloadInHiddenIframes();var a,s=this.cacheStorage.getItem(g.INTERACTION_STATUS);if(e===D.interactionTypeRedirect&&this.cacheStorage.setItem(g.REDIRECT_REQUEST,""+D.inProgress+D.resourceDelimiter+n.state),s===D.inProgress){var c=t?z.createLoginInProgressError():z.createAcquireTokenInProgressError(),l=Ce(this.getAccountState(n.state));return this.cacheStorage.resetTempCacheItems(n.state),void this.authErrorHandler(e,c,l,i)}if(n&&n.account&&!t?(a=n.account,this.logger.verbose("Account set from request")):(a=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a||Z.isSSOParam(n))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(a,e,t,n,r,i);else{if(!t)return this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required"),l=Ce(this.getAccountState(n.state)),this.cacheStorage.resetTempCacheItems(n.state),void this.authErrorHandler(e,z.createUserLoginRequiredError(),l,i);if(this.extractADALIdToken()&&!n.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var u=this.buildIDTokenRequest(n);this.silentLogin=!0,this.acquireTokenSilent(u).then(function(t){o.silentLogin=!1,o.logger.info("Unified cache call is successful"),o.authResponseHandler(e,t,r)},function(a){o.silentLogin=!1,o.logger.error("Error occurred during unified cache ATS: "+a),o.acquireTokenHelper(null,e,t,n,r,i)})}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,n,r,i)}},e.prototype.acquireTokenHelper=function(e,t,n,r,i,o){return U.b(this,void 0,void 0,function(){var a,s,c,l,u,d,p,h,m,f;return U.e(this,function(y){switch(y.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+n),this.cacheStorage.setItem(g.INTERACTION_STATUS,D.inProgress),a=r.scopes?r.scopes.join(" ").toLowerCase():D.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+a),c=r&&r.authority?ge.CreateInstance(r.authority,this.config.auth.validateAuthority,r.authorityMetadata):this.authorityInstance,y.label=1;case 1:return y.trys.push([1,11,,12]),c.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,ge.saveMetadataFromNetwork(c,this.telemetryManager,r.correlationId)]);case 2:return y.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),y.label=4;case 4:if(u=n?"id_token":this.getTokenType(e,r.scopes),d=r.redirectStartPage||window.location.href,s=new Z(c,this.clientId,u,this.getRedirectUri(r&&r.redirectUri),r.scopes,r.state,r.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(s,e,n,d),this.logger.verbose("Updating cache entries"),s.populateQueryParams(e,r),this.logger.verbose("Query parameters populated from account"),p=J.createNavigateUrl(s)+D.response_mode_fragment,t===D.interactionTypeRedirect)n?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(de.generateTemporaryCacheKey(g.STATE_ACQ_TOKEN,r.state),s.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+s.state));else{if(t!==D.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),z.createInvalidInteractionTypeError();window.renewStates.push(s.state),window.requestType=n?D.login:D.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+s.state),this.registerCallback(s.state,a,i,o)}if(t!==D.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{l=this.openPopup(p,"msal",D.popUpWidth,D.popUpHeight),he.trackPopup(l)}catch(_){if(this.logger.info("popup_window_error:"+K),this.cacheStorage.setItem(v.ERROR,"popup_window_error"),this.cacheStorage.setItem(v.ERROR_DESC,K),o)return o(z.createPopupWindowError()),[2]}if(!l)return[3,8];y.label=5;case 5:return y.trys.push([5,7,,8]),[4,he.monitorPopupForHash(l,this.config.system.loadFrameTimeout,p,this.logger)];case 6:return h=y.sent(),this.handleAuthenticationResponse(h),this.cacheStorage.removeItem(g.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",h),he.closePopups(),[3,8];case 7:return m=y.sent(),o&&o(m),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",m.errorCode+D.resourceDelimiter+m.errorMessage):(this.cacheStorage.removeItem(g.INTERACTION_STATUS),l.close()),[3,8];case 8:return[3,10];case 9:r.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==r.onRedirectNavigate(p)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(p)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(p)),y.label=10;case 10:return[3,12];case 11:return f=y.sent(),this.logger.error(f),this.cacheStorage.resetTempCacheItems(r.state),this.authErrorHandler(t,z.createEndpointResolutionError(f.toString),Ce(r.state),o),l&&l.close(),[3,12];case 12:return[2]}})})},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw Q.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw Q.createSsoSilentError();return this.acquireTokenSilent(U.a({},e,{scopes:D.oidcScopes}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var n=ue.validateRequest(e,!1,this.clientId,D.interactionTypeSilent),r=this.telemetryManager.createAndStartApiEvent(n.correlationId,Oe.AcquireTokenSilent),i=ue.createRequestSignature(n);return new Promise(function(e,r){return U.b(t,void 0,void 0,function(){var t,o,a,s,c,l,u,d,p,h;return U.e(this,function(m){switch(m.label){case 0:if(he.blockReloadInHiddenIframes(),t=n.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),n.account?(o=n.account,this.logger.verbose("Account set from request")):(o=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),a=this.cacheStorage.getItem(D.adalIdToken),!o&&!n.sid&&!n.loginHint&&B.isEmpty(a))return this.logger.info("User login is required"),[2,r(z.createUserLoginRequiredError())];if(s=this.getTokenType(o,n.scopes),this.logger.verbose("Response type: "+s),c=new Z(ge.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata),this.clientId,s,this.getRedirectUri(n.redirectUri),n.scopes,n.state,n.correlationId),this.logger.verbose("Finished building server authentication request"),Z.isSSOParam(n)||o?(c.populateQueryParams(o,n,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):o||B.isEmpty(a)?this.logger.verbose("No additional query parameters added"):(l=ae.extractIdToken(a),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),c.populateQueryParams(o,null,l,!0)),!(u=n.claimsRequest||c.claimsValue)&&!n.forceRefresh)try{p=this.getCachedToken(c,o)}catch(g){d=g}return p?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(p.scopes)),e(p),[2,null]):[3,1];case 1:return d?(this.logger.infoPii(d.errorCode+":"+d.errorMessage),r(d),[2,null]):[3,2];case 2:this.logger.verbose(u?"Skipped cache lookup since claims were given":n.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup"),c.authorityInstance||(c.authorityInstance=n.authority?ge.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+c.authority),m.label=3;case 3:return m.trys.push([3,7,,8]),c.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,ge.saveMetadataFromNetwork(c.authorityInstance,this.telemetryManager,n.correlationId)]);case 4:return m.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),m.label=6;case 6:return window.activeRenewals[i]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[i],i,e,r)):n.scopes&&X.onlyContainsOidcScopes(n.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(i,e,r,o,c)):(this.logger.verbose("Renewing access token"),this.renewToken(i,e,r,o,c)),[3,8];case 7:return h=m.sent(),this.logger.error(h),r(z.createEndpointResolutionError(h.toString())),[2,null];case 8:return[2]}})})}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,r,!1,e.errorCode),e})},e.prototype.openPopup=function(e,t,n,r){this.logger.verbose("OpenPopup has been called");try{var i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=window.open(e,t,"width="+n+", height="+r+", top="+(s/2-r/2+o)+", left="+(a/2-n/2+i)+", scrollbars=yes");if(!c)throw z.createPopupWindowError();return c.focus&&c.focus(),c}catch(l){throw this.cacheStorage.removeItem(g.INTERACTION_STATUS),z.createPopupWindowError(l.toString())}},e.prototype.loadIframeTimeout=function(e,t,n){return U.b(this,void 0,void 0,function(){var r,i,o,a,s;return U.e(this,function(c){switch(c.label){case 0:return r=window.activeRenewals[n],this.logger.verbosePii("Set loading state to pending for: "+n+":"+r),this.cacheStorage.setItem(de.generateTemporaryCacheKey(g.RENEW_STATUS,r),D.inProgress),this.config.system.navigateFrameWait?[4,he.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return o=c.sent(),[3,3];case 2:o=he.loadFrameSync(e,t,this.logger),c.label=3;case 3:i=o,c.label=4;case 4:return c.trys.push([4,6,,7]),[4,he.monitorIframeForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(a=c.sent())&&this.handleAuthenticationResponse(a),[3,7];case 6:throw s=c.sent(),this.cacheStorage.getItem(de.generateTemporaryCacheKey(g.RENEW_STATUS,r))===D.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+n+":"+r),r&&window.callbackMappedToRenewStates[r]&&window.callbackMappedToRenewStates[r](null,s),this.cacheStorage.removeItem(de.generateTemporaryCacheKey(g.RENEW_STATUS,r))),he.removeHiddenIframe(i),s;case 7:return he.removeHiddenIframe(i),[2]}})})},e.prototype.navigateWindow=function(e,t){if(!e||B.isEmpty(e))throw this.logger.info("Navigate url is empty"),F.createUnexpectedError("Navigate url is empty");var n=t||window;this.logger.infoPii(t?"Navigated Popup window to:"+e:"Navigate to:"+e),n.location.assign(e)},e.prototype.registerCallback=function(e,t,n,r){var i=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:n,reject:r}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(n,r){window.activeRenewals[t]=null;for(var o=0;o<window.promiseMappedToRenewStates[e].length;++o)try{if(r)window.promiseMappedToRenewStates[e][o].reject(r);else{if(!n)throw i.cacheStorage.resetTempCacheItems(e),F.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][o].resolve(n)}}catch(a){i.logger.warning(a)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return U.b(this,void 0,void 0,function(){var t,n,r,i,o,a;return U.e(this,function(s){switch(s.label){case 0:t=e||M.createNewGuid(),n=this.telemetryManager.createAndStartApiEvent(t,Oe.Logout),this.clearCache(),this.account=null,s.label=1;case 1:return s.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,ge.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:return r="client-request-id="+t,i=void 0,this.getPostLogoutRedirectUri()?(i="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(i="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),o=void 0,this.authorityInstance.EndSessionEndpoint?(o=this.authorityInstance.EndSessionEndpoint+"?"+r+i,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(o=this.authority+"oauth2/v2.0/logout?"+r+i,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,n,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(o),[3,6];case 5:return a=s.sent(),this.telemetryManager.stopAndFlushApiEvent(t,n,!1,a.errorCode),[3,6];case 6:return[2]}})})},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(D.clientId,D.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(D.clientId,D.homeAccountIdentifier),n=0;n<t.length;n++){var r=t[n];r.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(r.key)),this.logger.verbosePii("Access token removed: "+r.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),J.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,n){var r,i;this.logger.info("ProcessCallBack has been called. Processing callback from redirect response"),t||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),t=this.getResponseState(e));try{r=this.saveTokenFromHash(e,t)}catch(a){i=a}try{this.cacheStorage.clearMsalCookie(t.state);var o=this.getAccountState(t.state);if(r){if(t.requestType===D.renewToken||r.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+m.ACCESS_TOKEN),r.tokenType=m.ACCESS_TOKEN):t.requestType===D.login&&(this.logger.verbose("Response tokenType set to "+m.ID_TOKEN),r.tokenType=m.ID_TOKEN),!n)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=r)}else if(!n)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=Ce(o),this.redirectError=i,void this.cacheStorage.resetTempCacheItems(t.state);this.logger.verbose("Calling callback provided to processCallback"),n(r,i)}catch(a){throw this.logger.error("Error occurred in token received callback function: "+a),z.createErrorInCallbackFunction(a.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,n=this.getResponseState(t);this.logger.verbose("Obtained state from response");var r=window.callbackMappedToRenewStates[n.state];this.processCallBack(t,n,r)},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),he.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var n=this.cacheStorage.getItem(de.generateTemporaryCacheKey(g.LOGIN_REQUEST,t.state),this.inCookie);if(!n||"null"===n)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var r=J.removeHashFromUrl(window.location.href),i=J.removeHashFromUrl(n);if(r!==i)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+r+", finalRedirectUrl: "+i),void window.location.assign(""+i+e);this.logger.verbose("Current url matches login request url");var o=J.GetUrlComponents(n);o.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=o.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,n=J.deserializeHash(e);if(!n)throw F.createUnexpectedError("Hash was not parsed correctly.");if(!n.hasOwnProperty(m.STATE))throw F.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var r=ue.parseLibraryState(n.state);if((t={requestType:D.unknown,state:n.state,timestamp:r.ts,method:r.method,stateMatch:!1}).state===this.cacheStorage.getItem(de.generateTemporaryCacheKey(g.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=D.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(de.generateTemporaryCacheKey(g.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=D.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var i=window.renewStates,o=0;o<i.length;o++)if(i[o]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var n=e.scopes,r=this.getCachedIdToken(e,t),i=this.getCachedAccessToken(e,t,n),o=this.getAccountState(e.state);return me.buildAuthResponse(r,i,e,t,n,o)},e.prototype.getTokenCacheItemByAuthority=function(e,t,n,r){var i,o=this;return 1===(i=J.isCommonAuthority(e)||J.isOrganizationsAuthority(e)||J.isConsumersAuthority(e)?ct.filterTokenCacheItemsByDomain(t,J.GetUrlComponents(e).HostNameAndPort):ct.filterTokenCacheItemsByAuthority(t,e)).length?i[0]:i.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),i.forEach(function(e){o.cacheStorage.removeItem(JSON.stringify(e.key))}),null):(this.logger.verbose("No matching tokens of type "+r+" found"),null)},e.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var n=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),r=this.getTokenCacheItemByAuthority(e.authority||this.authority,n,null,m.ID_TOKEN);if(r){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(r)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var i=r.value;return this.logger.verbose(i?"ID Token found in cache is valid and unexpired":"ID Token found in cache is invalid"),i?new se(i.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(r.key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getCachedAccessToken=function(e,t,n){this.logger.verbose("Getting all cached tokens of type Access Token");var r=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),i=ct.filterTokenCacheItemsByScope(r,n),o=this.getTokenCacheItemByAuthority(e.authority||this.authority,i,n,m.ACCESS_TOKEN);if(o){if(e.authorityInstance=ge.CreateInstance(o.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(o)){if(this.logger.verbose("Access token expiration is within offset, using access token found in cache"),!t&&!(t=this.getAccount()))throw F.createUnexpectedError("Account should not be null here.");var a=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:m.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:o.value.accessToken,scopes:o.key.scopes.split(" "),expiresOn:new Date(1e3*Number(o.value.expiresIn)),account:t,accountState:a,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(o.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},e.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return ae.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(D.adalIdToken);return B.isEmpty(e)?null:ae.extractIdToken(e)},e.prototype.renewToken=function(e,t,n,r,i){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var o=he.generateFrameName("msalRenewFrame",e);he.addHiddenIFrame(o,this.logger),this.updateCacheEntries(i,r,!1),this.logger.verbosePii("RenewToken expected state: "+i.state);var a=J.urlRemoveQueryStringParameter(J.createNavigateUrl(i),D.prompt)+D.prompt_none+D.response_mode_fragment;window.renewStates.push(i.state),window.requestType=D.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(i.state,e,t,n),this.logger.infoPii("Navigate to: "+a),this.loadIframeTimeout(a,o,e).catch(function(e){return n(e)})},e.prototype.renewIdToken=function(e,t,n,r,i){this.logger.info("RenewIdToken has been called");var o=he.generateFrameName("msalIdTokenFrame",e);he.addHiddenIFrame(o,this.logger),this.updateCacheEntries(i,r,!1),this.logger.verbose("RenewIdToken expected state: "+i.state);var a=J.urlRemoveQueryStringParameter(J.createNavigateUrl(i),D.prompt)+D.prompt_none+D.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=D.login,this.silentAuthenticationState=i.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=D.renewToken,window.renewStates.push(i.state)),this.registerCallback(i.state,e,t,n),this.logger.infoPii('Navigate to:" '+a),this.loadIframeTimeout(a,o,e).catch(function(e){return n(e)})},e.prototype.saveToken=function(e,t,n,r,i){var o=new Y(t,this.clientId,n,r.uid,r.utid),a=new $(e.accessToken,e.idToken.rawIdToken,i.toString(),r.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(o),JSON.stringify(a)),i?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*i)):this.logger.error("Could not parse expiresIn parameter for access token"),e},e.prototype.saveIdToken=function(e,t,n,r,i){this.logger.verbose("SaveIdToken has been called");var o=U.a({},e);o.scopes=D.oidcScopes,o.accessToken=n[m.ID_TOKEN];var a=Number(i.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(o,t,void 0,r,a)},e.prototype.saveAccessToken=function(e,t,n,r){this.logger.verbose("SaveAccessToken has been called");var i=U.a({},e),o=n[m.SCOPE],a=o.split(" "),s=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var c=0;c<s.length;c++){var l=s[c];if(l.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var u=l.key.scopes.split(" ");X.isIntersectingScopes(u,a)&&this.cacheStorage.removeItem(JSON.stringify(l.key))}}i.accessToken=n[m.ACCESS_TOKEN],i.scopes=a;var d=oe.parseExpiresIn(n[m.EXPIRES_IN]),p=ue.parseLibraryState(n[m.STATE]).ts+d;return this.logger.verbose("Saving access token to cache"),this.saveToken(i,t,o,r,p)},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var n,r={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},i=J.deserializeHash(e),o="",a="",s=null;if(i.hasOwnProperty(m.ERROR_DESCRIPTION)||i.hasOwnProperty(m.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+i[m.ERROR]+"; Error description: "+i[m.ERROR_DESCRIPTION]),this.cacheStorage.setItem(v.ERROR,i[m.ERROR]),this.cacheStorage.setItem(v.ERROR_DESC,i[m.ERROR_DESCRIPTION]),t.requestType===D.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(v.LOGIN_ERROR,i[m.ERROR_DESCRIPTION]+":"+i[m.ERROR]),o=de.generateAuthorityKey(t.state)),t.requestType===D.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),o=de.generateAuthorityKey(t.state);var c=this.getAccount(),l=void 0;c&&!B.isEmpty(c.homeAccountIdentifier)?(l=c.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(l=D.no_account,this.logger.verbose("AccountId is set as no_account")),a=de.generateAcquireTokenAccountKey(l,t.state)}var u=i[m.ERROR_DESCRIPTION];n=we.isInteractionRequiredError(i[m.ERROR])||we.isInteractionRequiredError(u)?new we(i[m.ERROR],i[m.ERROR_DESCRIPTION]):new Ee(i[m.ERROR],i[m.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),i.hasOwnProperty(m.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(de.generateTemporaryCacheKey(g.SESSION_STATE,t.state),i[m.SESSION_STATE])),r.accountState=this.getAccountState(t.state);var d=void 0;if(i.hasOwnProperty(m.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),r.accessToken=i[m.ACCESS_TOKEN],i.hasOwnProperty(m.SCOPE)&&(r.scopes=i[m.SCOPE].split(" ")),i.hasOwnProperty(m.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),s=new se(i[m.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),s=new se(this.cacheStorage.getItem(f.IDTOKEN))),r=me.setResponseIdToken(r,s);var p=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s);this.logger.verbose("Got authority from cache"),i.hasOwnProperty(m.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),d=new ie(i[m.CLIENT_INFO],p)):this.authorityInstance.AuthorityType===j.Adfs?d=ie.createClientInfoFromIdToken(s,p):this.logger.warning("ClientInfo not received in the response from AAD"),r.account=pe.createAccount(s,d),this.logger.verbose("Account object created from response");var h=void 0;r.account&&!B.isEmpty(r.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),h=r.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),h=D.no_account),a=de.generateAcquireTokenAccountKey(h,t.state);var y=de.generateAcquireTokenAccountKey(D.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var _=this.cacheStorage.getItem(a),S=void 0;B.isEmpty(_)?B.isEmpty(this.cacheStorage.getItem(y))||(this.logger.verbose("No acquireToken account retrieved from cache"),r=this.saveAccessToken(r,p,i,d)):(S=JSON.parse(_),this.logger.verbose("AcquireToken request account retrieved from cache"),r.account&&S&&pe.compareAccounts(r.account,S)?(r=this.saveAccessToken(r,p,i,d),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(i.hasOwnProperty(m.ID_TOKEN))if(this.logger.info("Fragment has idToken"),s=new se(i[m.ID_TOKEN]),p=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,s),r=me.setResponseIdToken(r,s),i.hasOwnProperty(m.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),d=new ie(i[m.CLIENT_INFO],p)):this.authorityInstance.AuthorityType===j.Adfs?d=ie.createClientInfoFromIdToken(s,p):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=pe.createAccount(s,d),r.account=this.account,this.logger.verbose("Account object created from response"),s&&s.nonce){this.logger.verbose("IdToken has nonce");var E=this.cacheStorage.getItem(de.generateTemporaryCacheKey(g.NONCE_IDTOKEN,t.state),this.inCookie);s.nonce!==E?(this.account=null,this.cacheStorage.setItem(v.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+E+",Actual Nonce: "+s.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+E+", Actual Nonce: "+s.nonce),n=z.createNonceMismatchError(E,s.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(f.IDTOKEN,i[m.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(f.CLIENT_INFO,d.encodeClientInfo(),this.inCookie),this.saveIdToken(r,p,i,d,s))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),o=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),n=z.createInvalidIdTokenError(s),this.cacheStorage.setItem(v.ERROR,n.errorCode),this.cacheStorage.setItem(v.ERROR_DESC,n.errorMessage)}else{this.logger.verbose("State mismatch"),o=t.state,a=t.state;var b=this.cacheStorage.getItem(de.generateTemporaryCacheKey(g.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+b+", Actual State: "+t.state),n=z.createInvalidStateError(t.state,b),this.cacheStorage.setItem(v.ERROR,n.errorCode),this.cacheStorage.setItem(v.ERROR_DESC,n.errorMessage)}if(this.cacheStorage.removeItem(de.generateTemporaryCacheKey(g.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(o,"",-1),this.cacheStorage.clearMsalCookie(t.state)),n)throw n;if(!r)throw F.createUnexpectedError("Response is null");return r},e.prototype.populateAuthority=function(e,t,n,r){this.logger.verbose("PopulateAuthority has been called");var i=de.generateAuthorityKey(e),o=n.getItem(i,t);return B.isEmpty(o)?o:J.replaceTenantPath(o,r.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(f.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(f.CLIENT_INFO,this.inCookie);if(!B.isEmpty(e)&&!B.isEmpty(t)){var n=new se(e),r=new ie(t,"");return this.account=pe.createAccount(n,r),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(D.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(D.clientId,D.homeAccountIdentifier),n=0;n<t.length;n++){var r=new se(t[n].value.idToken),i=new ie(t[n].value.homeAccountIdentifier,""),o=pe.createAccount(r,i);e.push(o)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],n=[],r=0;r<e.length;++r)e[r].homeAccountIdentifier&&-1===t.indexOf(e[r].homeAccountIdentifier)&&(t.push(e[r].homeAccountIdentifier),n.push(e[r]));return n},e.prototype.broadcast=function(e,t){var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},e.prototype.getCachedTokenInternal=function(e,t,n,r){var i=t||this.getAccount();if(!i)return null;var o=this.authorityInstance?this.authorityInstance:ge.CreateInstance(this.authority,this.config.auth.validateAuthority),a=this.getTokenType(i,e),s=new Z(o,this.clientId,a,this.getRedirectUri(),e,n,r);return this.getCachedToken(s,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var n=0,r=Array.from(this.config.framework.protectedResourceMap.keys());n<r.length;n++){var i=r[n];if(e.indexOf(i)>-1)return this.config.framework.protectedResourceMap.get(i)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?J.getHostFromUri(e)===J.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(g.INTERACTION_STATUS)===D.inProgress},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(g.INTERACTION_STATUS,D.inProgress):this.cacheStorage.removeItem(g.INTERACTION_STATUS)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(g.INTERACTION_STATUS)===D.inProgress},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw Q.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t){var n=pe.compareAccounts(e,this.getAccount());return Z.determineResponseType(n,t)},e.prototype.setAccountCache=function(e,t){var n=e?this.getAccountId(e):D.no_account,r=de.generateAcquireTokenAccountKey(n,t);this.cacheStorage.setItem(r,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var n=de.generateAuthorityKey(e);this.cacheStorage.setItem(n,J.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,n,r){r&&this.cacheStorage.setItem(de.generateTemporaryCacheKey(g.LOGIN_REQUEST,e.state),r,this.inCookie),n?this.cacheStorage.setItem(de.generateTemporaryCacheKey(g.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(de.generateTemporaryCacheKey(g.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return B.isEmpty(e.homeAccountIdentifier)?D.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:D.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return st.getTelemetrymanagerStub(t,this.logger);var n=e.applicationName,r=e.applicationVersion,i=e.telemetryEmitter;if(!n||!r||!i)throw Q.createTelemetryConfigError(e);return new st({platform:{applicationName:n,applicationVersion:r},clientId:t},i,this.logger)},e}(),ut=n("QkXj"),dt=n("4Fy5"),pt=n("JqCM"),ht=((We=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).initialized=!1,r.name=e.name,r.clientId=e.clientId,r.additionalParams=e.additionalParams,r.icon=e.name.toLowerCase(),r}return n}(O.Vb)).FACEBOOK="Facebook",We.GOOGLE="Google",We.MICROSOFT="Microsoft",We.OPENID="OpenIdConnect",We.WSFEDERATION="WsFederation",We.TWITTER="Twitter",We),mt=((ze=function(){function e(t,n,r,i,o,a,s,c,l){_classCallCheck(this,e),this._tokenAuthService=t,this._router=n,this._messageService=r,this._tokenService=i,this._logService=o,this.oauthService=a,this.spinnerService=s,this._localStorageService=c,this._twitterService=l,this.externalLoginProviders=[],this.localizationSourceName=w.a.localization.defaultLocalizationSourceName,this.clear()}return _createClass(e,[{key:"authenticate",value:function(t,n,r){var i=this;t=t||function(){i.spinnerService.hide()};var o=this;this._localStorageService.getItem(e.twoFactorRememberClientTokenName,function(e,i){o.authenticateModel.twoFactorRememberClientToken=null==i?void 0:i.token,o.authenticateModel.singleSignIn=A.a.getSingleSignIn(),o.authenticateModel.returnUrl=A.a.getReturnUrl(),o.authenticateModel.captchaResponse=r,o._tokenAuthService.authenticate(o.authenticateModel).subscribe({next:function(e){o.processAuthenticateResult(e,n),t()},error:function(e){t()}})})}},{key:"externalAuthenticate",value:function(e){var t=this;this.ensureExternalLoginProviderInitialized(e,function(){if(e.name===ht.FACEBOOK)FB.login(function(e){t.facebookLoginStatusChangeCallback(e)},{scope:"email"});else if(e.name===ht.GOOGLE)gapi.auth2.getAuthInstance().signIn().then(function(){t.googleLoginStatusChangeCallback(gapi.auth2.getAuthInstance().isSignedIn.get())});else if(e.name===ht.MICROSOFT){var n=["user.read"];t.spinnerService.show(),t.MSAL.loginPopup({scopes:n}).then(function(e){t.MSAL.acquireTokenSilent({scopes:n}).then(function(e){t.microsoftLoginCallback(e),t.spinnerService.hide()}).catch(function(e){abp.log.error(e),abp.message.error(t.localization.localize("CouldNotValidateExternalUser",t.localizationSourceName))})})}else e.name===ht.TWITTER&&t.startTwitterLogin()})}},{key:"init",value:function(){this.initExternalLoginProviders()}},{key:"processAuthenticateResult",value:function(e,t){this.authenticateResult=e,e.shouldResetPassword?(this._router.navigate(["account/reset-password"],{queryParams:{userId:e.userId,tenantId:abp.session.tenantId,resetCode:e.passwordResetCode}}),this.clear()):e.requiresTwoFactorVerification?this._router.navigate(["account/send-code"]):e.accessToken?(e.returnUrl&&!t&&(t=e.returnUrl),this.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,this.rememberMe,e.twoFactorRememberClientToken,t)):(this._logService.warn("Unexpected authenticateResult!"),this._router.navigate(["account/login"]))}},{key:"login",value:function(t,n,r,i,o,a,s,c){var l=a?new Date((new Date).getTime()+1e3*r):void 0;if(this._tokenService.setToken(t,l),i&&a){var u=a?new Date((new Date).getTime()+1e3*o):void 0;this._tokenService.setRefreshToken(i,u)}if(this._localStorageService.setItem(w.a.authorization.encrptedAuthTokenName,{token:n,expireDate:l}),s&&this._localStorageService.setItem(e.twoFactorRememberClientTokenName,{token:s,expireDate:new Date((new Date).getTime()+31536e6)}),c)location.href=c;else{var d=A.a.initialUrl;d.indexOf("/account")>0&&(d=w.a.appBaseUrl),location.href=d}}},{key:"clear",value:function(){this.authenticateModel=new O.o,this.authenticateModel.rememberClient=!1,this.authenticateResult=null,this.rememberMe=!1}},{key:"initExternalLoginProviders",value:function(e){var t=this;this._tokenAuthService.getExternalAuthenticationProviders().subscribe(function(n){t.externalLoginProviders=Object(R.a)(n,function(e){return new ht(e)}),e&&e()})}},{key:"ensureExternalLoginProviderInitialized",value:function(e,t){var n=this;if(e.initialized)t();else if(e.name===ht.FACEBOOK)(new x.a).load("//connect.facebook.net/en_US/sdk.js").then(function(){FB.init({appId:e.clientId,cookie:!1,xfbml:!0,version:"v2.5"}),FB.getLoginStatus(function(e){n.facebookLoginStatusChangeCallback(e),"connected"!==e.status&&t()})});else if(e.name===ht.GOOGLE)(new x.a).load("https://apis.google.com/js/api.js").then(function(){gapi.load("client:auth2",function(){gapi.client.init({clientId:e.clientId,scope:"openid profile email"}).then(function(){t()})})});else if(e.name===ht.MICROSOFT)this.MSAL=new lt({auth:{clientId:e.clientId,redirectUri:w.a.appBaseUrl}}),t();else if(e.name===ht.OPENID){var r=this.getOpenIdConnectConfig(e);this.oauthService.configure(r),this.oauthService.initImplicitFlow("openIdConnect=1")}else if(e.name===ht.WSFEDERATION){var i=this.getWsFederationConnectConfig(e);this.wsFederationAuthenticationContext=new L(i),this.wsFederationAuthenticationContext.login()}else e.name===ht.TWITTER&&t()}},{key:"getWsFederationConnectConfig",value:function(e){var t={clientId:e.clientId,popUp:!0,callback:this.wsFederationLoginStatusChangeCallback.bind(this)};return e.additionalParams.Tenant&&(t.tenant=e.additionalParams.Tenant),t}},{key:"getOpenIdConnectConfig",value:function(e){var t=new N.a;return t.loginUrl=e.additionalParams.LoginUrl,t.issuer=e.additionalParams.Authority,t.skipIssuerCheck="false"===e.additionalParams.ValidateIssuer,t.clientId=e.clientId,t.responseType="id_token",t.redirectUri=window.location.origin+"/account/login",t.scope="openid profile",t.requestAccessToken=!1,t}},{key:"facebookLoginStatusChangeCallback",value:function(e){var t=this;if("connected"===e.status){var n=new O.Ub;n.authProvider=ht.FACEBOOK,n.providerAccessCode=e.authResponse.accessToken,n.providerKey=e.authResponse.userID,n.singleSignIn=A.a.getSingleSignIn(),n.returnUrl=A.a.getReturnUrl(),this._tokenAuthService.externalAuthenticate(n).subscribe(function(e){e.waitingForActivation?t._messageService.info("You have successfully registered. Waiting for activation!"):t.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl)})}}},{key:"openIdConnectLoginCallback",value:function(e){var t=this;this.initExternalLoginProviders(function(){var e=Object(k.a)(t.externalLoginProviders,{name:"OpenIdConnect"})[0],n=t.getOpenIdConnectConfig(e);t.oauthService.configure(n),t.spinnerService.show(),t.oauthService.tryLogin().then(function(){var e=t.oauthService.getIdentityClaims(),n=new O.Ub;n.authProvider=ht.OPENID,n.providerAccessCode=t.oauthService.getIdToken(),n.providerKey=e.sub,n.singleSignIn=A.a.getSingleSignIn(),n.returnUrl=A.a.getReturnUrl(),t._tokenAuthService.externalAuthenticate(n).pipe(Object(P.a)(function(){t.spinnerService.hide()})).subscribe(function(e){e.waitingForActivation?t._messageService.info("You have successfully registered. Waiting for activation!"):t.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl)})})})}},{key:"startTwitterLogin",value:function(){var e=this;this.spinnerService.show(),this._twitterService.getRequestToken().pipe(Object(P.a)(function(){return e.spinnerService.hide()})).subscribe(function(t){t.confirmed?window.location.href=t.redirectUrl:e._messageService.error("Couldn't get twitter request token !")})}},{key:"twitterLoginCallback",value:function(e,t){var n=this;this.spinnerService.show(),this._twitterService.getAccessToken(e,t).subscribe(function(e){var t=new O.Ub;t.authProvider=ht.TWITTER,t.providerAccessCode=e.accessToken+"&"+e.accessTokenSecret,t.providerKey=e.userId,t.singleSignIn=A.a.getSingleSignIn(),t.returnUrl=A.a.getReturnUrl(),n._tokenAuthService.externalAuthenticate(t).pipe(Object(P.a)(function(){n.spinnerService.hide()})).subscribe(function(e){e.waitingForActivation?n._messageService.info("You have successfully registered. Waiting for activation!"):n.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl)})})}},{key:"googleLoginStatusChangeCallback",value:function(e){var t=this;if(e){var n=new O.Ub;n.authProvider=ht.GOOGLE,n.providerAccessCode=gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token,n.providerKey=gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile().getId(),n.singleSignIn=A.a.getSingleSignIn(),n.returnUrl=A.a.getReturnUrl(),this._tokenAuthService.externalAuthenticate(n).subscribe(function(e){e.waitingForActivation?t._messageService.info("You have successfully registered. Waiting for activation!"):t.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl)})}}},{key:"wsFederationLoginStatusChangeCallback",value:function(e,t,n,r){var i=this,o=this.wsFederationAuthenticationContext.getCachedUser(),a=new O.Ub;a.authProvider=ht.WSFEDERATION,a.providerAccessCode=t,a.providerKey=o.profile.sub,a.singleSignIn=A.a.getSingleSignIn(),a.returnUrl=A.a.getReturnUrl(),this._tokenAuthService.externalAuthenticate(a).subscribe(function(e){if(e.waitingForActivation)return i._messageService.info("You have successfully registered. Waiting for activation!"),void i._router.navigate(["account/login"]);i.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl)})}},{key:"microsoftLoginCallback",value:function(e){var t=this,n=new O.Ub;n.authProvider=ht.MICROSOFT,n.providerAccessCode=e.accessToken,n.providerKey=e.idToken.objectId,n.singleSignIn=A.a.getSingleSignIn(),n.returnUrl=A.a.getReturnUrl(),this.spinnerService.show(),this._tokenAuthService.externalAuthenticate(n).subscribe(function(e){e.waitingForActivation?t._messageService.info("You have successfully registered. Waiting for activation!"):(t.login(e.accessToken,e.encryptedAccessToken,e.expireInSeconds,e.refreshToken,e.refreshTokenExpireInSeconds,!1,"",e.returnUrl),t.spinnerService.hide())})}}]),e}()).twoFactorRememberClientTokenName="TwoFactorRememberClientToken",ze.\u0275fac=function(e){return new(e||ze)(l["\u0275\u0275inject"](O.ff),l["\u0275\u0275inject"](I.e),l["\u0275\u0275inject"](dt.h),l["\u0275\u0275inject"](dt.m),l["\u0275\u0275inject"](dt.g),l["\u0275\u0275inject"](N.c),l["\u0275\u0275inject"](pt.c),l["\u0275\u0275inject"](ut.a),l["\u0275\u0275inject"](O.gf))},ze.\u0275prov=l["\u0275\u0275defineInjectable"]({token:ze,factory:ze.\u0275fac}),ze),gt=n("NBh3");function ft(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",3),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](n);var e=t.$implicit;return l["\u0275\u0275nextContext"](2).changeLanguage(e)}),l["\u0275\u0275element"](1,"i"),l["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit;l["\u0275\u0275propertyInterpolate"]("title",r.displayName),l["\u0275\u0275advance"](1),l["\u0275\u0275classMap"](r.icon),l["\u0275\u0275attribute"]("aria-label",r.displayName)}}function vt(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",1),l["\u0275\u0275template"](1,ft,2,5,"div",2),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",n.languages)}}var yt,_t=((yt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).languages=[],r}return _createClass(n,[{key:"ngOnInit",value:function(){this.languages=Object(k.a)(abp.localization.languages,function(e){return!1===e.isDisabled}),this.currentLanguage=abp.localization.currentLanguage}},{key:"changeLanguage",value:function(e){abp.utils.setCookieValue("Abp.Localization.CultureName",e.name,new Date((new Date).getTime()+15768e7),abp.appPath),location.reload()}}]),n}(C.a)).\u0275fac=function(e){return new(e||yt)(l["\u0275\u0275directiveInject"](l.Injector))},yt.\u0275cmp=l["\u0275\u0275defineComponent"]({type:yt,selectors:[["language-switch"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[["class","ml-1 mx-auto",4,"ngIf"],[1,"ml-1","mx-auto"],["class","btn language-switch-btn btn-clean btn-icon p-0 m-0",3,"title","click",4,"ngFor","ngForOf"],[1,"btn","language-switch-btn","btn-clean","btn-icon","p-0","m-0",3,"title","click"]],template:function(e,t){1&e&&l["\u0275\u0275template"](0,vt,2,1,"div",0),2&e&&l["\u0275\u0275property"]("ngIf",t.languages.length>1)},directives:[r.n,r.m],styles:[".language-switch-btn[_ngcontent-%COMP%] { width: auto; height: auto; }"]}),yt),St=n("GWLn"),Et=n("S8ex"),bt=n("kPyj"),It=["tenantChangeModal"],Tt=["tenancyNameInput"];function wt(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"span",25),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"TenancyNameRequired")," "))}var Ct=function(e){return{edited:e}};function kt(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"form",5,6),l["\u0275\u0275listener"]("ngSubmit",function(){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().save()}),l["\u0275\u0275elementStart"](2,"div",7),l["\u0275\u0275elementStart"](3,"h5",8),l["\u0275\u0275elementStart"](4,"span"),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"button",9),l["\u0275\u0275listener"]("click",function(){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().close()}),l["\u0275\u0275element"](8,"i",10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](9,"div",11),l["\u0275\u0275elementStart"](10,"div",12),l["\u0275\u0275elementStart"](11,"label",13),l["\u0275\u0275text"](12),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](14,"div",14),l["\u0275\u0275elementStart"](15,"span",15),l["\u0275\u0275elementStart"](16,"label"),l["\u0275\u0275elementStart"](17,"input",16),l["\u0275\u0275listener"]("ngModelChange",function(e){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().isSwitchToTenant=e})("change",function(e){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().switchToTenant(e)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](18,"span"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](19,"div",17),l["\u0275\u0275elementStart"](20,"label",13),l["\u0275\u0275elementStart"](21,"label"),l["\u0275\u0275text"](22),l["\u0275\u0275pipe"](23,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](24,"label",14),l["\u0275\u0275elementStart"](25,"input",18,19),l["\u0275\u0275listener"]("ngModelChange",function(e){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().tenancyName=e}),l["\u0275\u0275pipe"](27,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](28,wt,3,3,"span",20),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](29,"div",21),l["\u0275\u0275elementStart"](30,"button",22),l["\u0275\u0275listener"]("click",function(){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().close()}),l["\u0275\u0275text"](31),l["\u0275\u0275pipe"](32,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](33,"button",23),l["\u0275\u0275element"](34,"i",24),l["\u0275\u0275elementStart"](35,"span"),l["\u0275\u0275text"](36),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275reference"](1),i=l["\u0275\u0275reference"](26),o=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](6,16,"ChangeTenant")),l["\u0275\u0275advance"](7),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](13,18,"SwitchToTenant")),l["\u0275\u0275advance"](5),l["\u0275\u0275propertyInterpolate"]("value",o.isSwitchToTenant?"true":"false"),l["\u0275\u0275property"]("ngModel",o.isSwitchToTenant),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](23,20,"TenancyName")),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate"]("placeholder",o.isSwitchToTenant?l["\u0275\u0275pipeBind1"](27,22,"EnterTenancyName"):""),l["\u0275\u0275property"]("ngClass",l["\u0275\u0275pureFunction1"](26,Ct,o.tenancyName))("ngModel",o.tenancyName)("disabled",!o.isSwitchToTenant),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",o.isSwitchToTenant&&!i.pristine&&!o.tenancyName),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",o.saving),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](32,24,"Cancel")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!r.form.valid)("buttonBusy",o.saving)("busyText",o.l("ProcessingWithThreeDot")),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](o.submitButtonText)}}var At,Ot=function(){return{backdrop:"static"}},xt=((At=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this,r))._accountService=e,i.tenancyName="",i.tenancyNameBuffer="",i.submitButtonText="",i.isSwitchToTenant=!1,i.active=!1,i.saving=!1,i}return _createClass(n,[{key:"focusTenancyNameInput",value:function(){setTimeout(function(){document.getElementById("tenancyNameInput").focus()},100)}},{key:"updateSubmitButtonText",value:function(){this.submitButtonText=this.l(this.isSwitchToTenant?"SwitchToTheTenant":"SwitchToTheHost")}},{key:"show",value:function(e){this.tenancyName=e,this.isSwitchToTenant=!!e,this.updateSubmitButtonText(),this.active=!0,this.modal.show()}},{key:"onShown",value:function(){this.focusTenancyNameInput()}},{key:"switchToTenant",value:function(e){e.target.checked?(this.tenancyName=this.tenancyNameBuffer,this.focusTenancyNameInput()):(this.tenancyNameBuffer=this.tenancyName,this.tenancyName=""),this.updateSubmitButtonText()}},{key:"save",value:function(){var e=this;if(!this.tenancyName)return abp.multiTenancy.setTenantIdCookie(void 0),this.close(),void location.reload();var t=new O.Uc;t.tenancyName=this.tenancyName,this.saving=!0,this._accountService.isTenantAvailable(t).pipe(Object(P.a)(function(){e.saving=!1})).subscribe(function(t){switch(t.state){case O.Ke.Available:return abp.multiTenancy.setTenantIdCookie(t.tenantId),e.close(),void location.reload();case O.Ke.InActive:e.message.warn(e.l("TenantIsNotActive",e.tenancyName)),e.focusTenancyNameInput();break;case O.Ke.NotFound:e.message.warn(e.l("ThereIsNoTenantDefinedWithName{0}",e.tenancyName)),e.focusTenancyNameInput()}})}},{key:"close",value:function(){this.active=!1,this.modal.hide()}}]),n}(C.a)).\u0275fac=function(e){return new(e||At)(l["\u0275\u0275directiveInject"](O.b),l["\u0275\u0275directiveInject"](l.Injector))},At.\u0275cmp=l["\u0275\u0275defineComponent"]({type:At,selectors:[["tenantChangeModal"]],viewQuery:function(e,t){var n;1&e&&(l["\u0275\u0275viewQuery"](It,3),l["\u0275\u0275viewQuery"](Tt,3)),2&e&&(l["\u0275\u0275queryRefresh"](n=l["\u0275\u0275loadQuery"]())&&(t.modal=n.first),l["\u0275\u0275queryRefresh"](n=l["\u0275\u0275loadQuery"]())&&(t.tenancyNameInput=n.first))},features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:5,vars:3,consts:[["appBsModal","","tabindex","-1","role","dialog","aria-labelledby","tenantChangeModal","aria-hidden","true",1,"modal","fade",3,"config","onShown"],["tenantChangeModal","bs-modal"],[1,"modal-dialog"],[1,"modal-content"],["novalidate","","class","form form-label-right",3,"ngSubmit",4,"ngIf"],["novalidate","",1,"form","form-label-right",3,"ngSubmit"],["changeTenantForm","ngForm"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-hidden","true",1,"close",3,"click"],["aria-hidden","true",1,"ki","ki-close"],[1,"modal-body"],[1,"form-group","row","text-left","mb-0"],[1,"col-4","col-form-label"],[1,"col"],[1,"switch","switch-icon"],["checked","checked","name","SwitchToTenant","type","checkbox",3,"ngModel","value","ngModelChange","change"],[1,"form-group","row","mb-0"],["type","text","id","tenancyNameInput","name","tenancyNameInput","required","","maxlength","64",1,"form-control",3,"ngClass","ngModel","disabled","placeholder","ngModelChange"],["tenancyNameInput","ngModel"],["class","form-text text-danger text-left",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-light-primary","font-weight-bold",3,"disabled","click"],["type","submit",1,"btn","btn-primary","font-weight-bold","save-button",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-arrow-circle-right"],[1,"form-text","text-danger","text-left"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0,1),l["\u0275\u0275listener"]("onShown",function(){return t.onShown()}),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"div",3),l["\u0275\u0275template"](4,kt,37,28,"form",4),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("config",l["\u0275\u0275pureFunction0"](2,Ot)),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngIf",t.active))},directives:[St.a,r.n,a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,a.CheckboxControlValueAccessor,a.NgControlStatus,a.NgModel,a.DefaultValueAccessor,a.RequiredValidator,a.MaxLengthValidator,r.k,Et.a],pipes:[bt.a],encapsulation:2}),At),Rt=["tenantChangeModal"];function Pt(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span",4),l["\u0275\u0275elementStart"](1,"strong"),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](2);l["\u0275\u0275propertyInterpolate"]("title",n.name),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](n.tenancyName)}}function Nt(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](2,1,"NotSelected")))}function Lt(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275template"](3,Pt,3,2,"span",1),l["\u0275\u0275template"](4,Nt,3,3,"span",0),l["\u0275\u0275text"](5," ("),l["\u0275\u0275elementStart"](6,"a",2),l["\u0275\u0275listener"]("click",function(){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().showChangeModal()}),l["\u0275\u0275text"](7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](8,") "),l["\u0275\u0275element"](9,"tenantChangeModal",null,3),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,4,"CurrentTenant"),": "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",r.tenancyName),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!r.tenancyName),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](r.l("Change"))}}var Ut,Mt=((Ut=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this,e))._accountService=r,i}return _createClass(n,[{key:"ngOnInit",value:function(){this.appSession.tenant&&(this.tenancyName=this.appSession.tenant.tenancyName,this.name=this.appSession.tenant.name)}},{key:"isMultiTenancyEnabled",get:function(){return abp.multiTenancy.isEnabled}},{key:"showChangeModal",value:function(){this.tenantChangeModal.show(this.tenancyName)}}]),n}(C.a)).\u0275fac=function(e){return new(e||Ut)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](O.b))},Ut.\u0275cmp=l["\u0275\u0275defineComponent"]({type:Ut,selectors:[["tenant-change"]],viewQuery:function(e,t){var n;1&e&&l["\u0275\u0275viewQuery"](Rt,1),2&e&&l["\u0275\u0275queryRefresh"](n=l["\u0275\u0275loadQuery"]())&&(t.tenantChangeModal=n.first)},features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[[4,"ngIf"],[3,"title",4,"ngIf"],["href","javascript:;",3,"click"],["tenantChangeModal",""],[3,"title"]],template:function(e,t){1&e&&l["\u0275\u0275template"](0,Lt,11,6,"span",0),2&e&&l["\u0275\u0275property"]("ngIf",t.isMultiTenancyEnabled)},directives:[r.n,xt],pipes:[bt.a],encapsulation:2}),Ut);function Dt(e,t){if(1&e&&l["\u0275\u0275element"](0,"img",16),2&e){var n=l["\u0275\u0275nextContext"](2);l["\u0275\u0275property"]("src",n.appRootUrl()+"assets/common/images/app-logo-on-dark.svg",l["\u0275\u0275sanitizeUrl"])}}function jt(e,t){if(1&e&&l["\u0275\u0275element"](0,"img",16),2&e){var n=l["\u0275\u0275nextContext"](2);l["\u0275\u0275property"]("src",n.remoteServiceBaseUrl+"/TenantCustomization/GetTenantLogo?skin=light&tenantId="+n.appSession.tenant.id+"&id="+n.appSession.tenant.logoId,l["\u0275\u0275sanitizeUrl"])}}function Ht(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",11),l["\u0275\u0275elementStart"](1,"div",12),l["\u0275\u0275elementStart"](2,"a",13),l["\u0275\u0275listener"]("click",function(){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().goToHome()}),l["\u0275\u0275template"](3,Dt,1,1,"img",14),l["\u0275\u0275template"](4,jt,1,1,"img",14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](5,"div",15),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",!r.appSession.tenant||!r.appSession.tenant.logoId),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.appSession.tenant&&r.appSession.tenant.logoId)}}function qt(e,t){if(1&e&&l["\u0275\u0275element"](0,"img",16),2&e){var n=l["\u0275\u0275nextContext"](2);l["\u0275\u0275property"]("src",n.appRootUrl()+"assets/common/images/app-logo-on-light.svg",l["\u0275\u0275sanitizeUrl"])}}function Ft(e,t){if(1&e&&l["\u0275\u0275element"](0,"img",16),2&e){var n=l["\u0275\u0275nextContext"](2);l["\u0275\u0275property"]("src",n.remoteServiceBaseUrl+"/TenantCustomization/GetTenantLogo?skin=light&tenantId="+n.appSession.tenant.id+"&id="+n.appSession.tenant.logoId,l["\u0275\u0275sanitizeUrl"])}}function Bt(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"a",13),l["\u0275\u0275listener"]("click",function(){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().goToHome()}),l["\u0275\u0275template"](1,qt,1,1,"img",14),l["\u0275\u0275template"](2,Ft,1,1,"img",14),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!r.appSession.tenant||!r.appSession.tenant.logoId),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.appSession.tenant&&r.appSession.tenant.logoId)}}function Kt(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",17),l["\u0275\u0275element"](1,"tenant-change"),l["\u0275\u0275elementEnd"]())}var zt,Wt,Gt,Vt,Qt=function(e){return{"login-content":e}},Xt=((zt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a,s){var c;return _classCallCheck(this,n),(c=t.call(this,e))._router=r,c._loginService=i,c._uiCustomizationService=o,c._dateTimeService=a,c.currentYear=c._dateTimeService.getYear(),c.remoteServiceBaseUrl=w.a.remoteServiceBaseUrl,c.tenantChangeDisabledRoutes=["select-edition","buy","upgrade","extend","register-tenant","stripe-purchase","stripe-subscribe","stripe-update-subscription","paypal-purchase","stripe-payment-result","payment-completed","stripe-cancel-payment","session-locked","enrollment"],c.viewContainerRef=s,c}return _createClass(n,[{key:"showTenantChange",value:function(){var e=this;return!!this._router.url&&!Object(k.a)(this.tenantChangeDisabledRoutes,function(t){return e._router.url.indexOf("/account/"+t)>=0}).length&&abp.multiTenancy.isEnabled&&!this.supportsTenancyNameInUrl()}},{key:"useFullWidthLayout",value:function(){return this._router.url.indexOf("/account/select-edition")>=0||this._router.url.indexOf("/account/enrollment")>=0}},{key:"ngOnInit",value:function(){this._loginService.init(),document.body.className=this._uiCustomizationService.getAccountModuleBodyClass()}},{key:"goToHome",value:function(){window.location.href="/"}},{key:"getBgUrl",value:function(){return"url(./assets/metronic/themes/"+this.currentTheme.baseSettings.theme+"/images/bg/bg-4.jpg)"}},{key:"supportsTenancyNameInUrl",value:function(){return w.a.appBaseUrlFormat&&w.a.appBaseUrlFormat.indexOf(w.a.tenancyNamePlaceHolderInUrl)>=0}}]),n}(C.a)).\u0275fac=function(e){return new(e||zt)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](mt),l["\u0275\u0275directiveInject"](T.a),l["\u0275\u0275directiveInject"](gt.a),l["\u0275\u0275directiveInject"](l.ViewContainerRef))},zt.\u0275cmp=l["\u0275\u0275defineComponent"]({type:zt,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:12,vars:6,consts:[[1,"d-flex","flex-column","flex-root"],["id","kt_login",1,"login","login-1","login-signin-on","d-flex","flex-column","flex-lg-row","flex-column-fluid","bg-white"],["class","login-aside d-flex flex-column flex-row-auto","style","background-color: #F2C98A;",4,"ngIf"],[1,"flex-row-fluid","d-flex","flex-column","justify-content-center","position-relative","overflow-hidden","p-7","mx-auto",3,"ngClass"],[1,"d-flex","flex-column-fluid","flex-center"],[1,"login-form","login-signin"],[1,"pb-13","pt-lg-0","pt-5"],["href","","class","text-center mb-10",3,"click",4,"ngIf"],["class","login__signup-label tenant-change-box",4,"ngIf"],[1,"d-flex","justify-content-lg-start","justify-content-center","align-items-end","py-7","py-lg-0"],[1,"mx-auto"],[1,"login-aside","d-flex","flex-column","flex-row-auto",2,"background-color","#F2C98A"],[1,"d-flex","flex-column-auto","flex-column","pt-lg-40","pt-15"],["href","",1,"text-center","mb-10",3,"click"],["alt","logo","class","max-h-70px",3,"src",4,"ngIf"],[1,"aside-img","d-flex","flex-row-fluid","bgi-no-repeat","bgi-position-y-bottom","bgi-position-x-center",2,"background-image","url(/assets/metronic/assets/media/svg/illustrations/login-visual-1.svg)"],["alt","logo",1,"max-h-70px",3,"src"],[1,"login__signup-label","tenant-change-box"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275template"](2,Ht,6,2,"div",2),l["\u0275\u0275elementStart"](3,"div",3),l["\u0275\u0275elementStart"](4,"div",4),l["\u0275\u0275elementStart"](5,"div",5),l["\u0275\u0275elementStart"](6,"div",6),l["\u0275\u0275template"](7,Bt,3,2,"a",7),l["\u0275\u0275template"](8,Kt,2,0,"div",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](9,"router-outlet"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",9),l["\u0275\u0275element"](11,"language-switch",10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",!t.useFullWidthLayout()),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngClass",l["\u0275\u0275pureFunction1"](4,Qt,!t.useFullWidthLayout())),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngIf",t.useFullWidthLayout()),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.showTenantChange()))},directives:[r.n,r.k,I.j,_t,Mt],styles:[".login.login-1 .login-aside .aside-img{min-height:450px}.login.login-1 .login-forgot,.login.login-1 .login-signin,.login.login-1 .login-signup,.login.login-1.login-signin-on .login-signup{display:none}.login.login-1.login-signin-on .login-signin{display:block}.login.login-1.login-signin-on .login-forgot{display:none}.login.login-1.login-signup-on .login-signup{display:block}.login.login-1.login-forgot-on .login-signin,.login.login-1.login-forgot-on .login-signup,.login.login-1.login-signup-on .login-forgot,.login.login-1.login-signup-on .login-signin{display:none}.login.login-1.login-forgot-on .login-forgot{display:block}@media (min-width:992px){.login.login-1 .login-aside{width:100%;max-width:600px}.login.login-1 .login-content{width:100%;max-width:500px}.login.login-1 .login-content .login-form{width:100%;max-width:450px}}@media (min-width:992px) and (max-width:1399.98px){.login.login-1 .login-aside{width:100%;max-width:450px}}@media (max-width:991.98px){.login.login-1 .login-content .login-form{width:100%;max-width:400px}}@media (max-width:575.98px){.login.login-1 .aside-img{min-height:300px!important;background-size:400px}.login.login-1 .login-content .login-form{width:100%;max-width:100%}}.has-danger .form-control-feedback{color:#fd397a;margin-top:.2rem;font-size:.85rem;text-align:left}ul.text-danger{list-style:none;color:#f4516c;margin-top:.2rem;font-size:.85rem;text-align:left;padding-left:0}.captcha-container{margin:auto;width:70%}"],encapsulation:2}),zt),Jt=n("Qj9z"),Yt=((Gt=function(){function e(t,n,r){_classCallCheck(this,e),this._permissionChecker=t,this._router=n,this._sessionService=r}return _createClass(e,[{key:"canActivate",value:function(e,t){return!(!e.queryParams.ss||"true"!==e.queryParams.ss)||!this._sessionService.user||(this._router.navigate([this.selectBestRoute()]),!1)}},{key:"selectBestRoute",value:function(){return this._permissionChecker.isGranted("Pages.Administration.Host.Dashboard")?"/app/admin/hostDashboard":this._permissionChecker.isGranted("Pages.Tenant.Dashboard")?"/app/main/dashboard":"/app/notifications"}}]),e}()).\u0275fac=function(e){return new(e||Gt)(l["\u0275\u0275inject"](dt.j),l["\u0275\u0275inject"](I.e),l["\u0275\u0275inject"](Jt.a))},Gt.\u0275prov=l["\u0275\u0275defineInjectable"]({token:Gt,factory:Gt.\u0275fac}),Gt),$t=((Wt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),(a=t.call(this,e))._accountService=r,a._router=i,a._activatedRoute=o,a.model=new O.c,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.waitMessage=this.l("PleaseWaitToConfirmYourEmailMessage"),this.model.c=this._activatedRoute.snapshot.queryParams.c,this._accountService.resolveTenantId(new O.Td({c:this.model.c})).subscribe(function(t){e.appSession.changeTenantIfNeeded(t)||e._accountService.activateEmail(e.model).subscribe(function(){e.notify.success(e.l("YourEmailIsConfirmedMessage"),"",{onClose:function(){e._router.navigate(["account/login"])}})})})}},{key:"parseTenantId",value:function(e){var t=e?parseInt(e,10):void 0;return NaN===t&&(t=void 0),t}}]),n}(C.a)).\u0275fac=function(e){return new(e||Wt)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](O.b),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](I.a))},Wt.\u0275cmp=l["\u0275\u0275defineComponent"]({type:Wt,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:4,vars:1,consts:[[1,"login-form"],["role","alert",1,"alert","alert-success","text-center"],[1,"alert-text"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275text"](3),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](t.waitMessage))},encapsulation:2}),Wt),Zt=n("FCZ4"),en=n("kgQi"),tn=((Vt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var o;return _classCallCheck(this,n),(o=t.call(this,e))._accountService=r,o._router=i,o.model=new O.ce,o.saving=!1,o}return _createClass(n,[{key:"save",value:function(){var e=this;this.saving=!0,this._accountService.sendEmailActivationLink(this.model).pipe(Object(P.a)(function(){e.saving=!1})).subscribe(function(){e.message.success(e.l("ActivationMailSentMessage"),e.l("MailSent")).then(function(){e._router.navigate(["account/login"])})})}}]),n}(C.a)).\u0275fac=function(e){return new(e||Vt)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](O.b),l["\u0275\u0275directiveInject"](I.e))},Vt.\u0275cmp=l["\u0275\u0275defineComponent"]({type:Vt,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:24,vars:22,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post","novalidate","",1,"login-form","form",3,"ngSubmit"],["emailActivationForm","ngForm"],[1,"form-group"],["type","email","autocomplete","new-password","name","emailAddress","required","","maxlength","256","email","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["emailAddressInput","ngModel"],[3,"formCtrl"],[1,"pb-lg-0","pb-5"],["routerLink","/account/login","type","button",1,"btn","btn-light-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3",3,"disabled"],[1,"fa","fa-arrow-left"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-check"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3,4),l["\u0275\u0275listener"]("ngSubmit",function(){return t.save()}),l["\u0275\u0275elementStart"](7,"p"),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",5),l["\u0275\u0275elementStart"](11,"input",6,7),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.emailAddress=e}),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](14,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](15,"div",9),l["\u0275\u0275elementStart"](16,"button",10),l["\u0275\u0275element"](17,"i",11),l["\u0275\u0275text"](18),l["\u0275\u0275pipe"](19,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"button",12),l["\u0275\u0275element"](21,"i",13),l["\u0275\u0275text"](22),l["\u0275\u0275pipe"](23,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275reference"](6),r=l["\u0275\u0275reference"](12);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,12,"EmailActivation")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,14,"SendEmailActivationLink_Information")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](13,16,"EmailAddress")," *"),l["\u0275\u0275property"]("ngModel",t.model.emailAddress),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",r),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.saving),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](19,18,"Back"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!n.form.valid)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](23,20,"Submit"),"")}},directives:[a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,a.RequiredValidator,a.MaxLengthValidator,a.EmailValidator,a.NgControlStatus,a.NgModel,en.a,I.f,Et.a],pipes:[bt.a],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),Vt),nn=n("ooh5");function rn(e,t){if(1&e&&l["\u0275\u0275element"](0,"validation-messages",20),2&e){l["\u0275\u0275nextContext"]();var n=l["\u0275\u0275reference"](9);l["\u0275\u0275property"]("formCtrl",n)}}function on(e,t){if(1&e&&l["\u0275\u0275element"](0,"validation-messages",20),2&e){l["\u0275\u0275nextContext"]();var n=l["\u0275\u0275reference"](14);l["\u0275\u0275property"]("formCtrl",n)}}function an(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",21),l["\u0275\u0275elementStart"](1,"div",22),l["\u0275\u0275element"](2,"span"),l["\u0275\u0275elementStart"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](6,"span"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](5,1,"LoginWith")))}function sn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"a",24),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](n);var e=t.$implicit;return l["\u0275\u0275nextContext"](2).externalLogin(e)}),l["\u0275\u0275element"](1,"i"),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit;l["\u0275\u0275propertyInterpolate"]("title",r.name),l["\u0275\u0275advance"](1),l["\u0275\u0275classMapInterpolate1"]("fab fa-",r.icon,""),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",r.name," ")}}function cn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",16),l["\u0275\u0275template"](1,sn,3,5,"a",23),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",n.loginService.externalLoginProviders)}}var ln,un=((ln=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a,s){var c;return _classCallCheck(this,n),(c=t.call(this,e)).loginService=r,c._router=i,c._sessionService=o,c._sessionAppService=a,c._reCaptchaV3Service=s,c.submitting=!1,c.isMultiTenancyEnabled=c.multiTenancy.isEnabled,c.recaptchaSiteKey=w.a.recaptchaSiteKey,c}return _createClass(n,[{key:"multiTenancySideIsTeanant",get:function(){return this._sessionService.tenantId>0}},{key:"isTenantSelfRegistrationAllowed",get:function(){return this.setting.getBoolean("App.TenantManagement.AllowSelfRegistration")}},{key:"isSelfRegistrationAllowed",get:function(){return!!this._sessionService.tenantId&&this.setting.getBoolean("App.UserManagement.AllowSelfRegistration")}},{key:"ngOnInit",value:function(){this.loginService.init(),this._sessionService.userId>0&&A.a.getReturnUrl()&&A.a.getSingleSignIn()&&this._sessionAppService.updateUserSignInToken().subscribe(function(e){var t=A.a.getReturnUrl(),n=t+(t.indexOf("?")>=0?"&":"?")+"accessToken="+e.signInToken+"&userId="+e.encodedUserId+"&tenantId="+e.encodedTenantId;location.href=n}),this.handleExternalLoginCallbacks()}},{key:"handleExternalLoginCallbacks",value:function(){var e=A.a.getQueryParametersUsingHash().state,t=A.a.getQueryParameters();if(e&&e.indexOf("openIdConnect")>=0&&this.loginService.openIdConnectLoginCallback({}),t.twitter&&"1"===t.twitter){var n=A.a.getQueryParameters();this.loginService.twitterLoginCallback(n.oauth_token,n.oauth_verifier)}}},{key:"login",value:function(){var e=this,t=function(t){e.showMainSpinner(),e.submitting=!0,e.loginService.authenticate(function(){e.submitting=!1,e.hideMainSpinner()},null,t)};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"login",function(e){t(e)}):t(null)}},{key:"externalLogin",value:function(e){this.loginService.externalAuthenticate(e)}},{key:"useCaptcha",get:function(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnLogin")}}]),n}(C.a)).\u0275fac=function(e){return new(e||ln)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](mt),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](dt.d),l["\u0275\u0275directiveInject"](O.ie),l["\u0275\u0275directiveInject"](S))},ln.\u0275cmp=l["\u0275\u0275defineComponent"]({type:ln,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:32,vars:27,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post","method","post",1,"login-form","form",3,"ngSubmit"],["loginForm","ngForm"],[1,"form-group"],["autoFocus","","type","text","autocomplete","new-password","name","userNameOrEmailAddress","required","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["userNameOrEmailAddressInput","ngModel"],[3,"formCtrl",4,"ngIf"],["type","password","autocomplete","new-password","name","password","required","","maxlength","32",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["passwordInput","ngModel"],[1,"form-group","d-flex","justify-content-between","mt-4"],[1,"checkbox","checkbox-outline"],["type","checkbox","name","rememberMe","value","true",3,"ngModel","ngModelChange"],[1,"ml-2"],["routerLink","/account/forgot-password","id","forget-password",1,"text-primary","font-size-h7","font-weight-bolder","text-hover-primary"],[1,"pb-lg-0","pb-5"],["type","submit",1,"btn","btn-block","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled"],["class","mt-10 mb-2",4,"ngIf"],["class","pb-lg-0 pb-5",4,"ngIf"],[3,"formCtrl"],[1,"mt-10","mb-2"],[1,"divider"],["class","btn btn-sm btn-light-primary font-weight-bolder py-2",3,"title","click",4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-light-primary","font-weight-bolder","py-2",3,"title","click"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3,4),l["\u0275\u0275listener"]("ngSubmit",function(){return t.login()}),l["\u0275\u0275elementStart"](7,"div",5),l["\u0275\u0275elementStart"](8,"input",6,7),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.loginService.authenticateModel.userNameOrEmailAddress=e}),l["\u0275\u0275pipe"](10,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](11,rn,1,1,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](12,"div",5),l["\u0275\u0275elementStart"](13,"input",9,10),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.loginService.authenticateModel.password=e}),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](16,on,1,1,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"div",11),l["\u0275\u0275elementStart"](18,"label",12),l["\u0275\u0275elementStart"](19,"input",13),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.loginService.rememberMe=e}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](20,"span",14),l["\u0275\u0275text"](21),l["\u0275\u0275pipe"](22,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](23,"a",15),l["\u0275\u0275text"](24),l["\u0275\u0275pipe"](25,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](26,"div",16),l["\u0275\u0275elementStart"](27,"button",17),l["\u0275\u0275text"](28),l["\u0275\u0275pipe"](29,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](30,an,7,3,"div",18),l["\u0275\u0275template"](31,cn,2,1,"div",19),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275reference"](6),r=l["\u0275\u0275reference"](9),i=l["\u0275\u0275reference"](14);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,15,"LogIn")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](10,17,"UserNameOrEmail")," *"),l["\u0275\u0275property"]("ngModel",t.loginService.authenticateModel.userNameOrEmailAddress),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",!r.touched),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](15,19,"Password")," *"),l["\u0275\u0275property"]("ngModel",t.loginService.authenticateModel.password),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",!i.touched),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngModel",t.loginService.rememberMe),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](22,21,"RememberMe")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](25,23,"ForgotPassword")),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("disabled",!n.form.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](29,25,"LogIn")),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",(t.multiTenancySideIsTeanant||!t.isMultiTenancyEnabled)&&t.loginService.externalLoginProviders.length>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",(t.multiTenancySideIsTeanant||!t.isMultiTenancyEnabled)&&t.loginService.externalLoginProviders.length>0)}},directives:[a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,nn.a,a.RequiredValidator,a.NgControlStatus,a.NgModel,r.n,a.MaxLengthValidator,a.CheckboxControlValueAccessor,I.h,en.a,r.m],pipes:[bt.a],styles:[".kt-login__options[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer;padding-right:.35rem;margin:0 5px 0 0!important}.kt-login__options[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i.fa-openidconnect[_ngcontent-%COMP%]{background:url(/assets/common/images/social/openid.png) no-repeat;width:16px;height:16px}.kt-login__options[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i.fa-wsfederation[_ngcontent-%COMP%]{background:url(/assets/common/images/social/adfs.png) no-repeat;width:16px;height:16px}"],data:{animation:[Object(Zt.a)()]}}),ln);function dn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"option",11),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit;l["\u0275\u0275property"]("value",n),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](n)}}function pn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"form",4,5),l["\u0275\u0275listener"]("ngSubmit",function(){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().submit()}),l["\u0275\u0275elementStart"](2,"p"),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"div",6),l["\u0275\u0275elementStart"](6,"select",7),l["\u0275\u0275listener"]("ngModelChange",function(e){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().selectedTwoFactorProvider=e}),l["\u0275\u0275template"](7,dn,2,2,"option",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](8,"div",9),l["\u0275\u0275elementStart"](9,"button",10),l["\u0275\u0275text"](10),l["\u0275\u0275pipe"](11,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](4,4,"SendSecurityCode_Information")),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngModel",r.selectedTwoFactorProvider),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",r.loginService.authenticateResult.twoFactorAuthProviders),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](11,6,"Submit"))}}var hn,mn=((hn=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),(a=t.call(this,e)).loginService=r,a._tokenAuthService=i,a._router=o,a.submitting=!1,a}return _createClass(n,[{key:"canActivate",value:function(){return!!(this.loginService.authenticateModel&&this.loginService.authenticateResult&&this.loginService.authenticateResult.twoFactorAuthProviders&&this.loginService.authenticateResult.twoFactorAuthProviders.length)}},{key:"ngOnInit",value:function(){this.canActivate()?this.selectedTwoFactorProvider=this.loginService.authenticateResult.twoFactorAuthProviders[0]:this._router.navigate(["account/login"])}},{key:"submit",value:function(){var e=this,t=new O.ge;t.userId=this.loginService.authenticateResult.userId,t.provider=this.selectedTwoFactorProvider,this.submitting=!0,this._tokenAuthService.sendTwoFactorAuthCode(t).pipe(Object(P.a)(function(){return e.submitting=!1})).subscribe(function(){e._router.navigate(["account/verify-code"])})}}]),n}(C.a)).\u0275fac=function(e){return new(e||hn)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](mt),l["\u0275\u0275directiveInject"](O.ff),l["\u0275\u0275directiveInject"](I.e))},hn.\u0275cmp=l["\u0275\u0275defineComponent"]({type:hn,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:5,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["class","login-form form","method","post",3,"ngSubmit",4,"ngIf"],["method","post",1,"login-form","form",3,"ngSubmit"],["twoFactorForm","ngForm"],[1,"form-group"],["autoFocus","","size","1","name","selectedTwoFactorProvider",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"pb-lg-0","pb-5"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3"],[3,"value"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](5,pn,12,8,"form",3),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,3,"SendSecurityCode")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.loginService.authenticateResult))},directives:[r.n,a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,a.SelectControlValueAccessor,nn.a,a.NgControlStatus,a.NgModel,r.m,a.NgSelectOption,a["\u0275angular_packages_forms_forms_z"]],pipes:[bt.a],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),hn),gn=n("PqYM");function fn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",12),l["\u0275\u0275elementStart"](1,"label",13),l["\u0275\u0275elementStart"](2,"input",14),l["\u0275\u0275listener"]("ngModelChange",function(e){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().loginService.authenticateModel.rememberClient=e}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngModel",r.loginService.authenticateModel.rememberClient),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,2,"RememberThisBrowser")," ")}}function vn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span",15),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate2"]("",l["\u0275\u0275pipeBind1"](2,2,"RemainingTime"),": ",l["\u0275\u0275pipeBind2"](3,4,"SecondShort{0}",n.remainingSeconds),".")}}var yn,_n,Sn=((yn=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),(a=t.call(this,e)).loginService=r,a._reCaptchaV3Service=i,a._router=o,a.recaptchaSiteKey=w.a.recaptchaSiteKey,a.submitting=!1,a.remainingSeconds=90,a}return _createClass(n,[{key:"canActivate",value:function(){return!(!this.loginService.authenticateModel||!this.loginService.authenticateResult)}},{key:"ngOnInit",value:function(){var e=this;if(this.canActivate()){var t=Object(gn.a)(1e3,1e3);this.timerSubscription=t.subscribe(function(){e.remainingSeconds=e.remainingSeconds-1,0===e.remainingSeconds&&e.message.warn(e.l("TimeoutPleaseTryAgain")).then(function(){e.loginService.authenticateModel.twoFactorVerificationCode=null,e._router.navigate(["account/login"])})})}else this._router.navigate(["account/login"])}},{key:"ngOnDestroy",value:function(){this.timerSubscription&&(this.timerSubscription.unsubscribe(),this.timerSubscription=null)}},{key:"useCaptcha",get:function(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnLogin")}},{key:"submit",value:function(){var e=this,t=function(t){e.loginService.authenticateModel.twoFactorVerificationCode=e.code,e.loginService.authenticate(function(){},null,t)};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"login",function(e){t(e)}):t(null)}}]),n}(C.a)).\u0275fac=function(e){return new(e||yn)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](mt),l["\u0275\u0275directiveInject"](S),l["\u0275\u0275directiveInject"](I.e))},yn.\u0275cmp=l["\u0275\u0275defineComponent"]({type:yn,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:18,vars:15,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],["method","post",1,"login-form","form",3,"ngSubmit"],["twoFactorForm","ngForm"],[1,"form-group"],["autoFocus","","type","password","autocomplete","new-password","name","code","required","","maxlength","16",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["passwordInput","ngModel"],[3,"formCtrl"],["class","form-group mt-4",4,"ngIf"],[1,"pb-lg-0","pb-5"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled"],["class","remaining-time-counter ml-5",4,"ngIf"],[1,"form-group","mt-4"],[1,"checkbox","checkbox-outline"],["type","checkbox","name","rememberClient","value","true",3,"ngModel","ngModelChange"],[1,"remaining-time-counter","ml-5"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3"),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",2,3),l["\u0275\u0275listener"]("ngSubmit",function(){return t.submit()}),l["\u0275\u0275elementStart"](7,"div",4),l["\u0275\u0275elementStart"](8,"input",5,6),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.code=e}),l["\u0275\u0275pipe"](10,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](11,"validation-messages",7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](12,fn,6,4,"div",8),l["\u0275\u0275elementStart"](13,"div",9),l["\u0275\u0275elementStart"](14,"button",10),l["\u0275\u0275text"](15),l["\u0275\u0275pipe"](16,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](17,vn,4,7,"span",11),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275reference"](6),r=l["\u0275\u0275reference"](9);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,9,"VerifySecurityCode")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](10,11,"Code")," *"),l["\u0275\u0275property"]("ngModel",t.code),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",r),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf","true"===t.s("Abp.Zero.UserManagement.TwoFactorLogin.IsRememberBrowserEnabled")),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!n.form.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](16,13,"Submit")),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.remainingSeconds>=0)}},directives:[a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,nn.a,a.RequiredValidator,a.MaxLengthValidator,a.NgControlStatus,a.NgModel,en.a,r.n,a.CheckboxControlValueAccessor],pipes:[bt.a],styles:[".remaining-time-counter[_ngcontent-%COMP%]{color:red}"],data:{animation:[Object(Zt.a)()]}}),yn),En=n("WroF"),bn=((_n=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),(a=t.call(this,e))._accountService=r,a._appUrlService=i,a._router=o,a.model=new O.ee,a.saving=!1,a}return _createClass(n,[{key:"save",value:function(){var e=this;this.saving=!0,this._accountService.sendPasswordResetCode(this.model).pipe(Object(P.a)(function(){e.saving=!1})).subscribe(function(){e.message.success(e.l("PasswordResetMailSentMessage"),e.l("MailSent")).then(function(){e._router.navigate(["account/login"])})})}}]),n}(C.a)).\u0275fac=function(e){return new(e||_n)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](O.b),l["\u0275\u0275directiveInject"](En.a),l["\u0275\u0275directiveInject"](I.e))},_n.\u0275cmp=l["\u0275\u0275defineComponent"]({type:_n,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:24,vars:22,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post","novalidate","",1,"login-form","form",3,"ngSubmit"],["forgotPassForm","ngForm"],[1,"form-group"],["autoFocus","","type","text","autocomplete","new-password","name","emailAddress","required","","maxlength","256","email","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["emailAddressInput","ngModel"],[3,"formCtrl"],[1,"pb-lg-0","pb-5"],["routerLink","/account/login","type","button",1,"btn","btn-light-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3",3,"disabled"],[1,"fa","fa-arrow-left"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-check"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3,4),l["\u0275\u0275listener"]("ngSubmit",function(){return t.save()}),l["\u0275\u0275elementStart"](7,"p"),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",5),l["\u0275\u0275elementStart"](11,"input",6,7),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.emailAddress=e}),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](14,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](15,"div",9),l["\u0275\u0275elementStart"](16,"button",10),l["\u0275\u0275element"](17,"i",11),l["\u0275\u0275text"](18),l["\u0275\u0275pipe"](19,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"button",12),l["\u0275\u0275element"](21,"i",13),l["\u0275\u0275text"](22),l["\u0275\u0275pipe"](23,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275reference"](6),r=l["\u0275\u0275reference"](12);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,12,"ForgotPassword")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,14,"SendPasswordResetLink_Information")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](13,16,"EmailAddress")," *"),l["\u0275\u0275property"]("ngModel",t.model.emailAddress),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",r),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.saving),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](19,18,"Back"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!n.form.valid)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](23,20,"Submit"),"")}},directives:[a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,nn.a,a.RequiredValidator,a.MaxLengthValidator,a.EmailValidator,a.NgControlStatus,a.NgModel,en.a,I.f,Et.a],pipes:[bt.a],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),_n),In=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(O.Sd),Tn=n("gGBz"),wn=n("KIW0");function Cn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",17),l["\u0275\u0275elementStart"](1,"li",18),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",18),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",18),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",18),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",18),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](),r=l["\u0275\u0275reference"](12);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!r.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](3,10,"PasswordComplexity_RequireDigit_Hint")),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,12,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,14,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,16,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,18,"PasswordComplexity_RequiredLength_Hint",n.passwordComplexitySetting.requiredLength)," ")}}function kn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",17),l["\u0275\u0275elementStart"](1,"li",18),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",18),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",18),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",18),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",18),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"li",18),l["\u0275\u0275text"](17),l["\u0275\u0275pipe"](18,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](),r=l["\u0275\u0275reference"](18);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!r.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](3,12,"PasswordComplexity_RequireDigit_Hint")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,14,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,16,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,18,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,20,"PasswordComplexity_RequiredLength_Hint",n.passwordComplexitySetting.requiredLength)," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",r.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](18,23,"PasswordsDontMatch"))}}var An,On,xn=((On=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a,s,c,l){var u;return _classCallCheck(this,n),(u=t.call(this,e))._accountService=r,u._router=i,u._activatedRoute=o,u._loginService=a,u._reCaptchaV3Service=s,u._appUrlService=c,u._profileService=l,u.recaptchaSiteKey=w.a.recaptchaSiteKey,u.model=new In,u.passwordComplexitySetting=new O.od,u.saving=!1,u}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this._profileService.getPasswordComplexitySetting().subscribe(function(t){e.passwordComplexitySetting=t.setting}),this._activatedRoute.snapshot.queryParams.c?(this.model.c=this._activatedRoute.snapshot.queryParams.c,this._accountService.resolveTenantId(new O.Td({c:this.model.c})).subscribe(function(t){e.appSession.changeTenantIfNeeded(t)})):(this.model.userId=this._activatedRoute.snapshot.queryParams.userId,this.model.resetCode=this._activatedRoute.snapshot.queryParams.resetCode,this.appSession.changeTenantIfNeeded(this.parseTenantId(this._activatedRoute.snapshot.queryParams.tenantId)))}},{key:"useCaptcha",get:function(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnLogin")}},{key:"save",value:function(){var e=this;this.saving=!0,this._accountService.resetPassword(this.model).pipe(Object(P.a)(function(){e.saving=!1})).subscribe(function(t){if(t.canLogin){var n=function(n){e.saving=!0,e._loginService.authenticateModel.userNameOrEmailAddress=t.userName,e._loginService.authenticateModel.password=e.model.password,e._loginService.authenticate(function(){e.saving=!1},null,n)};e.useCaptcha?e._reCaptchaV3Service.execute(e.recaptchaSiteKey,"login",function(e){n(e)}):n(null)}else e._router.navigate(["account/login"])})}},{key:"parseTenantId",value:function(e){var t=e?parseInt(e):void 0;return NaN===t&&(t=void 0),t}}]),n}(C.a)).\u0275fac=function(e){return new(e||On)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](O.b),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](I.a),l["\u0275\u0275directiveInject"](mt),l["\u0275\u0275directiveInject"](S),l["\u0275\u0275directiveInject"](En.a),l["\u0275\u0275directiveInject"](O.Nd))},On.\u0275cmp=l["\u0275\u0275defineComponent"]({type:On,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:31,vars:39,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post",1,"login-form","form",3,"ngSubmit"],["resetPassForm","ngForm"],[1,"form-group"],["type","password","name","Password","validateEqual","PasswordRepeat","reverse","true","required","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength","ngModelChange"],["Password","ngModel"],[1,"form-group",3,"hidden"],["class","form-text text-danger",4,"ngIf"],["type","password","name","PasswordRepeat","validateEqual","Password","reverse","false","required","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength"],["PasswordRepeat","ngModel"],[1,"pb-lg-0","pb-5"],["routerLink","/account/login","type","button",1,"btn","btn-light-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3",3,"disabled"],[1,"fa","fa-arrow-left"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-check"],[1,"form-text","text-danger"],[3,"hidden"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3,4),l["\u0275\u0275listener"]("ngSubmit",function(){return t.save()}),l["\u0275\u0275elementStart"](7,"p"),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",5),l["\u0275\u0275elementStart"](11,"input",6,7),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.password=e}),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](14,"div",8),l["\u0275\u0275template"](15,Cn,16,21,"ul",9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"div",5),l["\u0275\u0275element"](17,"input",10,11),l["\u0275\u0275pipe"](19,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"div",8),l["\u0275\u0275template"](21,kn,19,25,"ul",9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](22,"div",12),l["\u0275\u0275elementStart"](23,"button",13),l["\u0275\u0275element"](24,"i",14),l["\u0275\u0275text"](25),l["\u0275\u0275pipe"](26,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](27,"button",15),l["\u0275\u0275element"](28,"i",16),l["\u0275\u0275text"](29),l["\u0275\u0275pipe"](30,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275reference"](6),r=l["\u0275\u0275reference"](12),i=l["\u0275\u0275reference"](18);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,27,"ChangePassword")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,29,"PleaseEnterYourNewPassword")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](13,31,"Password")),l["\u0275\u0275property"]("ngModel",t.model.password)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",n.form.valid||n.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](19,33,"PasswordRepeat")),l["\u0275\u0275property"]("ngModel",t.model.passwordRepeat)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",n.form.valid||n.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",i.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.saving),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](26,35,"Back"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!n.form.valid)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](30,37,"Submit"),"")}},directives:[a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,Tn.a,a.RequiredValidator,a.NgControlStatus,a.NgModel,wn.a,r.n,I.f,Et.a],pipes:[bt.a],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),On),Rn=((An=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getPaymentGatewayType",value:function(e){return parseInt(e)===O.Ee.Paypal?"Paypal":"Stripe"}},{key:"getEditionPaymentType",value:function(e){return parseInt(e)===O.Ib.BuyNow?"BuyNow":parseInt(e)===O.Ib.Extend?"Extend":parseInt(e)===O.Ib.NewRegistration?"NewRegistration":"Upgrade"}},{key:"getInitialSelectedPaymentPeriodType",value:function(e){return e.dailyPrice>0?O.vd.Daily:e.weeklyPrice>0?O.vd.Weekly:e.monthlyPrice>0?O.vd.Monthly:e.annualPrice>0?O.vd.Annual:void 0}}]),e}()).\u0275fac=function(e){return new(e||An)},An.\u0275prov=l["\u0275\u0275defineInjectable"]({token:An,factory:An.\u0275fac}),An);function Pn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",11),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](n);var e=l["\u0275\u0275nextContext"]();return e.onPaymentPeriodChangeChange(e.paymentPeriodType.Daily)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",r.selectedPaymentPeriodType==r.paymentPeriodType.Daily)("value",r.paymentPeriodType.Daily),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"DailyPrice"),": ",r.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,r.edition.dailyPrice,"1.2-2")," ")}}function Nn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",14),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](n);var e=l["\u0275\u0275nextContext"]();return e.onPaymentPeriodChangeChange(e.paymentPeriodType.Weekly)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",r.selectedPaymentPeriodType==r.paymentPeriodType.Weekly)("value",r.paymentPeriodType.Weekly),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"WeeklyPrice"),": ",r.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,r.edition.weeklyPrice,"1.2-2")," ")}}function Ln(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",11),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](n);var e=l["\u0275\u0275nextContext"]();return e.onPaymentPeriodChangeChange(e.paymentPeriodType.Monthly)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",r.selectedPaymentPeriodType==r.paymentPeriodType.Monthly)("value",r.paymentPeriodType.Monthly),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"MonthlyPrice"),": ",r.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,r.edition.monthlyPrice,"1.2-2")," ")}}function Un(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",14),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](n);var e=l["\u0275\u0275nextContext"]();return e.onPaymentPeriodChangeChange(e.paymentPeriodType.Annual)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",r.selectedPaymentPeriodType==r.paymentPeriodType.Annual)("value",r.paymentPeriodType.Annual),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"AnnualPrice"),": ",r.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,r.edition.annualPrice,"1.2-2")," ")}}function Mn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",14),l["\u0275\u0275elementStart"](1,"label",15),l["\u0275\u0275elementStart"](2,"input",16),l["\u0275\u0275listener"]("ngModelChange",function(e){return l["\u0275\u0275restoreView"](n),l["\u0275\u0275nextContext"]().recurringPaymentEnabled=e}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngModel",r.recurringPaymentEnabled),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,2,"AutomaticallyBillMyAccount")," ")}}function Dn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button",19),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](n);var e=l["\u0275\u0275nextContext"]().$implicit;return l["\u0275\u0275nextContext"]().checkout(e.gatewayType)}),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]().$implicit,i=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"CheckoutWith"+i.getPaymentGatewayType(r.gatewayType))," ")}}function jn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",17),l["\u0275\u0275template"](1,Dn,3,3,"button",18),l["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",n.supportsRecurringPayments||!r.recurringPaymentEnabled)}}var Hn,qn,Fn=((qn=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a,s){var c;return _classCallCheck(this,n),(c=t.call(this,e))._activatedRoute=r,c._router=i,c._paymnetHelperService=o,c._paymentAppService=a,c._tenantRegistrationService=s,c.edition=new O.Jb,c.tenantId=abp.session.tenantId,c.paymentPeriodType=O.vd,c.subscriptionPaymentGateway=O.Ee,c.supportsRecurringPayments=!1,c.recurringPaymentEnabled=!1,c.editionId=0,c}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this,t=parseInt(this._activatedRoute.snapshot.queryParams.tenantId);abp.multiTenancy.setTenantIdCookie(t),this.editionPaymentType=this._activatedRoute.snapshot.queryParams.editionPaymentType,this.editionId=this._activatedRoute.snapshot.queryParams.editionId,this._tenantRegistrationService.getEdition(this.editionId).subscribe(function(t){e.edition=t,e.selectedPaymentPeriodType=e._paymnetHelperService.getInitialSelectedPaymentPeriodType(e.edition)}),this._paymentAppService.getActiveGateways(void 0).subscribe(function(t){e.paymentGateways=t,e.supportsRecurringPayments=t.some(function(e){return e.supportsRecurringPayments})})}},{key:"checkout",value:function(e){var t=this,n={};n.editionId=this.editionId,n.editionPaymentType=this.editionPaymentType,n.paymentPeriodType=this.selectedPaymentPeriodType,n.recurringPaymentEnabled=this.recurringPaymentEnabled,n.subscriptionPaymentGatewayType=e,n.successUrl=w.a.remoteServiceBaseUrl+"/api/services/app/payment/"+this._paymnetHelperService.getEditionPaymentType(this.editionPaymentType)+"Succeed",n.errorUrl=w.a.remoteServiceBaseUrl+"/api/services/app/payment/PaymentFailed",this._paymentAppService.createPayment(n).subscribe(function(n){t._router.navigate(["account/"+t.getPaymentGatewayType(e).toLocaleLowerCase()+"-purchase"],{queryParams:{paymentId:n,redirectUrl:"account/register-tenant-result"}})})}},{key:"getPaymentGatewayType",value:function(e){return this._paymnetHelperService.getPaymentGatewayType(e)}},{key:"onPaymentPeriodChangeChange",value:function(e){this.selectedPaymentPeriodType=e}}]),n}(C.a)).\u0275fac=function(e){return new(e||qn)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](I.a),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](Rn),l["\u0275\u0275directiveInject"](O.wd),l["\u0275\u0275directiveInject"](O.Ne))},qn.\u0275cmp=l["\u0275\u0275defineComponent"]({type:qn,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:19,vars:14,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post",1,"login-form","form"],[1,"mb-5"],[1,"radio-inline"],["class","form-group mr-5",4,"ngIf"],["class","form-group",4,"ngIf"],[1,"separator","separator-border-dashed"],[1,"pb-lg-0","pb-5"],["class","mb-2",4,"ngFor","ngForOf"],[1,"form-group","mr-5"],[1,"radio"],["type","radio","name","PaymentPeriodType",3,"checked","value","change"],[1,"form-group"],[1,"checkbox","mb-0"],["type","checkbox","name","RecurringPaymentEnabled",3,"ngModel","ngModelChange"],[1,"mb-2"],["class","btn btn-success btn-block",3,"click",4,"ngIf"],[1,"btn","btn-success","btn-block",3,"click"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3),l["\u0275\u0275elementStart"](6,"h4",4),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](9,"div",5),l["\u0275\u0275template"](10,Pn,7,10,"div",6),l["\u0275\u0275template"](11,Nn,7,10,"div",7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](12,"div",5),l["\u0275\u0275template"](13,Ln,7,10,"div",6),l["\u0275\u0275template"](14,Un,7,10,"div",7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](15,"div",8),l["\u0275\u0275template"](16,Mn,6,4,"div",7),l["\u0275\u0275elementStart"](17,"div",9),l["\u0275\u0275template"](18,jn,2,1,"div",10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,10,"PaymentInfo")," "),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate2"]("",l["\u0275\u0275pipeBind1"](8,12,"Edition"),": ",t.edition.displayName,""),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",t.edition.dailyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.edition.weeklyPrice>0),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.edition.monthlyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.edition.annualPrice>0),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.supportsRecurringPayments),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngForOf",t.paymentGateways))},directives:[a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,r.n,r.m,a.CheckboxControlValueAccessor,a.NgControlStatus,a.NgModel],pipes:[bt.a,r.f],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),qn),Bn=((Hn=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isEditionFree",value:function(e){return!(e.dailyPrice||e.weeklyPrice||e.monthlyPrice||e.annualPrice)}}]),e}()).\u0275fac=function(e){return new(e||Hn)},Hn.\u0275prov=l["\u0275\u0275defineInjectable"]({token:Hn,factory:Hn.\u0275fac,providedIn:"root"}),Hn);function Kn(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div"),l["\u0275\u0275elementStart"](1,"div",10),l["\u0275\u0275elementStart"](2,"label",11),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,1,"RecurringSubscriptionUpgradeNote")," "))}function zn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div"),l["\u0275\u0275elementStart"](1,"div",10),l["\u0275\u0275elementStart"](2,"label",12),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"div",13),l["\u0275\u0275elementStart"](6,"p",14),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,3,"Total")," "),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate2"](" ",n.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](8,5,n.additionalPrice,"1.2-2")," ")}}function Wn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button",15),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](n);var e=t.$implicit;return l["\u0275\u0275nextContext"](2).checkout(e.gatewayType)}),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,i=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"CheckoutWith"+i.getPaymentGatewayType(r.gatewayType))," ")}}function Gn(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",1),l["\u0275\u0275elementStart"](1,"div",2),l["\u0275\u0275elementStart"](2,"h3",3),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",4),l["\u0275\u0275elementStart"](6,"h4",5),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](9,"div",6),l["\u0275\u0275template"](10,Kn,5,3,"div",7),l["\u0275\u0275template"](11,zn,9,8,"div",7),l["\u0275\u0275elementStart"](12,"div",8),l["\u0275\u0275template"](13,Wn,3,3,"button",9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,6,"PaymentInfo")," "),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](8,8,"Upgrade_Edition_Description",n.edition.displayName)," "),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",n.hasRecurringSubscription()),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!n.hasRecurringSubscription()),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngForOf",n.paymentGateways)}}var Vn,Qn=((Vn=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a,s,c){var l;return _classCallCheck(this,n),(l=t.call(this,e))._router=r,l._paymentHelperService=i,l._activatedRoute=o,l._paymentAppService=a,l._tenantRegistrationAppService=s,l._editionHelperService=c,l.subscriptionPaymentType=O.Fe,l.subscriptionStartType=O.He,l.edition=new O.Jb,l.tenantId=abp.session.tenantId,l.subscriptionPaymentGateway=O.Ee,l.editionPaymentTypeCheck=O.Ib,l.showPaymentForm=!1,l}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.showMainSpinner(),this.editionPaymentType=parseInt(this._activatedRoute.snapshot.queryParams.editionPaymentType),this.upgradeEditionId=this._activatedRoute.snapshot.queryParams.upgradeEditionId,this.appSession.tenant.edition.isFree?this._tenantRegistrationAppService.getEdition(this.upgradeEditionId).subscribe(function(t){e._editionHelperService.isEditionFree(t)?e._paymentAppService.switchBetweenFreeEditions(t.id).subscribe(function(){e.hideMainSpinner(),e._router.navigate(["app/admin/subscription-management"])}):(e.hideMainSpinner(),e.redirectToBuy())}):this._paymentAppService.hasAnyPayment().subscribe(function(t){if(!t)return e.hideMainSpinner(),void e.redirectToBuy();e._paymentAppService.getPaymentInfo(e.upgradeEditionId).subscribe(function(t){e.edition=t.edition,e.additionalPrice=Number(t.additionalPrice.toFixed(2)),e.additionalPrice<w.a.MinimumUpgradePaymentAmount?e._paymentAppService.upgradeSubscriptionCostsLessThenMinAmount(e.upgradeEditionId).subscribe(function(){e.spinnerService.hide(),e.showPaymentForm=!0,e._router.navigate(["app/admin/subscription-management"])}):(e.spinnerService.hide(),e.showPaymentForm=!0)}),e._paymentAppService.getLastCompletedPayment().subscribe(function(t){var n=new O.td;n.gatewayType=t.gateway,n.supportsRecurringPayments=!0,e.paymentGateways=[n],e.paymentPeriodType=t.paymentPeriodType,e.appSession.tenant.subscriptionPaymentType===e.subscriptionPaymentType.Manual&&e._paymentAppService.getActiveGateways(void 0).subscribe(function(t){e.paymentGateways=t})})})}},{key:"checkout",value:function(e){var t=this,n=new O.nb;n.editionId=this.edition.id,n.editionPaymentType=this.editionPaymentType,n.paymentPeriodType=this.paymentPeriodType,n.recurringPaymentEnabled=this.hasRecurringSubscription(),n.subscriptionPaymentGatewayType=e,n.successUrl=w.a.remoteServiceBaseUrl+"/api/services/app/payment/"+this._paymentHelperService.getEditionPaymentType(this.editionPaymentType)+"Succeed",n.errorUrl=w.a.remoteServiceBaseUrl+"/api/services/app/payment/PaymentFailed",this._paymentAppService.createPayment(n).subscribe(function(n){t._router.navigate(["account/"+t.getPaymentGatewayType(e).toLocaleLowerCase()+"-purchase"],{queryParams:{paymentId:n,isUpgrade:!0,redirectUrl:"app/admin/subscription-management"}})})}},{key:"getPaymentGatewayType",value:function(e){return this._paymentHelperService.getPaymentGatewayType(e)}},{key:"hasRecurringSubscription",value:function(){return this.appSession.tenant.subscriptionPaymentType!==this.subscriptionPaymentType.Manual}},{key:"redirectToBuy",value:function(){this._router.navigate(["account/buy"],{queryParams:{tenantId:this.appSession.tenant.id,editionPaymentType:O.Ib.BuyNow,editionId:this.upgradeEditionId,subscriptionStartType:this.subscriptionStartType.Paid}})}}]),n}(C.a)).\u0275fac=function(e){return new(e||Vn)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](Rn),l["\u0275\u0275directiveInject"](I.a),l["\u0275\u0275directiveInject"](O.wd),l["\u0275\u0275directiveInject"](O.Ne),l["\u0275\u0275directiveInject"](Bn))},Vn.\u0275cmp=l["\u0275\u0275defineComponent"]({type:Vn,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[["class","login-form",4,"ngIf"],[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post",1,"login-form","form"],[1,"mb-2"],[1,"separator","separator-border-dashed"],[4,"ngIf"],[1,"pb-lg-0","pb-5"],["class","btn btn-success btn-block",3,"click",4,"ngFor","ngForOf"],[1,"form-group","row"],[1,"col-sm-12"],[1,"col-sm-8"],[1,"col-sm-4","text-right"],["id","totalPrice",1,"font-weight-bolder"],[1,"btn","btn-success","btn-block",3,"click"]],template:function(e,t){1&e&&l["\u0275\u0275template"](0,Gn,14,11,"div",0),2&e&&l["\u0275\u0275property"]("ngIf",t.showPaymentForm)},directives:[r.n,a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,r.m],pipes:[bt.a,r.f],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),Vn);function Xn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",11),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](n);var e=l["\u0275\u0275nextContext"]();return e.onPaymentPeriodChangeChange(e.paymentPeriodType.Daily)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",r.selectedPaymentPeriodType===r.paymentPeriodType.Daily)("value",r.paymentPeriodType.Daily),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"DailyPrice"),": ",r.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,r.edition.dailyPrice,"1.2-2")," ")}}function Jn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",14),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](n);var e=l["\u0275\u0275nextContext"]();return e.onPaymentPeriodChangeChange(e.paymentPeriodType.Weekly)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",r.selectedPaymentPeriodType===r.paymentPeriodType.Weekly)("value",r.paymentPeriodType.Weekly),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"WeeklyPrice"),": ",r.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,r.edition.weeklyPrice,"1.2-2")," ")}}function Yn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",11),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](n);var e=l["\u0275\u0275nextContext"]();return e.onPaymentPeriodChangeChange(e.paymentPeriodType.Monthly)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",r.selectedPaymentPeriodType===r.paymentPeriodType.Monthly)("value",r.paymentPeriodType.Monthly),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"MonthlyPrice"),": ",r.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,r.edition.monthlyPrice,"1.2-2")," ")}}function $n(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",14),l["\u0275\u0275elementStart"](1,"label",12),l["\u0275\u0275elementStart"](2,"input",13),l["\u0275\u0275listener"]("change",function(){l["\u0275\u0275restoreView"](n);var e=l["\u0275\u0275nextContext"]();return e.onPaymentPeriodChangeChange(e.paymentPeriodType.Annual)}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](3,"span"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275pipe"](6,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){var r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("checked",r.selectedPaymentPeriodType===r.paymentPeriodType.Annual)("value",r.paymentPeriodType.Annual),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate3"](" ",l["\u0275\u0275pipeBind1"](5,5,"AnnualPrice"),": ",r.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](6,7,r.edition.annualPrice,"1.2-2")," ")}}function Zn(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button",15),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](n);var e=t.$implicit;return l["\u0275\u0275nextContext"]().checkout(e.gatewayType)}),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit,i=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"CheckoutWith"+i.getPaymentGatewayType(r.gatewayType))," ")}}var er,tr,nr=((tr=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a){var s;return _classCallCheck(this,n),(s=t.call(this,e))._router=r,s._paymnetHelperService=i,s._activatedRoute=o,s._paymentAppService=a,s.edition=new O.Jb,s.tenantId=abp.session.tenantId,s.paymentPeriodType=O.vd,s.subscriptionPaymentGateway=O.Ee,s.editionPaymentTypeCheck=O.Ib,s}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.editionPaymentType=parseInt(this._activatedRoute.snapshot.queryParams.editionPaymentType),this._paymentAppService.getPaymentInfo(void 0).subscribe(function(t){e.edition=t.edition,e.additionalPrice=Number(t.additionalPrice.toFixed(2)),e.selectedPaymentPeriodType=e._paymnetHelperService.getInitialSelectedPaymentPeriodType(e.edition)}),this._paymentAppService.getActiveGateways(void 0).subscribe(function(t){e.paymentGateways=t})}},{key:"checkout",value:function(e){var t=this,n={};n.editionId=this.edition.id,n.editionPaymentType=this.editionPaymentType,n.paymentPeriodType=this.selectedPaymentPeriodType,n.recurringPaymentEnabled=!1,n.subscriptionPaymentGatewayType=e,n.successUrl=w.a.remoteServiceBaseUrl+"/api/services/app/payment/"+this._paymnetHelperService.getEditionPaymentType(this.editionPaymentType)+"Succeed",n.errorUrl=w.a.remoteServiceBaseUrl+"/api/services/app/payment/PaymentFailed",this._paymentAppService.createPayment(n).subscribe(function(n){t._router.navigate(["account/"+t.getPaymentGatewayType(e).toLocaleLowerCase()+"-purchase"],{queryParams:{paymentId:n,redirectUrl:"app/admin/subscription-management"}})})}},{key:"getPaymentGatewayType",value:function(e){return this._paymnetHelperService.getPaymentGatewayType(e)}},{key:"onPaymentPeriodChangeChange",value:function(e){this.selectedPaymentPeriodType=e}},{key:"isUpgrade",value:function(){return this.additionalPrice>0}}]),n}(C.a)).\u0275fac=function(e){return new(e||tr)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](Rn),l["\u0275\u0275directiveInject"](I.a),l["\u0275\u0275directiveInject"](O.wd))},tr.\u0275cmp=l["\u0275\u0275defineComponent"]({type:tr,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:18,vars:13,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],[1,"separator","separator-border-dashed"],["method","post",1,"login-form","form","mt-2"],[1,"mb-5"],[1,"radio-inline"],["class","form-group mr-2",4,"ngIf"],["class","form-group",4,"ngIf"],[1,"pb-lg-0","pb-5"],["class","btn btn-success btn-block",3,"click",4,"ngFor","ngForOf"],[1,"form-group","mr-2"],[1,"radio"],["type","radio","name","PaymentPeriodType",1,"form-control",3,"checked","value","change"],[1,"form-group"],[1,"btn","btn-success","btn-block",3,"click"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](5,"div",3),l["\u0275\u0275elementStart"](6,"form",4),l["\u0275\u0275elementStart"](7,"h4",5),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",6),l["\u0275\u0275template"](11,Xn,7,10,"div",7),l["\u0275\u0275template"](12,Jn,7,10,"div",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"div",6),l["\u0275\u0275template"](14,Yn,7,10,"div",7),l["\u0275\u0275template"](15,$n,7,10,"div",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"div",9),l["\u0275\u0275template"](17,Zn,3,3,"button",10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,8,"PaymentInfo")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](9,10,"Extend_Edition_Description",t.edition.displayName)," "),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",t.edition.dailyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.edition.weeklyPrice>0),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.edition.monthlyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.edition.annualPrice>0),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngForOf",t.paymentGateways))},directives:[a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,r.n,r.m],pipes:[bt.a,r.f],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),tr),rr=((er=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||er)},er.\u0275prov=l["\u0275\u0275defineInjectable"]({token:er,factory:er.\u0275fac}),er);function ir(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",5),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](2,1,"ConfirmationMailSentPleaseClickLinkInTheEmail",n.model.emailAddress)," ")}}function or(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",6),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"YourAccountIsWaitingToBeActivatedByAdmin")," "))}function ar(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",7),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275element"](3,"br"),l["\u0275\u0275elementStart"](4,"a",8),l["\u0275\u0275text"](5),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,3,"TenantRegistrationLoginInfo"),""),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate"]("href",n.tenantUrl,l["\u0275\u0275sanitizeUrl"]),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](n.tenantUrl)}}var sr,cr,lr,ur=((sr=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),(a=t.call(this,e))._router=r,a._appUrlService=i,a._tenantRegistrationHelper=o,a.model=new O.Qd,a.saving=!1,a}return _createClass(n,[{key:"ngOnInit",value:function(){this._tenantRegistrationHelper.registrationResult?(this.model=this._tenantRegistrationHelper.registrationResult,abp.multiTenancy.setTenantIdCookie(this.model.tenantId),this.tenantUrl=this._appUrlService.getAppRootUrlOfTenant(this.model.tenancyName)):this._router.navigate(["account/login"])}}]),n}(C.a)).\u0275fac=function(e){return new(e||sr)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](En.a),l["\u0275\u0275directiveInject"](rr))},sr.\u0275cmp=l["\u0275\u0275defineComponent"]({type:sr,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:29,vars:23,consts:[[1,"login-form"],[1,"text-muted"],["class","alert alert-warning","role","alert",4,"ngIf"],["class","alert alert-primary","role","alert",4,"ngIf"],["class","alert alert-secondary","role","alert",4,"ngIf"],["role","alert",1,"alert","alert-warning"],["role","alert",1,"alert","alert-primary"],["role","alert",1,"alert","alert-secondary"],[3,"href"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"h4"),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"ul"),l["\u0275\u0275elementStart"](5,"li"),l["\u0275\u0275elementStart"](6,"span",1),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li"),l["\u0275\u0275elementStart"](11,"span",1),l["\u0275\u0275text"](12),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](15,"li"),l["\u0275\u0275elementStart"](16,"span",1),l["\u0275\u0275text"](17),l["\u0275\u0275pipe"](18,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](19),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"li"),l["\u0275\u0275elementStart"](21,"span",1),l["\u0275\u0275text"](22),l["\u0275\u0275pipe"](23,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](24),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](25,"div"),l["\u0275\u0275template"](26,ir,3,4,"div",2),l["\u0275\u0275template"](27,or,3,3,"div",3),l["\u0275\u0275template"](28,ar,6,5,"div",4),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](3,13,"SuccessfullyRegistered")),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](8,15,"TenancyName"),":"),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",t.model.tenancyName,""),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](13,17,"TenantName"),":"),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",t.model.name,""),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](18,19,"UserName"),":"),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",t.model.userName,""),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](23,21,"EmailAddress"),":"),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",t.model.emailAddress,""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.model.isEmailConfirmationRequired),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!t.model.isActive),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",t.tenantUrl))},directives:[r.n],pipes:[bt.a],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),sr),dr=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(O.Pd),pr=n("YyRF"),hr=((lr=function(){function e(t,n){_classCallCheck(this,e),this.el=t,this.zone=n,this.promptLabel="Enter a password",this.weakLabel="Weak",this.mediumLabel="Medium",this.strongLabel="Strong",this.feedback=!0}return _createClass(e,[{key:"showPassword",set:function(e){this.el.nativeElement.type=e?"text":"password"}},{key:"ngDoCheck",value:function(){this.updateFilledState()}},{key:"onInput",value:function(e){this.updateFilledState()}},{key:"updateFilledState",value:function(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}},{key:"createPanel",value:function(){this.panel=document.createElement("div"),this.panel.className="p-password-panel p-component p-password-panel-overlay p-connected-overlay",this.meter=document.createElement("div"),this.meter.className="p-password-meter",this.info=document.createElement("div"),this.info.className="p-password-info",this.info.textContent=this.promptLabel,this.panel.appendChild(this.meter),this.panel.appendChild(this.info),this.panel.style.minWidth=pr.b.getOuterWidth(this.el.nativeElement)+"px",document.body.appendChild(this.panel)}},{key:"showOverlay",value:function(){var e=this;this.feedback&&(this.panel||this.createPanel(),this.panel.style.zIndex=String(++pr.b.zindex),this.panel.style.display="block",this.zone.runOutsideAngular(function(){setTimeout(function(){pr.b.addClass(e.panel,"p-connected-overlay-visible"),e.bindScrollListener(),e.bindDocumentResizeListener()},1)}),pr.b.absolutePosition(this.panel,this.el.nativeElement))}},{key:"hideOverlay",value:function(){var e=this;this.feedback&&this.panel&&(pr.b.addClass(this.panel,"p-connected-overlay-hidden"),pr.b.removeClass(this.panel,"p-connected-overlay-visible"),this.unbindScrollListener(),this.unbindDocumentResizeListener(),this.zone.runOutsideAngular(function(){setTimeout(function(){e.ngOnDestroy()},150)}))}},{key:"onFocus",value:function(){this.showOverlay()}},{key:"onBlur",value:function(){this.hideOverlay()}},{key:"onKeyup",value:function(e){if(this.feedback){var t=e.target.value,n=null,r=null;if(0===t.length)n=this.promptLabel,r="0px 0px";else{var i=this.testStrength(t);i<30?(n=this.weakLabel,r="0px -10px"):i>=30&&i<80?(n=this.mediumLabel,r="0px -20px"):i>=80&&(n=this.strongLabel,r="0px -30px")}this.panel&&pr.b.hasClass(this.panel,"p-connected-overlay-visible")||this.showOverlay(),this.meter.style.backgroundPosition=r,this.info.textContent=n}}},{key:"testStrength",value:function(e){var t,n=0;return t=e.match("[0-9]"),n+=25*this.normalize(t?t.length:1/4,1),t=e.match("[a-zA-Z]"),n+=10*this.normalize(t?t.length:.5,3),t=e.match("[!@#$%^&*?_~.,;=]"),n+=35*this.normalize(t?t.length:1/6,1),t=e.match("[A-Z]"),n+=30*this.normalize(t?t.length:1/6,1),(n*=e.length/8)>100?100:n}},{key:"normalize",value:function(e,t){return e-t<=0?e/t:1+e/(e+t/4)*.5}},{key:"disabled",get:function(){return this.el.nativeElement.disabled}},{key:"bindScrollListener",value:function(){var e=this;this.scrollHandler||(this.scrollHandler=new pr.a(this.el.nativeElement,function(){pr.b.hasClass(e.panel,"p-connected-overlay-visible")&&e.hideOverlay()})),this.scrollHandler.bindScrollListener()}},{key:"unbindScrollListener",value:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}},{key:"bindDocumentResizeListener",value:function(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}},{key:"unbindDocumentResizeListener",value:function(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}},{key:"onWindowResize",value:function(){this.hideOverlay()}},{key:"ngOnDestroy",value:function(){this.panel&&(this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.unbindDocumentResizeListener(),document.body.removeChild(this.panel),this.panel=null,this.meter=null,this.info=null)}}]),e}()).\u0275fac=function(e){return new(e||lr)(l["\u0275\u0275directiveInject"](l.ElementRef),l["\u0275\u0275directiveInject"](l.NgZone))},lr.\u0275dir=l["\u0275\u0275defineDirective"]({type:lr,selectors:[["","pPassword",""]],hostVars:6,hostBindings:function(e,t){1&e&&l["\u0275\u0275listener"]("input",function(e){return t.onInput(e)})("focus",function(){return t.onFocus()})("blur",function(){return t.onBlur()})("keyup",function(e){return t.onKeyup(e)}),2&e&&l["\u0275\u0275classProp"]("p-inputtext",!0)("p-component",!0)("p-filled",t.filled)},inputs:{promptLabel:"promptLabel",weakLabel:"weakLabel",mediumLabel:"mediumLabel",strongLabel:"strongLabel",feedback:"feedback",showPassword:"showPassword"}}),lr),mr=((cr=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||cr)},cr.\u0275mod=l["\u0275\u0275defineNgModule"]({type:cr}),cr.\u0275inj=l["\u0275\u0275defineInjector"]({imports:[[r.c]]}),cr);function gr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"h4",29),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate2"]("",l["\u0275\u0275pipeBind1"](2,2,"Edition"),": ",n.model.edition.displayName,"")}}function fr(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div"),l["\u0275\u0275elementStart"](1,"span",30),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](3,1,"TenantName_Regex_Description")))}function vr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",17),l["\u0275\u0275elementStart"](1,"li",31),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",31),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",31),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",31),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",31),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](),r=l["\u0275\u0275reference"](33);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!r.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](3,10,"PasswordComplexity_RequireDigit_Hint")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,12,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,14,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,16,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,18,"PasswordComplexity_RequiredLength_Hint",n.passwordComplexitySetting.requiredLength)," ")}}function yr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",17),l["\u0275\u0275elementStart"](1,"li",31),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",31),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",31),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",31),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",31),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"li",31),l["\u0275\u0275text"](17),l["\u0275\u0275pipe"](18,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](),r=l["\u0275\u0275reference"](39);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!r.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](3,12,"PasswordComplexity_RequireDigit_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,14,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,16,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,18,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,20,"PasswordComplexity_RequiredLength_Hint",n.passwordComplexitySetting.requiredLength)," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",r.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](18,23,"PasswordsDontMatch"))}}var _r,Sr=((_r=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a,s,c){var l;return _classCallCheck(this,n),(l=t.call(this,e))._tenantRegistrationService=r,l._router=i,l._profileService=o,l._tenantRegistrationHelper=a,l._activatedRoute=s,l._reCaptchaV3Service=c,l.model=new dr,l.passwordComplexitySetting=new O.od,l.subscriptionStartType=O.He,l.paymentPeriodType=O.vd,l.selectedPaymentPeriodType=O.vd.Monthly,l.subscriptionPaymentGateway=O.Ee,l.paymentId="",l.recaptchaSiteKey=w.a.recaptchaSiteKey,l.saving=!1,l}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.model.editionId=this._activatedRoute.snapshot.queryParams.editionId,this.editionPaymentType=this._activatedRoute.snapshot.queryParams.editionPaymentType,this.model.editionId&&(this.model.subscriptionStartType=this._activatedRoute.snapshot.queryParams.subscriptionStartType),null==this.appSession.tenant?this._profileService.getPasswordComplexitySetting().subscribe(function(t){e.passwordComplexitySetting=t.setting}):this._router.navigate(["account/login"])}},{key:"ngAfterViewInit",value:function(){var e=this;this.model.editionId&&this._tenantRegistrationService.getEdition(this.model.editionId).subscribe(function(t){e.model.edition=t})}},{key:"useCaptcha",get:function(){return this.setting.getBoolean("App.TenantManagement.UseCaptchaOnRegistration")}},{key:"save",value:function(){var e=this,t=function(t){e.saving=!0,e.model.captchaResponse=t,e._tenantRegistrationService.registerTenant(e.model).pipe(Object(P.a)(function(){e.saving=!1})).subscribe(function(t){e.notify.success(e.l("SuccessfullyRegistered")),e._tenantRegistrationHelper.registrationResult=t,parseInt(e.model.subscriptionStartType.toString())===O.He.Paid?e._router.navigate(["account/buy"],{queryParams:{tenantId:t.tenantId,editionId:e.model.editionId,subscriptionStartType:e.model.subscriptionStartType,editionPaymentType:e.editionPaymentType}}):e._router.navigate(["account/register-tenant-result"])})};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"register_tenant",function(e){t(e)}):t(null)}}]),n}(C.a)).\u0275fac=function(e){return new(e||_r)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](O.Ne),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](O.Nd),l["\u0275\u0275directiveInject"](rr),l["\u0275\u0275directiveInject"](I.a),l["\u0275\u0275directiveInject"](S))},_r.\u0275cmp=l["\u0275\u0275defineComponent"]({type:_r,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:52,vars:62,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["class","text-center",4,"ngIf"],[1,"separator","separator-border-dashed"],["role","form","novalidate","",1,"login-form","form","mt-2",3,"submit"],["registerForm","ngForm"],[1,"mt-2"],[1,"form-group"],["autoFocus","","type","text","name","tenancyName","required","","maxlength","64","pattern","^[a-zA-Z][a-zA-Z0-9_-]{1,}$",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["tenancyName","ngModel"],[4,"ngIf"],["type","text","name","Name","required","","maxlength","128",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["nameInput","ngModel"],[3,"formCtrl"],["type","email","name","adminEmailAddress","required","","maxlength","256","email","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["adminEmailAddressInput","ngModel"],[1,"form-text","text-danger"],["type","password","name","Password","validateEqual","PasswordRepeat","reverse","true","required","","pPassword","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength","promptLabel","weakLabel","mediumLabel","strongLabel","ngModelChange"],["Password","ngModel"],[1,"form-group",3,"hidden"],["class","form-text text-danger",4,"ngIf"],["type","password","name","PasswordRepeat","validateEqual","Password","reverse","false","required","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength"],["PasswordRepeat","ngModel"],[1,"pb-lg-0","pb-5"],["routerLink","/account/login","type","button",1,"btn","btn-light-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3",3,"disabled"],[1,"fa","fa-arrow-left"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-check"],[1,"text-center"],[1,"form-text","text-danger","text-left"],[3,"hidden"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](5,gr,3,4,"h4",3),l["\u0275\u0275element"](6,"div",4),l["\u0275\u0275elementStart"](7,"form",5,6),l["\u0275\u0275listener"]("submit",function(){return t.save()}),l["\u0275\u0275elementStart"](9,"h5",7),l["\u0275\u0275text"](10),l["\u0275\u0275pipe"](11,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](12,"div",8),l["\u0275\u0275elementStart"](13,"input",9,10),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.tenancyName=e}),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](16,fr,4,3,"div",11),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"div",8),l["\u0275\u0275elementStart"](18,"input",12,13),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.name=e}),l["\u0275\u0275pipe"](20,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](21,"validation-messages",14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](22,"h5",7),l["\u0275\u0275text"](23),l["\u0275\u0275pipe"](24,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](25,"div",8),l["\u0275\u0275elementStart"](26,"input",15,16),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.adminEmailAddress=e}),l["\u0275\u0275pipe"](28,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](29,"span",17),l["\u0275\u0275element"](30,"validation-messages",14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](31,"div",8),l["\u0275\u0275elementStart"](32,"input",18,19),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.adminPassword=e}),l["\u0275\u0275pipe"](34,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](35,"div",20),l["\u0275\u0275template"](36,vr,16,21,"ul",21),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](37,"div",8),l["\u0275\u0275element"](38,"input",22,23),l["\u0275\u0275pipe"](40,"localize"),l["\u0275\u0275elementStart"](41,"div",20),l["\u0275\u0275template"](42,yr,19,25,"ul",21),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](43,"div",24),l["\u0275\u0275elementStart"](44,"button",25),l["\u0275\u0275element"](45,"i",26),l["\u0275\u0275text"](46),l["\u0275\u0275pipe"](47,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](48,"button",27),l["\u0275\u0275element"](49,"i",28),l["\u0275\u0275text"](50),l["\u0275\u0275pipe"](51,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275reference"](8),r=l["\u0275\u0275reference"](14),i=l["\u0275\u0275reference"](19),o=l["\u0275\u0275reference"](27),a=l["\u0275\u0275reference"](33),s=l["\u0275\u0275reference"](39);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,42,"TenantSignUp")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.model.edition),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](11,44,"TenantInformations")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](15,46,"TenancyName")," *"),l["\u0275\u0275property"]("ngModel",t.model.tenancyName),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",!r.valid&&!r.pristine),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](20,48,"TenantName")," *"),l["\u0275\u0275property"]("ngModel",t.model.name),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",i),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](24,50,"AccountSettings")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](28,52,"AdminEmailAddress")," *"),l["\u0275\u0275property"]("ngModel",t.model.adminEmailAddress),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("formCtrl",o),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](34,54,"AdminPassword")),l["\u0275\u0275property"]("ngModel",t.model.adminPassword)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength)("promptLabel",t.l("PleaseEnterYourNewPassword"))("weakLabel",t.l("weak"))("mediumLabel",t.l("medium"))("strongLabel",t.l("strong")),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",n.form.valid||n.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",a.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](40,56,"PasswordRepeat")),l["\u0275\u0275property"]("ngModel",t.model.passwordRepeat)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",n.form.valid||n.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",s.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.saving),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](47,58,"Back"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!n.form.valid)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](51,60,"Submit"),"")}},directives:[r.n,a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,nn.a,a.RequiredValidator,a.MaxLengthValidator,a.PatternValidator,a.NgControlStatus,a.NgModel,en.a,a.EmailValidator,Tn.a,hr,wn.a,I.f,Et.a],pipes:[bt.a],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),_r),Er=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(O.Od);function br(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",26),l["\u0275\u0275elementStart"](1,"li",27),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",27),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",27),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",27),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",27),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](),r=l["\u0275\u0275reference"](29);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!r.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"]("",l["\u0275\u0275pipeBind1"](3,10,"PasswordComplexity_RequireDigit_Hint")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,12,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,14,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,16,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,18,"PasswordComplexity_RequiredLength_Hint",n.passwordComplexitySetting.requiredLength)," ")}}function Ir(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"ul",26),l["\u0275\u0275elementStart"](1,"li",27),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"li",27),l["\u0275\u0275text"](5),l["\u0275\u0275pipe"](6,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"li",27),l["\u0275\u0275text"](8),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"li",27),l["\u0275\u0275text"](11),l["\u0275\u0275pipe"](12,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"li",27),l["\u0275\u0275text"](14),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"li",27),l["\u0275\u0275text"](17),l["\u0275\u0275pipe"](18,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](),r=l["\u0275\u0275reference"](35);l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("hidden",!r.errors.requireDigit),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](3,12,"PasswordComplexity_RequireDigit_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireLowercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](6,14,"PasswordComplexity_RequireLowercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireUppercase),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](9,16,"PasswordComplexity_RequireUppercase_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requireNonAlphanumeric),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](12,18,"PasswordComplexity_RequireNonAlphanumeric_Hint"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",!r.errors.requiredLength),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind2"](15,20,"PasswordComplexity_RequiredLength_Hint",n.passwordComplexitySetting.requiredLength)," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("hidden",r.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](18,23,"PasswordsDontMatch"))}}var Tr,wr=((Tr=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a,s){var c;return _classCallCheck(this,n),(c=t.call(this,e))._accountService=r,c._router=i,c._loginService=o,c._profileService=a,c._reCaptchaV3Service=s,c.model=new Er,c.passwordComplexitySetting=new O.od,c.recaptchaSiteKey=w.a.recaptchaSiteKey,c.saving=!1,c}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;null!=this.appSession.tenant?this._profileService.getPasswordComplexitySetting().subscribe(function(t){e.passwordComplexitySetting=t.setting}):this._router.navigate(["account/login"])}},{key:"useCaptcha",get:function(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnRegistration")}},{key:"save",value:function(){var e=this,t=function(t){e.saving=!0,e.model.captchaResponse=t,e._accountService.register(e.model).pipe(Object(P.a)(function(){e.saving=!1})).subscribe(function(t){if(!t.canLogin)return e.notify.success(e.l("SuccessfullyRegistered")),void e._router.navigate(["account/login"]);e.saving=!0,e._loginService.authenticateModel.userNameOrEmailAddress=e.model.userName,e._loginService.authenticateModel.password=e.model.password,e._loginService.authenticate(function(){e.saving=!1})})};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"register",function(e){t(e)}):t(null)}}]),n}(C.a)).\u0275fac=function(e){return new(e||Tr)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](O.b),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](mt),l["\u0275\u0275directiveInject"](O.Nd),l["\u0275\u0275directiveInject"](S))},Tr.\u0275cmp=l["\u0275\u0275defineComponent"]({type:Tr,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:48,vars:60,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],["method","post","novalidate","",1,"login-form","form",3,"ngSubmit"],["registerForm","ngForm"],[1,"form-group"],["autoFocus","","type","text","name","Name","required","","maxlength","64",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["nameInput","ngModel"],[3,"formCtrl"],["type","text","name","Surname","required","","maxlength","64",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["surnameInput","ngModel"],["type","email","name","EmailAddress","required","","maxlength","256","pattern","^\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["emailAddressInput","ngModel"],["type","text","autocomplete","new-password","name","UserName","required","","maxlength","256",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"placeholder","ngModel","ngModelChange"],["userNameInput","ngModel"],["type","password","name","Password","validateEqual","PasswordRepeat","reverse","true","required","","pPassword","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength","promptLabel","weakLabel","mediumLabel","strongLabel","ngModelChange"],["Password","ngModel"],[1,"form-group",3,"hidden"],["class","form-text text-danger",4,"ngIf"],["type","password","name","PasswordRepeat","validateEqual","Password","reverse","false","required","",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","requireDigit","requireLowercase","requireUppercase","requireNonAlphanumeric","requiredLength"],["PasswordRepeat","ngModel"],[1,"pb-lg-0","pb-5"],["routerLink","/account/login","type","button",1,"btn","btn-light-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3",3,"disabled"],[1,"fa","fa-arrow-left"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","px-8","py-4","my-3","mr-3",3,"disabled","buttonBusy","busyText"],[1,"fa","fa-check"],[1,"form-text","text-danger"],[3,"hidden"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h3",2),l["\u0275\u0275text"](3),l["\u0275\u0275pipe"](4,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](5,"form",3,4),l["\u0275\u0275listener"]("ngSubmit",function(){return t.save()}),l["\u0275\u0275elementStart"](7,"div",5),l["\u0275\u0275elementStart"](8,"input",6,7),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.name=e}),l["\u0275\u0275pipe"](10,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](11,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](12,"div",5),l["\u0275\u0275elementStart"](13,"input",9,10),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.surname=e}),l["\u0275\u0275pipe"](15,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](16,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"div",5),l["\u0275\u0275elementStart"](18,"input",11,12),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.emailAddress=e}),l["\u0275\u0275pipe"](20,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](21,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](22,"div",5),l["\u0275\u0275elementStart"](23,"input",13,14),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.userName=e}),l["\u0275\u0275pipe"](25,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](26,"validation-messages",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](27,"div",5),l["\u0275\u0275elementStart"](28,"input",15,16),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.model.password=e}),l["\u0275\u0275pipe"](30,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](31,"div",17),l["\u0275\u0275template"](32,br,16,21,"ul",18),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](33,"div",5),l["\u0275\u0275element"](34,"input",19,20),l["\u0275\u0275pipe"](36,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](37,"div",17),l["\u0275\u0275template"](38,Ir,19,25,"ul",18),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](39,"div",21),l["\u0275\u0275elementStart"](40,"button",22),l["\u0275\u0275element"](41,"i",23),l["\u0275\u0275text"](42),l["\u0275\u0275pipe"](43,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](44,"button",24),l["\u0275\u0275element"](45,"i",25),l["\u0275\u0275text"](46),l["\u0275\u0275pipe"](47,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275reference"](6),r=l["\u0275\u0275reference"](9),i=l["\u0275\u0275reference"](14),o=l["\u0275\u0275reference"](19),a=l["\u0275\u0275reference"](24),s=l["\u0275\u0275reference"](29),c=l["\u0275\u0275reference"](35);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](4,42,"SignUp")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](10,44,"Name")," *"),l["\u0275\u0275property"]("ngModel",t.model.name),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",r),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](15,46,"Surname")," *"),l["\u0275\u0275property"]("ngModel",t.model.surname),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",i),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](20,48,"EmailAddress")," *"),l["\u0275\u0275property"]("ngModel",t.model.emailAddress),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",o),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](25,50,"UserName")," *"),l["\u0275\u0275property"]("ngModel",t.model.userName),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("formCtrl",a),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](30,52,"Password")),l["\u0275\u0275property"]("ngModel",t.model.password)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength)("promptLabel",t.l("PleaseEnterYourNewPassword"))("weakLabel",t.l("weak"))("mediumLabel",t.l("medium"))("strongLabel",t.l("strong")),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",n.form.valid||n.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",s.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275propertyInterpolate"]("placeholder",l["\u0275\u0275pipeBind1"](36,54,"PasswordRepeat")),l["\u0275\u0275property"]("ngModel",t.model.passwordRepeat)("requireDigit",t.passwordComplexitySetting.requireDigit)("requireLowercase",t.passwordComplexitySetting.requireLowercase)("requireUppercase",t.passwordComplexitySetting.requireUppercase)("requireNonAlphanumeric",t.passwordComplexitySetting.requireNonAlphanumeric)("requiredLength",t.passwordComplexitySetting.requiredLength),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("hidden",n.form.valid||n.form.pristine),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",c.errors),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.saving),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](43,56,"Back"),""),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!n.form.valid)("buttonBusy",t.saving)("busyText",t.l("SavingWithThreeDot")),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](47,58,"Submit"),"")}},directives:[a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,nn.a,a.RequiredValidator,a.MaxLengthValidator,a.NgControlStatus,a.NgModel,en.a,a.PatternValidator,Tn.a,hr,wn.a,r.n,I.f,Et.a],pipes:[bt.a],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),Tr);function Cr(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",6),l["\u0275\u0275elementStart"](1,"div",7),l["\u0275\u0275element"](2,"i",8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"div",9),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](5,1,"ThereIsNoEditionToUpgrade")))}function kr(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"h4",24),l["\u0275\u0275elementStart"](1,"span"),l["\u0275\u0275text"](2),l["\u0275\u0275pipe"](3,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](3,1,"Free"),""))}function Ar(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275element"](3,"br"),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](2).$implicit,r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate3"]("",r.appSession.application.currencySign," ",n.edition.dailyPrice," ",l["\u0275\u0275pipeBind1"](2,3,"PerDay"),"")}}function Or(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275element"](3,"br"),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](2).$implicit,r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate3"]("",r.appSession.application.currencySign," ",n.edition.weeklyPrice," ",l["\u0275\u0275pipeBind1"](2,3,"PerWeek"),"")}}function xr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275element"](3,"br"),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](2).$implicit,r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate3"]("",r.appSession.application.currencySign," ",n.edition.monthlyPrice," ",l["\u0275\u0275pipeBind1"](2,3,"PerMonth")," ")}}function Rr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"](2).$implicit,r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate3"]("",r.appSession.application.currencySign," ",n.edition.annualPrice," ",l["\u0275\u0275pipeBind1"](2,3,"PerYear"),"")}}function Pr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"h4",24),l["\u0275\u0275template"](1,Ar,4,5,"span",25),l["\u0275\u0275template"](2,Or,4,5,"span",25),l["\u0275\u0275template"](3,xr,4,5,"span",25),l["\u0275\u0275template"](4,Rr,3,5,"span",25),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",n.edition.dailyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",n.edition.weeklyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",n.edition.monthlyPrice>0),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",n.edition.annualPrice>0)}}function Nr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span",28),l["\u0275\u0275element"](1,"i",29),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",n.displayName," ")}}function Lr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span",30),l["\u0275\u0275element"](1,"i",31),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]().$implicit;l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",n.displayName," ")}}function Ur(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span",28),l["\u0275\u0275element"](1,"i",29),l["\u0275\u0275text"](2),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]().$implicit,r=l["\u0275\u0275nextContext"]().$implicit,i=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate2"](" ",n.displayName,":",i.getFeatureValueForEdition(n,r)," ")}}function Mr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"span"),l["\u0275\u0275template"](1,Nr,3,1,"span",26),l["\u0275\u0275template"](2,Lr,3,1,"span",27),l["\u0275\u0275template"](3,Ur,3,2,"span",26),l["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,r=l["\u0275\u0275nextContext"]().$implicit,i=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",i.isTrueFalseFeature(n)&&i.featureEnabledForEdition(n,r)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",i.isTrueFalseFeature(n)&&!i.featureEnabledForEdition(n,r)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!i.isTrueFalseFeature(n))}}function Dr(e,t){if(1&e){var n=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"button",32),l["\u0275\u0275listener"]("click",function(){l["\u0275\u0275restoreView"](n);var e=l["\u0275\u0275nextContext"]().$implicit,t=l["\u0275\u0275nextContext"]();return t.upgrade(e.edition,t.editionPaymentType.Upgrade)}),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()}2&e&&(l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,1,"Upgrade")," "))}var jr=function(){return["/account/register-tenant"]},Hr=function(e,t){return{editionId:e,subscriptionStartType:t}};function qr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"button",33),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]().$implicit,r=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](5,jr))("queryParams",l["\u0275\u0275pureFunction2"](6,Hr,n.edition.id,r.subscriptionStartType.Free)),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,3,"Start")," ")}}function Fr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"button",34),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]().$implicit,r=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](5,jr))("queryParams",l["\u0275\u0275pureFunction2"](6,Hr,n.edition.id,r.subscriptionStartType.Trial)),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,3,"FreeTrial")," ")}}var Br=function(e,t,n){return{editionId:e,subscriptionStartType:t,editionPaymentType:n}};function Kr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"button",35),l["\u0275\u0275text"](1),l["\u0275\u0275pipe"](2,"localize"),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]().$implicit,r=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("routerLink",l["\u0275\u0275pureFunction0"](5,jr))("queryParams",l["\u0275\u0275pureFunction3"](6,Br,n.edition.id,r.subscriptionStartType.Paid,r.editionPaymentType.NewRegistration)),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](2,3,"BuyNow")," ")}}function zr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",10),l["\u0275\u0275elementStart"](1,"div",11),l["\u0275\u0275elementStart"](2,"span",12),l["\u0275\u0275namespaceSVG"](),l["\u0275\u0275elementStart"](3,"svg",13),l["\u0275\u0275element"](4,"polyline",14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275namespaceHTML"](),l["\u0275\u0275elementStart"](5,"span",15),l["\u0275\u0275element"](6,"i"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"span",16),l["\u0275\u0275text"](8),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](9,kr,4,3,"h4",17),l["\u0275\u0275template"](10,Pr,5,4,"h4",17),l["\u0275\u0275elementStart"](11,"p",18),l["\u0275\u0275template"](12,Mr,4,3,"span",19),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](13,Dr,3,3,"button",20),l["\u0275\u0275template"](14,qr,3,9,"button",21),l["\u0275\u0275template"](15,Fr,3,9,"button",22),l["\u0275\u0275template"](16,Kr,3,10,"button",23),l["\u0275\u0275elementEnd"]()),2&e){var n=t.$implicit,r=t.index,i=l["\u0275\u0275nextContext"]();l["\u0275\u0275classProp"]("border-left-md",r>0),l["\u0275\u0275advance"](6),l["\u0275\u0275classMapInterpolate1"]("fa ",i.editionIcons[r],""),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](n.edition.displayName),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",i.isFree(n.edition)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!i.isFree(n.edition)),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngForOf",i.editionsSelectOutput.allFeatures),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",i.isUserLoggedIn),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!i.isUserLoggedIn&&i.isFree(n.edition)),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!i.isUserLoggedIn&&!i.isFree(n.edition)&&n.edition.trialDayCount),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",!i.isUserLoggedIn&&!i.isFree(n.edition))}}var Wr,Gr=((Wr=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),(a=t.call(this,e))._tenantRegistrationService=r,a._editionHelperService=i,a._router=o,a.editionsSelectOutput=new O.Lb,a.isUserLoggedIn=!1,a.isSetted=!1,a.editionPaymentType=O.Ib,a.subscriptionStartType=O.He,a.editionIcons=["flaticon-open-box","flaticon-rocket","flaticon-gift","flaticon-confetti","flaticon-cogwheel-2","flaticon-app","flaticon-coins","flaticon-piggy-bank","flaticon-bag","flaticon-lifebuoy","flaticon-technology-1","flaticon-cogwheel-1","flaticon-infinity","flaticon-interface-5","flaticon-squares-3","flaticon-interface-6","flaticon-mark","flaticon-business","flaticon-interface-7","flaticon-list-2","flaticon-bell","flaticon-technology","flaticon-squares-2","flaticon-notes","flaticon-profile","flaticon-layers","flaticon-interface-4","flaticon-signs","flaticon-menu-1","flaticon-symbol"],a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.isUserLoggedIn=abp.session.userId>0,this._tenantRegistrationService.getEditionsForSelect().subscribe(function(t){e.editionsSelectOutput=t,(!e.editionsSelectOutput.editionsWithFeatures||e.editionsSelectOutput.editionsWithFeatures.length<=0)&&e._router.navigate(["/account/register-tenant"])})}},{key:"isFree",value:function(e){return this._editionHelperService.isEditionFree(e)}},{key:"isTrueFalseFeature",value:function(e){return"CHECKBOX"===e.inputType.name}},{key:"featureEnabledForEdition",value:function(e,t){var n=Object(k.a)(t.featureValues,{name:e.name});return!(!n||n.length<=0)&&"true"===n[0].value.toLowerCase()}},{key:"getFeatureValueForEdition",value:function(e,t){var n=Object(k.a)(t.featureValues,{name:e.name});return!n||n.length<=0?"":n[0].value}},{key:"upgrade",value:function(e,t){this._router.navigate(["/account/upgrade"],{queryParams:{upgradeEditionId:e.id,editionPaymentType:t}})}}]),n}(C.a)).\u0275fac=function(e){return new(e||Wr)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](O.Ne),l["\u0275\u0275directiveInject"](Bn),l["\u0275\u0275directiveInject"](I.e))},Wr.\u0275cmp=l["\u0275\u0275defineComponent"]({type:Wr,selectors:[["ng-component"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:8,vars:5,consts:[[1,"content","d-flex","flex-column","flex-column-fluid"],[1,"card","card-custom","gutter-b","shadow-lg"],[1,"card-body"],[1,"row","justify-content-center","mt-10","mb-0","pricing-items"],["class","alert alert-warning fade show","role","alert",4,"ngIf"],["class","pt-30 pt-md-25 px-5 mb-15 text-center","style","min-width:200px",3,"border-left-md",4,"ngFor","ngForOf"],["role","alert",1,"alert","alert-warning","fade","show"],[1,"alert-icon"],[1,"flaticon-warning"],[1,"alert-text"],[1,"pt-30","pt-md-25","px-5","mb-15","text-center",2,"min-width","200px"],[1,"d-flex","flex-center","position-relative","mb-25"],[1,"svg","svg-fill-primary","opacity-4","position-absolute"],["width","175","height","200"],["points","87,0 174,50 174,150 87,200 0,150 0,50 87,0"],[1,"pricing-item-icon","text-primary"],[1,"font-size-h1","d-block","d-block","font-weight-boldest","py-2","pricing-title"],["class","font-size-h6 d-block d-block font-weight-bold mb-7 pricing-subtitle","style","min-height: 100px;",4,"ngIf"],[1,"mb-4","d-flex","flex-column"],[4,"ngFor","ngForOf"],["class","btn btn-warning btn-pill  btn-brand btn-wide btn-uppercase btn-bolder btn-sm mx-2",3,"click",4,"ngIf"],["class","btn btn-success btn-pill  btn-brand btn-wide btn-uppercase btn-bolder btn-sm mx-2","href","#",3,"routerLink","queryParams",4,"ngIf"],["class","btn btn-warning btn-pill  btn-brand btn-wide btn-uppercase btn-bolder btn-sm mx-2","href","#",3,"routerLink","queryParams",4,"ngIf"],["class","btn btn-primary btn-pill  btn-brand btn-wide btn-uppercase btn-bolder btn-sm mx-2","href","#",3,"routerLink","queryParams",4,"ngIf"],[1,"font-size-h6","d-block","d-block","font-weight-bold","mb-7","pricing-subtitle",2,"min-height","100px"],[4,"ngIf"],["class","text-success text-center",4,"ngIf"],["class","text-muted text-center",4,"ngIf"],[1,"text-success","text-center"],[1,"far","fa-check-circle","text-success"],[1,"text-muted","text-center"],[1,"far","fa-times-circle","text-muted"],[1,"btn","btn-warning","btn-pill","btn-brand","btn-wide","btn-uppercase","btn-bolder","btn-sm","mx-2",3,"click"],["href","#",1,"btn","btn-success","btn-pill","btn-brand","btn-wide","btn-uppercase","btn-bolder","btn-sm","mx-2",3,"routerLink","queryParams"],["href","#",1,"btn","btn-warning","btn-pill","btn-brand","btn-wide","btn-uppercase","btn-bolder","btn-sm","mx-2",3,"routerLink","queryParams"],["href","#",1,"btn","btn-primary","btn-pill","btn-brand","btn-wide","btn-uppercase","btn-bolder","btn-sm","mx-2",3,"routerLink","queryParams"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div"),l["\u0275\u0275elementStart"](1,"div",0),l["\u0275\u0275elementStart"](2,"div"),l["\u0275\u0275elementStart"](3,"div",1),l["\u0275\u0275elementStart"](4,"div",2),l["\u0275\u0275elementStart"](5,"div",3),l["\u0275\u0275template"](6,Cr,6,3,"div",4),l["\u0275\u0275template"](7,zr,17,13,"div",5),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](2),l["\u0275\u0275classMap"](t.containerClass),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngIf",!t.editionsSelectOutput||!t.editionsSelectOutput.editionsWithFeatures),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",t.editionsSelectOutput.editionsWithFeatures))},directives:[r.n,r.m,I.f],pipes:[bt.a],styles:["body{background-color:#f2f3f8}button:disabled,button[disabled]{cursor:not-allowed!important}.row-centered{text-align:center;display:block!important}.col-centered{display:inline-table;float:none;text-align:center;margin-right:-4px}.pricing-items .pricing-title{font-size:3rem;font-weight:700;display:block;margin-top:5em;color:#6c7293}.pricing-items .pricing-subtitle{font-size:1.1rem;color:#adb1c7;font-weight:500;min-height:72px}.pricing-items .pricing-item-icon{left:50%;transform:translateX(-50%);position:absolute}.pricing-items .pricing-item-icon>i{font-size:8.57rem}"],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),Wr),Vr=n("IQ2n"),Qr=n("PEYQ");function Xr(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",12),l["\u0275\u0275elementStart"](1,"div",13),l["\u0275\u0275element"](2,"i",14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"div",15),l["\u0275\u0275elementStart"](4,"h4"),l["\u0275\u0275text"](5),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"p"),l["\u0275\u0275elementStart"](7,"span"),l["\u0275\u0275text"](8),l["\u0275\u0275elementStart"](9,"strong"),l["\u0275\u0275text"](10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](11,"br"),l["\u0275\u0275elementStart"](12,"span"),l["\u0275\u0275text"](13),l["\u0275\u0275elementStart"](14,"strong"),l["\u0275\u0275text"](15),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",n.l("DemoPayPalAccount")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"]("",n.l("UserName"),": "),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](n.config.demoUsername),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"]("",n.l("Password"),": "),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](n.config.demoPassword)}}function Jr(e,t){if(1&e&&l["\u0275\u0275element"](0,"div",16),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("busyIf",n.paypalIsLoading)}}var Yr,$r=((Yr=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a,s){var c;return _classCallCheck(this,n),(c=t.call(this,e)).injector=e,c._activatedRoute=r,c._payPalPaymentAppService=i,c._paymentAppService=o,c._router=a,c._tenantRegistrationHelper=s,c.paypalIsLoading=!0,c.subscriptionPaymentGateway=O.Ee,c.totalAmount=0,c.description="",c}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.paymentId=this._activatedRoute.snapshot.queryParams.paymentId,this.redirectUrl=this._activatedRoute.snapshot.queryParams.redirectUrl,this._payPalPaymentAppService.getConfiguration().subscribe(function(t){e.config=t,(new x.a).load("https://www.paypal.com/sdk/js?client-id="+t.clientId+"&currency="+e.appSession.application.currency).then(function(){e._paymentAppService.getPayment(e.paymentId).subscribe(function(t){e.description=t.description,e.totalAmount=t.amount,e.successCallbackUrl=t.successUrl,e.errorCallbackUrl=t.errorUrl,e.subscriptionPaymentGateway=t.gateway,e.paypalIsLoading=!1,e.preparePaypalButton()})})})}},{key:"preparePaypalButton",value:function(){var e=this;window.paypal.Buttons({createOrder:function(t,n){return n.order.create({purchase_units:[{amount:{value:e.totalAmount,currency_code:e.appSession.application.currency}}]})},onApprove:function(t,n){e._payPalPaymentAppService.confirmPayment(e.paymentId,t.orderID).subscribe(function(){Vr.a.ajax("post",e.successCallbackUrl+(e.successCallbackUrl.includes("?")?"&":"?")+"paymentId="+e.paymentId,null,null,function(t){e._tenantRegistrationHelper.registrationResult&&(e._tenantRegistrationHelper.registrationResult.isActive=!0),e._router.navigate([e.redirectUrl])})})}}).render("#paypal-button")}}]),n}(C.a)).\u0275fac=function(e){return new(e||Yr)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](I.a),l["\u0275\u0275directiveInject"](O.pd),l["\u0275\u0275directiveInject"](O.wd),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](rr))},Yr.\u0275cmp=l["\u0275\u0275defineComponent"]({type:Yr,selectors:[["paypal-purchase-component"]],inputs:{editionPaymentType:"editionPaymentType"},features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:23,vars:14,consts:[[1,"login-form"],[1,"card","card-bordered"],[1,"card-header"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-4"],[1,"col-sm-8","text-right"],[1,"font-weight-bold"],["id","totalPrice",1,"font-weight-bold"],["class","alert alert-custom alert-light-dark fade show mb-5","role","alert",4,"ngIf"],["id","paypal-button"],[3,"busyIf",4,"ngIf"],["role","alert",1,"alert","alert-custom","alert-light-dark","fade","show","mb-5"],[1,"alert-icon"],[1,"flaticon-questions-circular-button"],[1,"alert-text"],[3,"busyIf"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"h3"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"div",3),l["\u0275\u0275elementStart"](7,"div",4),l["\u0275\u0275elementStart"](8,"label",5),l["\u0275\u0275text"](9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",6),l["\u0275\u0275elementStart"](11,"p",7),l["\u0275\u0275text"](12),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"div",4),l["\u0275\u0275elementStart"](14,"label",5),l["\u0275\u0275text"](15),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"div",6),l["\u0275\u0275elementStart"](17,"p",8),l["\u0275\u0275text"](18),l["\u0275\u0275pipe"](19,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](20,Xr,16,5,"div",9),l["\u0275\u0275element"](21,"div",10),l["\u0275\u0275template"](22,Jr,1,1,"div",11),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,9,"TenantSignUp")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate"](t.l("Item")),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",t.description," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](t.l("Price")),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate2"](" ",t.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](19,11,t.totalAmount,"1.2-2")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.config&&t.config.demoUsername&&t.config.demoPassword),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.paypalIsLoading))},directives:[r.n,Qr.a],pipes:[bt.a,r.f],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),Yr);function Zr(e,t){if(1&e&&l["\u0275\u0275element"](0,"div",11),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("busyIf",n.stripeIsLoading)}}var ei,ti,ni,ri,ii=((ri=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),(a=t.call(this,e))._activatedRoute=r,a._stripePaymentAppService=i,a._paymentAppService=o,a.amount=0,a.description="",a.stripeIsLoading=!0,a.subscriptionPaymentGateway=O.Ee,a.subscriptionStartType=O.He,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.spinnerService.show(),this.stripeIsLoading=!0,this.paymentId=this._activatedRoute.snapshot.queryParams.paymentId,(new x.a).load("https://js.stripe.com/v3").then(function(){e._stripePaymentAppService.getConfiguration().subscribe(function(t){e._stripePaymentAppService.createPaymentSession(new O.se({paymentId:e.paymentId,successUrl:w.a.appBaseUrl+"/account/stripe-payment-result",cancelUrl:w.a.appBaseUrl+"/account/stripe-cancel-payment"})).subscribe(function(n){e._paymentAppService.getPayment(e.paymentId).subscribe(function(r){e.spinnerService.hide(),e.amount=r.amount,e.description=r.description,e.successCallbackUrl=r.successUrl,e.errorCallbackUrl=r.errorUrl;var i=window.Stripe(t.publishableKey);document.getElementById("stripe-checkout").addEventListener("click",function(){i.redirectToCheckout({sessionId:n})}),e.stripeIsLoading=!1},function(t){e.spinnerService.hide()})},function(t){e.spinnerService.hide()})},function(t){e.spinnerService.hide()})}).catch(function(t){e.spinnerService.hide()})}}]),n}(C.a)).\u0275fac=function(e){return new(e||ri)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](I.a),l["\u0275\u0275directiveInject"](O.te),l["\u0275\u0275directiveInject"](O.wd))},ri.\u0275cmp=l["\u0275\u0275defineComponent"]({type:ri,selectors:[["stripe-purchase-component"]],inputs:{editionPaymentType:"editionPaymentType"},features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:24,vars:17,consts:[[1,"login-form"],[1,"card","card-bordered"],[1,"card-header"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-4"],[1,"col-sm-8","text-right"],[1,"font-weight-bold"],["id","totalPrice",1,"font-weight-bold"],["id","stripe-checkout",1,"btn","btn-primary","btn-block",3,"disabled"],[3,"busyIf",4,"ngIf"],[3,"busyIf"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"h3"),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"div",3),l["\u0275\u0275elementStart"](7,"div",4),l["\u0275\u0275elementStart"](8,"label",5),l["\u0275\u0275text"](9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",6),l["\u0275\u0275elementStart"](11,"p",7),l["\u0275\u0275text"](12),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"div",4),l["\u0275\u0275elementStart"](14,"label",5),l["\u0275\u0275text"](15),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"div",6),l["\u0275\u0275elementStart"](17,"p",8),l["\u0275\u0275text"](18),l["\u0275\u0275pipe"](19,"number"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"button",9),l["\u0275\u0275text"](21),l["\u0275\u0275pipe"](22,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](23,Zr,1,1,"div",10),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,10,"TenantSignUp")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate"](t.l("Item")),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",t.description," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](t.l("Price")),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate2"](" ",t.appSession.application.currencySign,"",l["\u0275\u0275pipeBind2"](19,12,t.amount,"1.2-2")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",t.stripeIsLoading),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](22,15,"Purchase")),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngIf",t.stripeIsLoading))},directives:[r.n,Qr.a],pipes:[bt.a,r.f],encapsulation:2,data:{animation:[Object(Zt.a)()]}}),ri),oi=((ni=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return n}(C.a)).\u0275fac=function(e){return new(e||ni)(l["\u0275\u0275directiveInject"](l.Injector))},ni.\u0275cmp=l["\u0275\u0275defineComponent"]({type:ni,selectors:[["stripe-cancel-payment"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:11,vars:6,consts:[[1,"d-flex","h-100","align-items-center",2,"padding-bottom","150px !important"],[1,"login-form","align-middle","m-0","text-center"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],[1,"my-5"],[1,"fas","fa-times","fa-4x","text-danger"],["href","/app/admin/subscription-management",1,"btn","btn-info"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"h3",3),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"div",4),l["\u0275\u0275element"](7,"i",5),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](8,"a",6),l["\u0275\u0275text"](9),l["\u0275\u0275pipe"](10,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,2,"PaymentCouldNotCompleted")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](10,4,"GoToSubscriptionManagement"),""))},pipes:[bt.a],encapsulation:2}),ni),ai=((ti=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a){var s;return _classCallCheck(this,n),(s=t.call(this,e))._stripePaymentService=r,s._activatedRoute=i,s._router=o,s._sessionService=a,s.controlTimeout=5e3,s.maxControlCount=5,s}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.sessionId=this._activatedRoute.snapshot.queryParams.sessionId,this._stripePaymentService.getPayment(this.sessionId).subscribe(function(t){e._sessionService.tenantId!==t.tenantId&&e._router.navigate([""]),e.paymentId=t.id,e.getPaymentResult()})}},{key:"getPaymentResult",value:function(){var e=this;this._stripePaymentService.getPaymentResult(this.paymentId).subscribe(function(t){t.paymentDone?e._router.navigate(["account/payment-completed"]):e.controlAgain()},function(t){e.controlAgain()})}},{key:"controlAgain",value:function(){var e=this;0!==this.maxControlCount&&(setTimeout(function(){e.getPaymentResult()},this.controlTimeout),this.controlTimeout*=2,this.maxControlCount--)}}]),n}(C.a)).\u0275fac=function(e){return new(e||ti)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](O.te),l["\u0275\u0275directiveInject"](I.a),l["\u0275\u0275directiveInject"](I.e),l["\u0275\u0275directiveInject"](dt.d))},ti.\u0275cmp=l["\u0275\u0275defineComponent"]({type:ti,selectors:[["stripe-payment-result"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:12,vars:10,consts:[[1,"d-flex","h-100","align-items-center",2,"padding-bottom","150px !important"],[1,"login-formalign-middle","m-0"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],[1,"text-center"],[2,"position","relative","margin-top","60px !important"],[3,"busyIf"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"h3",3),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"p",4),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"localize"),l["\u0275\u0275pipe"](9,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",5),l["\u0275\u0275element"](11,"div",6),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,4,"PleaseWait")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate2"](" ",l["\u0275\u0275pipeBind1"](8,6,"ReceivingPaymentResult")," ",l["\u0275\u0275pipeBind1"](9,8,"PleaseWait")," "),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("busyIf",!0))},directives:[Qr.a],pipes:[bt.a],encapsulation:2}),ti),si=((ei=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return n}(C.a)).\u0275fac=function(e){return new(e||ei)(l["\u0275\u0275directiveInject"](l.Injector))},ei.\u0275cmp=l["\u0275\u0275defineComponent"]({type:ei,selectors:[["payment-completed"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:14,vars:9,consts:[[1,"d-flex","h-100","align-items-center",2,"padding-bottom","150px !important"],[1,"login-form","align-middle","m-0","text-center"],[1,"pb-13","pt-lg-0","pt-5"],[1,"font-weight-bolder","text-dark","font-size-h4","font-size-h1-lg"],[1,"text-center"],[1,"my-5"],[1,"fas","fa-check","fa-4x","text-success"],["href","/app/admin/subscription-management",1,"btn","btn-info"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"h3",3),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"p",4),l["\u0275\u0275text"](7),l["\u0275\u0275pipe"](8,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](9,"div",5),l["\u0275\u0275element"](10,"i",6),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](11,"a",7),l["\u0275\u0275text"](12),l["\u0275\u0275pipe"](13,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](5,3,"ThankYou")," "),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](8,5,"YourPaymentHasBeenCompleted")," "),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](13,7,"GoToSubscriptionManagement"),""))},pipes:[bt.a],encapsulation:2}),ei);function ci(e,t){if(1&e&&l["\u0275\u0275element"](0,"img",24),2&e){var n=l["\u0275\u0275nextContext"]();l["\u0275\u0275property"]("src",n.userInfo.profilePicture,l["\u0275\u0275sanitizeUrl"])}}function li(e,t){if(1&e&&l["\u0275\u0275element"](0,"validation-messages",25),2&e){l["\u0275\u0275nextContext"]();var n=l["\u0275\u0275reference"](25);l["\u0275\u0275property"]("formCtrl",n)}}var ui,di,pi=((ui=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),(a=t.call(this,e))._profileService=r,a._reCaptchaV3Service=i,a.loginService=o,a.recaptchaSiteKey=w.a.recaptchaSiteKey,a.submitting=!1,a.getLastUserInfo(),a}return _createClass(n,[{key:"getLastUserInfo",value:function(){var e=this,t=abp.utils.getCookieValue("userInfo");t||(location.href="");var n=JSON.parse(t);n||(location.href=""),this.loginService.authenticateModel.userNameOrEmailAddress=n.userName,this.userInfo={userName:n.userName,tenant:n.tenant,profilePicture:""},this._profileService.getProfilePictureByUserName(n.userName).subscribe(function(t){e.userInfo.profilePicture=t.profilePicture?"data:image/jpeg;base64,"+t.profilePicture:w.a.appBaseUrl+"/assets/common/images/default-profile-picture.png"},function(){e.userInfo.profilePicture=w.a.appBaseUrl+"/assets/common/images/default-profile-picture.png"})}},{key:"login",value:function(){var e=this,t=function(t){e.showMainSpinner(),e.submitting=!0,e.loginService.authenticate(function(){e.submitting=!1,e.hideMainSpinner()},null,t)};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"login",function(e){t(e)}):t(null)}},{key:"useCaptcha",get:function(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnLogin")}}]),n}(C.a)).\u0275fac=function(e){return new(e||ui)(l["\u0275\u0275directiveInject"](l.Injector),l["\u0275\u0275directiveInject"](O.Nd),l["\u0275\u0275directiveInject"](S),l["\u0275\u0275directiveInject"](mt))},ui.\u0275cmp=l["\u0275\u0275defineComponent"]({type:ui,selectors:[["app-session-lock-screen"]],features:[l["\u0275\u0275InheritDefinitionFeature"]],decls:38,vars:20,consts:[[1,"card","card-bordered","gutter-b","card-stretch"],[1,"card-body","text-center","pt-4"],["role","alert",1,"alert","alert-custom","alert-light-warning"],[1,"alert-text",2,"font-weight","bold"],[1,"fa","fa-lock","float-right"],[1,"mt-7","pb-2"],[1,"symbol","symbol-circle","symbol-lg-75"],["class","symbol-label","alt","profileimage",3,"src",4,"ngIf"],[1,"my-2"],["href","#",1,"text-dark","font-weight-bold","text-hover-primary","font-size-h4"],[1,"text-dark","font-weight-normal","font-size-h4"],[1,"text-dark","font-weight-bold"],["method","post","novalidate","",1,"form","mt-4",3,"ngSubmit"],["loginForm","ngForm"],[1,"form-group"],["type","hidden","name","usernameOrEmailAddress"],["type","password","autocomplete","new-password","name","password","required","","maxlength","32",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","font-size-h6",3,"ngModel","placeholder","ngModelChange"],["passwordInput","ngModel"],[3,"formCtrl",4,"ngIf"],[1,"mt-9","mb-6"],[1,"col-5","mt-2","float-left"],[1,"checkbox"],["type","checkbox","name","rememberMe","value","true",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-primary","font-weight-bolder","font-size-h6","col-4","float-right",3,"disabled"],["alt","profileimage",1,"symbol-label",3,"src"],[3,"formCtrl"]],template:function(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"div",3),l["\u0275\u0275text"](4),l["\u0275\u0275pipe"](5,"localize"),l["\u0275\u0275element"](6,"i",4),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"div",5),l["\u0275\u0275elementStart"](8,"div",6),l["\u0275\u0275template"](9,ci,1,1,"img",7),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"div",8),l["\u0275\u0275elementStart"](11,"a",9),l["\u0275\u0275text"](12),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"div",8),l["\u0275\u0275elementStart"](14,"span",10),l["\u0275\u0275text"](15,"Tenant: "),l["\u0275\u0275elementStart"](16,"span",11),l["\u0275\u0275text"](17),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](18,"form",12,13),l["\u0275\u0275listener"]("ngSubmit",function(){return t.login()}),l["\u0275\u0275elementStart"](20,"div",8),l["\u0275\u0275elementStart"](21,"div",14),l["\u0275\u0275element"](22,"input",15),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](23,"div",14),l["\u0275\u0275elementStart"](24,"input",16,17),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.loginService.authenticateModel.password=e}),l["\u0275\u0275pipe"](26,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](27,li,1,1,"validation-messages",18),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](28,"div",19),l["\u0275\u0275elementStart"](29,"div",20),l["\u0275\u0275elementStart"](30,"label",21),l["\u0275\u0275elementStart"](31,"input",22),l["\u0275\u0275listener"]("ngModelChange",function(e){return t.loginService.rememberMe=e}),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](32,"span"),l["\u0275\u0275text"](33),l["\u0275\u0275pipe"](34,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](35,"button",23),l["\u0275\u0275text"](36),l["\u0275\u0275pipe"](37,"localize"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){var n=l["\u0275\u0275reference"](19),r=l["\u0275\u0275reference"](25);l["\u0275\u0275property"]("@routerTransition",void 0),l["\u0275\u0275advance"](4),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](5,12,"YourSessionIsLocked")),l["\u0275\u0275advance"](5),l["\u0275\u0275property"]("ngIf",t.userInfo&&t.userInfo.profilePicture),l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](t.userInfo.userName),l["\u0275\u0275advance"](5),l["\u0275\u0275textInterpolate"](t.userInfo.tenant),l["\u0275\u0275advance"](7),l["\u0275\u0275propertyInterpolate1"]("placeholder","",l["\u0275\u0275pipeBind1"](26,14,"Password"),"*"),l["\u0275\u0275property"]("ngModel",t.loginService.authenticateModel.password),l["\u0275\u0275advance"](3),l["\u0275\u0275property"]("ngIf",!r.touched),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngModel",t.loginService.rememberMe),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",l["\u0275\u0275pipeBind1"](34,16,"RememberMe")," "),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("disabled",!n.form.valid),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate"](l["\u0275\u0275pipeBind1"](37,18,"LogIn"))}},directives:[r.n,a["\u0275angular_packages_forms_forms_ba"],a.NgControlStatusGroup,a.NgForm,a.DefaultValueAccessor,a.RequiredValidator,a.MaxLengthValidator,a.NgControlStatus,a.NgModel,a.CheckboxControlValueAccessor,en.a],pipes:[bt.a],styles:["app-session-lock-screen[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column}"],data:{animation:[Object(Zt.a)()]}}),ui),hi=n("ll/a"),mi=((di=function(){function e(t,n){var r=this;_classCallCheck(this,e),this.router=t,this._uiCustomizationService=n,t.events.subscribe(function(e){setTimeout(function(){r.toggleBodyCssClass(e.url)},0)})}return _createClass(e,[{key:"toggleBodyCssClass",value:function(e){e?e.indexOf("/account/")>=0?this.setAccountModuleBodyClassInternal():document.body.className=this._uiCustomizationService.getAppModuleBodyClass():this.setAccountModuleBodyClassInternal()}},{key:"setAccountModuleBodyClassInternal",value:function(){var e="";document.body.className.indexOf("swal2-toast-shown")>=0&&(e+=" swal2-toast-shown"),document.body.className=this._uiCustomizationService.getAccountModuleBodyClass()+" "+e}}]),e}()).\u0275fac=function(e){return new(e||di)(l["\u0275\u0275inject"](I.e),l["\u0275\u0275inject"](T.a))},di.\u0275mod=l["\u0275\u0275defineNgModule"]({type:di}),di.\u0275inj=l["\u0275\u0275defineInjector"]({imports:[[I.i.forChild([{path:"",component:Xt,children:[{path:"",redirectTo:"login"},{path:"login",component:un,canActivate:[Yt]},{path:"register",component:wr,canActivate:[Yt]},{path:"register-tenant",component:Sr,canActivate:[Yt]},{path:"register-tenant-result",component:ur,canActivate:[Yt]},{path:"forgot-password",component:bn,canActivate:[Yt]},{path:"reset-password",component:xn,canActivate:[Yt]},{path:"email-activation",component:tn,canActivate:[Yt]},{path:"confirm-email",component:$t,canActivate:[Yt]},{path:"send-code",component:mn,canActivate:[Yt]},{path:"verify-code",component:Sn,canActivate:[Yt]},{path:"buy",component:Fn},{path:"extend",component:nr},{path:"upgrade",component:Qn},{path:"select-edition",component:Gr},{path:"paypal-purchase",component:$r},{path:"stripe-purchase",component:ii},{path:"stripe-payment-result",component:ai},{path:"stripe-cancel-payment",component:oi},{path:"payment-completed",component:si},{path:"session-locked",component:pi},{path:"enrollment",component:hi.a},{path:"**",redirectTo:"login"}]}])],I.i]}),di),gi=n("+yPr"),fi=n("S56A"),vi=function(){};n("LRne"),n("w1tV"),n("lJxs");var yi=function(){function e(){}var t;return t=e,e.forRoot=function(e){return{ngModule:t,providers:[{provide:vi,useValue:e}]}},e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({}),e}();function _i(){return(new gi.a).map("recaptcha",abp.localization.currentLanguage.name)}var Si,Ei=((Si=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||Si)},Si.\u0275mod=l["\u0275\u0275defineNgModule"]({type:Si}),Si.\u0275inj=l["\u0275\u0275defineInjector"]({providers:[mt,rr,Rn,Yt],imports:[[r.c,a.FormsModule,i.e,i.d,E,b.b.forRoot(),o.a,c.a,s.a,mi,N.b.forRoot(),mr,fi.a,yi]]}),Si)},tS1D:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n("D0XW"),i=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}(),o=n("mlxB"),a=n("zx2A"),s=function(){function e(t,n,r,i){_classCallCheck(this,e),this.waitFor=t,this.absoluteTimeout=n,this.withObservable=r,this.scheduler=i}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new c(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))}}]),e}(),c=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a){var s;return _classCallCheck(this,n),(s=t.call(this,e)).absoluteTimeout=r,s.waitFor=i,s.withObservable=o,s.scheduler=a,s.scheduleTimeout(),s}return _createClass(n,[{key:"scheduleTimeout",value:function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(n.dispatchTimeout,this.waitFor,this))}},{key:"_next",value:function(e){this.absoluteTimeout||this.scheduleTimeout(),_get(_getPrototypeOf(n.prototype),"_next",this).call(this,e)}},{key:"_unsubscribe",value:function(){this.action=void 0,this.scheduler=null,this.withObservable=null}}],[{key:"dispatchTimeout",value:function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(Object(a.c)(t,new a.a(e)))}}]),n}(a.b),l=n("z6cu");function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.a;return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.a;return function(r){var i=Object(o.a)(e),a=i?+e-n.now():Math.abs(e);return r.lift(new s(a,i,t,n))}}(e,Object(l.a)(new i),t)}}}])})();